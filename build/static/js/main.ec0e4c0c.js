/*! For license information please see main.ec0e4c0c.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:u,props:s,_owner:i.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var x=Array.isArray,S=Object.prototype.hasOwnProperty,k={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function j(e,t,r){var a,s={},o=null,i=null;if(null!=t)for(a in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(o=""+t.key),t)S.call(t,a)&&!_.hasOwnProperty(a)&&(s[a]=t[a]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===s[a]&&(s[a]=l[a]);return{$$typeof:n,type:e,key:o,ref:i,props:s,_owner:k.current}}function N(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,a,s,o){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l=!1;if(null===e)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+C(l,0):s,x(o)?(a="",null!=e&&(a=e.replace(E,"$&/")+"/"),T(o,t,a,"",function(e){return e})):null!=o&&(N(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+C(i=e[c],c);l+=T(i,t,a,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(i=e.next()).done;)l+=T(i=i.value,t,a,u=s+C(i,c++),o);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,n){if(null==e)return e;var r=[],a=0;return T(e,r,"","",function(e){return t.call(n,e,a++)}),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},R={transition:null},D={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:R,ReactCurrentOwner:k};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!N(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),s=e.key,o=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,i=k.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!_.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:a,_owner:i}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=j,t.createFactory=function(e){var t=j.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=N,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return A.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<s(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var i=2*(r+1)-1,l=e[i],c=i+1,u=e[c];if(0>s(l,n))c<a&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[i]=n,r=i);else{if(!(c<a&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,R(S);else{var t=r(u);null!==t&&D(x,t.startTime-e)}}function S(e,n){m=!1,g&&(g=!1,y(N),N=-1),f=!0;var s=p;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!T());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var i=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof i?h.callback=i:h===r(c)&&a(c),w(n)}else a(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&D(x,d.startTime-n),l=!1}return l}finally{h=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,_=!1,j=null,N=-1,E=5,C=-1;function T(){return!(t.unstable_now()-C<E)}function I(){if(null!==j){var e=t.unstable_now();C=e;var n=!0;try{n=j(!0,e)}finally{n?k():(_=!1,j=null)}}else _=!1}if("function"===typeof b)k=function(){b(I)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,A=P.port2;P.port1.onmessage=I,k=function(){A.postMessage(null)}}else k=function(){v(I,0)};function R(e){j=e,_||(_=!0,k())}function D(e,n){N=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,R(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:s,expirationTime:i=s+i,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(y(N),N=-1):g=!0,D(x,s-o))):(e.sortIndex=i,n(c,e),m||f||(m=!0,R(S))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),a=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,i={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(i[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,a,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),S=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var O,U=Object.assign;function M(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var z=!1;function F(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),s=r.stack.split("\n"),o=a.length-1,i=s.length-1;1<=o&&0<=i&&a[o]!==s[i];)i--;for(;1<=o&&0<=i;o--,i--)if(a[o]!==s[i]){if(1!==o||1!==i)do{if(o--,0>--i||a[o]!==s[i]){var l="\n"+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=i);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?M(e):""}function H(e){switch(e.tag){case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return e=F(e.type,!1);case 11:return e=F(e.type.render,!1);case 1:return e=F(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case S:return"Portal";case j:return"Profiler";case _:return"StrictMode";case T:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case N:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function G(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Z(e,t){Y(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function se(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ve=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,ke=null,_e=null;function je(e){if(e=ba(e)){if("function"!==typeof Se)throw Error(s(280));var t=e.stateNode;t&&(t=xa(t),Se(e.stateNode,e.type,t))}}function Ne(e){ke?_e?_e.push(e):_e=[e]:ke=e}function Ee(){if(ke){var e=ke,t=_e;if(_e=ke=null,je(e),t)for(e=0;e<t.length;e++)je(t[e])}}function Ce(e,t){return e(t)}function Te(){}var Ie=!1;function Pe(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return Ce(e,t,n)}finally{Ie=!1,(null!==ke||null!==_e)&&(Te(),Ee())}}function Ae(e,t){var n=e.stateNode;if(null===n)return null;var r=xa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Re=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Re=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Re=!1}function Le(e,t,n,r,a,s,o,i,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,Ue=null,Me=!1,ze=null,Fe={onError:function(e){Oe=!0,Ue=e}};function He(e,t,n,r,a,s,o,i,l){Oe=!1,Ue=null,Le.apply(Fe,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Be(e)!==e)throw Error(s(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ve(a),e;if(o===r)return Ve(a),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=a,r=o;else{for(var i=!1,l=a.child;l;){if(l===n){i=!0,n=a,r=o;break}if(l===r){i=!0,r=a,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=a;break}if(l===r){i=!0,r=o,n=a;break}l=l.sibling}if(!i)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var $e=a.unstable_scheduleCallback,Je=a.unstable_cancelCallback,Qe=a.unstable_shouldYield,Ge=a.unstable_requestPaint,Ye=a.unstable_now,Ze=a.unstable_getCurrentPriorityLevel,Xe=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(it(e)/lt|0)|0},it=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var i=o&~a;0!==i?r=dt(i):0!==(s&=o)&&(r=dt(s))}else 0!==(o=n&~a)?r=dt(o):0!==s&&(r=dt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(s=t&-t)||16===a&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,St,kt,_t,jt,Nt=!1,Et=[],Ct=null,Tt=null,It=null,Pt=new Map,At=new Map,Rt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function Ot(e,t,n,r,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ut(e){var t=ya(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void jt(e.priority,function(){kt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Mt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function zt(e,t,n){Mt(e)&&n.delete(t)}function Ft(){Nt=!1,null!==Ct&&Mt(Ct)&&(Ct=null),null!==Tt&&Mt(Tt)&&(Tt=null),null!==It&&Mt(It)&&(It=null),Pt.forEach(zt),At.forEach(zt)}function Ht(e,t){e.blockedOn===t&&(e.blockedOn=null,Nt||(Nt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ft)))}function Bt(e){function t(t){return Ht(t,e)}if(0<Et.length){Ht(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&Ht(Ct,e),null!==Tt&&Ht(Tt,e),null!==It&&Ht(It,e),Pt.forEach(t),At.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Ut(n),null===n.blockedOn&&Rt.shift()}var Wt=w.ReactCurrentBatchConfig,Vt=!0;function qt(e,t,n,r){var a=bt,s=Wt.transition;Wt.transition=null;try{bt=1,$t(e,t,n,r)}finally{bt=a,Wt.transition=s}}function Kt(e,t,n,r){var a=bt,s=Wt.transition;Wt.transition=null;try{bt=4,$t(e,t,n,r)}finally{bt=a,Wt.transition=s}}function $t(e,t,n,r){if(Vt){var a=Qt(e,t,n,r);if(null===a)Vr(e,t,r,Jt,n),Lt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Ct=Ot(Ct,e,t,n,r,a),!0;case"dragenter":return Tt=Ot(Tt,e,t,n,r,a),!0;case"mouseover":return It=Ot(It,e,t,n,r,a),!0;case"pointerover":var s=a.pointerId;return Pt.set(s,Ot(Pt.get(s)||null,e,t,n,r,a)),!0;case"gotpointercapture":return s=a.pointerId,At.set(s,Ot(At.get(s)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==a;){var s=ba(a);if(null!==s&&xt(s),null===(s=Qt(e,t,n,r))&&Vr(e,t,r,Jt,n),s===a)break;a=s}null!==a&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Jt=null;function Qt(e,t,n,r){if(Jt=null,null!==(e=ya(e=xe(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Gt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Xe:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Zt=null,Xt=null;function en(){if(Xt)return Xt;var e,t,n=Zt,r=n.length,a="value"in Yt?Yt.value:Yt.textContent,s=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[s-t];t++);return Xt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),dn=U({},cn,{view:0,detail:0}),hn=an(dn),pn=U({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),fn=an(pn),mn=an(U({},pn,{dataTransfer:0})),gn=an(U({},dn,{relatedTarget:0})),vn=an(U({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=U({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),wn=an(U({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function jn(){return _n}var Nn=U({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=an(Nn),Cn=an(U({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=an(U({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jn})),In=an(U({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=U({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),An=an(Pn),Rn=[9,13,27,32],Dn=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var On=u&&"TextEvent"in window&&!Ln,Un=u&&(!Dn||Ln&&8<Ln&&11>=Ln),Mn=String.fromCharCode(32),zn=!1;function Fn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function qn(e,t,n,r){Ne(r),0<(t=Kr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,$n=null;function Jn(e){Mr(e,0)}function Qn(e){if($(wa(e)))return e}function Gn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Zn;if(u){var Xn="oninput"in document;if(!Xn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Xn="function"===typeof er.oninput}Zn=Xn}else Zn=!1;Yn=Zn&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),$n=Kn=null)}function nr(e){if("value"===e.propertyName&&Qn($n)){var t=[];qn(t,$n,e,xe(e)),Pe(Jn,t)}}function rr(e,t,n){"focusin"===e?(tr(),$n=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn($n)}function sr(e,t){if("click"===e)return Qn(t)}function or(e,t){if("input"===e||"change"===e)return Qn(t)}var ir="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ir(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!ir(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,s=Math.min(r.start,a);r=void 0===r.end?s:Math.min(r.end,a),!e.extend&&s>r&&(a=r,r=s,s=a),a=ur(n,s);var o=ur(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==J(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Kr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},kr={},_r={};function jr(e){if(kr[e])return kr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in _r)return kr[e]=n[t];return e}u&&(_r=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Nr=jr("animationend"),Er=jr("animationiteration"),Cr=jr("animationstart"),Tr=jr("transitionend"),Ir=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){Ir.set(e,t),l(t,[e])}for(var Rr=0;Rr<Pr.length;Rr++){var Dr=Pr[Rr];Ar(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Ar(Nr,"onAnimationEnd"),Ar(Er,"onAnimationIteration"),Ar(Cr,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Or=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,i,l,c){if(He.apply(this,arguments),Oe){if(!Oe)throw Error(s(198));var u=Ue;Oe=!1,Ue=null,Me||(Me=!0,ze=u)}}(r,t,void 0,e),e.currentTarget=null}function Mr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var i=r[o],l=i.instance,c=i.currentTarget;if(i=i.listener,l!==s&&a.isPropagationStopped())break e;Ur(a,i,c),s=l}else for(o=0;o<r.length;o++){if(l=(i=r[o]).instance,c=i.currentTarget,i=i.listener,l!==s&&a.isPropagationStopped())break e;Ur(a,i,c),s=l}}}if(Me)throw e=ze,Me=!1,ze=null,e}function zr(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function Fr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var Hr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[Hr]){e[Hr]=!0,o.forEach(function(t){"selectionchange"!==t&&(Or.has(t)||Fr(t,!1,e),Fr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hr]||(t[Hr]=!0,Fr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Gt(t)){case 1:var a=qt;break;case 4:a=Kt;break;default:a=$t}n=a.bind(null,t,n,e),a=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,a){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var i=r.stateNode.containerInfo;if(i===a||8===i.nodeType&&i.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;o=o.return}for(;null!==i;){if(null===(o=ya(i)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}i=i.parentNode}}r=r.return}Pe(function(){var r=s,a=xe(n),o=[];e:{var i=Ir.get(e);if(void 0!==i){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=En;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Nr:case Er:case Cr:l=vn;break;case Tr:l=In;break;case"scroll":l=hn;break;case"wheel":l=An;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==i?i+"Capture":null:i;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Ae(f,h))&&u.push(qr(f,m,p)))),d)break;f=f.return}0<u.length&&(i=new l(i,c,null,n,a),o.push({event:i,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[fa])&&(l||i)&&(i=a.window===a?a:(i=a.ownerDocument)?i.defaultView||i.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?i:wa(l),p=null==c?i:wa(c),(i=new u(m,f+"leave",l,n,a)).target=d,i.relatedTarget=p,m=null,ya(a)===r&&((u=new u(h,f+"enter",c,n,a)).target=p,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,f=0,p=u=l;p;p=$r(p))f++;for(p=0,m=h;m;m=$r(m))p++;for(;0<f-p;)u=$r(u),f--;for(;0<p-f;)h=$r(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=$r(u),h=$r(h)}u=null}else u=null;null!==l&&Jr(o,i,l,u,!1),null!==c&&null!==d&&Jr(o,d,c,u,!0)}if("select"===(l=(i=r?wa(r):window).nodeName&&i.nodeName.toLowerCase())||"input"===l&&"file"===i.type)var g=Gn;else if(Vn(i))if(Yn)g=or;else{g=ar;var v=rr}else(l=i.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(g=sr);switch(g&&(g=g(e,r))?qn(o,g,n,a):(v&&v(e,i,r),"focusout"===e&&(v=i._wrapperState)&&v.controlled&&"number"===i.type&&ee(i,"number",i.value)),v=r?wa(r):window,e){case"focusin":(Vn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(o,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(o,n,a)}var y;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?Fn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(y=en()):(Zt="value"in(Yt=a)?Yt.value:Yt.textContent,Bn=!0)),0<(v=Kr(r,b)).length&&(b=new wn(b,e,null,n,a),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Hn(n))&&(b.data=y))),(y=On?function(e,t){switch(e){case"compositionend":return Hn(t);case"keypress":return 32!==t.which?null:(zn=!0,Mn);case"textInput":return(e=t.data)===Mn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Dn&&Fn(e,t)?(e=en(),Xt=Zt=Yt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(a=new wn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}Mr(o,t)})}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,s=a.stateNode;5===a.tag&&null!==s&&(a=s,null!=(s=Ae(e,n))&&r.unshift(qr(e,s,a)),null!=(s=Ae(e,t))&&r.push(qr(e,s,a))),e=e.return}return r}function $r(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jr(e,t,n,r,a){for(var s=t._reactName,o=[];null!==n&&n!==r;){var i=n,l=i.alternate,c=i.stateNode;if(null!==l&&l===r)break;5===i.tag&&null!==c&&(i=c,a?null!=(l=Ae(n,s))&&o.unshift(qr(n,l,i)):a||null!=(l=Ae(n,s))&&o.push(qr(n,l,i))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qr=/\r\n?/g,Gr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Gr,"")}function Zr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(s(425))}function Xr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,sa="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sa?function(e){return sa.resolve(null).then(e).catch(ia)}:ra;function ia(e){setTimeout(function(){throw e})}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Bt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),ha="__reactFiber$"+da,pa="__reactProps$"+da,fa="__reactContainer$"+da,ma="__reactEvents$"+da,ga="__reactListeners$"+da,va="__reactHandles$"+da;function ya(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[ha])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xa(e){return e[pa]||null}var Sa=[],ka=-1;function _a(e){return{current:e}}function ja(e){0>ka||(e.current=Sa[ka],Sa[ka]=null,ka--)}function Na(e,t){ka++,Sa[ka]=e.current,e.current=t}var Ea={},Ca=_a(Ea),Ta=_a(!1),Ia=Ea;function Pa(e,t){var n=e.type.contextTypes;if(!n)return Ea;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,s={};for(a in n)s[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Aa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ra(){ja(Ta),ja(Ca)}function Da(e,t,n){if(Ca.current!==Ea)throw Error(s(168));Na(Ca,t),Na(Ta,n)}function La(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(s(108,W(e)||"Unknown",a));return U({},n,r)}function Oa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ea,Ia=Ca.current,Na(Ca,e),Na(Ta,Ta.current),!0}function Ua(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=La(e,t,Ia),r.__reactInternalMemoizedMergedChildContext=e,ja(Ta),ja(Ca),Na(Ca,e)):ja(Ta),Na(Ta,n)}var Ma=null,za=!1,Fa=!1;function Ha(e){null===Ma?Ma=[e]:Ma.push(e)}function Ba(){if(!Fa&&null!==Ma){Fa=!0;var e=0,t=bt;try{var n=Ma;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ma=null,za=!1}catch(a){throw null!==Ma&&(Ma=Ma.slice(e+1)),$e(Xe,Ba),a}finally{bt=t,Fa=!1}}return null}var Wa=[],Va=0,qa=null,Ka=0,$a=[],Ja=0,Qa=null,Ga=1,Ya="";function Za(e,t){Wa[Va++]=Ka,Wa[Va++]=qa,qa=e,Ka=t}function Xa(e,t,n){$a[Ja++]=Ga,$a[Ja++]=Ya,$a[Ja++]=Qa,Qa=e;var r=Ga;e=Ya;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var s=32-ot(t)+a;if(30<s){var o=a-a%5;s=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Ga=1<<32-ot(t)+a|n<<a|r,Ya=s+e}else Ga=1<<s|n<<a|r,Ya=e}function es(e){null!==e.return&&(Za(e,1),Xa(e,1,0))}function ts(e){for(;e===qa;)qa=Wa[--Va],Wa[Va]=null,Ka=Wa[--Va],Wa[Va]=null;for(;e===Qa;)Qa=$a[--Ja],$a[Ja]=null,Ya=$a[--Ja],$a[Ja]=null,Ga=$a[--Ja],$a[Ja]=null}var ns=null,rs=null,as=!1,ss=null;function os(e,t){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function is(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qa?{id:Ga,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(as){var t=rs;if(t){var n=t;if(!is(e,t)){if(ls(e))throw Error(s(418));t=ca(n.nextSibling);var r=ns;t&&is(e,t)?os(r,n):(e.flags=-4097&e.flags|2,as=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,as=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!as)return us(e),as=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw hs(),Error(s(418));for(;t;)os(e,t),t=ca(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ca(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=rs;e;)e=ca(e.nextSibling)}function ps(){rs=ns=null,as=!1}function fs(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Uc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===k?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===A&&ys(s)===t.type)?((r=a(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Dc(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Mc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=Lc(n,e.mode,r,s)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case S:return(t=Mc(t,e.mode,n)).return=e,t;case A:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Lc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===a?c(e,t,n,r):null;case S:return n.key===a?u(e,t,n,r):null;case A:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||L(n))return null!==a?null:d(e,t,n,r,null);vs(e,n)}return null}function f(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case S:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case A:return f(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||L(r))return d(t,e=e.get(n)||null,r,a,null);vs(t,r)}return null}function m(a,s,i,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<i.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(a,d,i[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(a,d),s=o(v,s,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===i.length)return n(a,d),as&&Za(a,m),c;if(null===d){for(;m<i.length;m++)null!==(d=h(a,i[m],l))&&(s=o(d,s,m),null===u?c=d:u.sibling=d,u=d);return as&&Za(a,m),c}for(d=r(a,d);m<i.length;m++)null!==(g=f(d,a,m,i[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(a,e)}),as&&Za(a,m),c}function g(a,i,l,c){var u=L(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=i,g=i=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(a,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(a,m),i=o(b,i,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(a,m),as&&Za(a,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(a,y.value,c))&&(i=o(y,i,g),null===d?u=y:d.sibling=y,d=y);return as&&Za(a,g),u}for(m=r(a,m);!y.done;g++,y=l.next())null!==(y=f(m,a,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),i=o(y,i,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(a,e)}),as&&Za(a,g),u}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===k&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===k){if(7===u.tag){n(r,u.sibling),(s=a(u,o.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===A&&ys(c)===u.type){n(r,u.sibling),(s=a(u,o.props)).ref=gs(r,u,o),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===k?((s=Lc(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Dc(o.type,o.key,o.props,null,r.mode,l)).ref=gs(r,s,o),l.return=r,r=l)}return i(r);case S:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=a(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Mc(o,r.mode,l)).return=r,r=s}return i(r);case A:return e(r,s,(u=o._init)(o._payload),l)}if(te(o))return m(r,s,o,l);if(L(o))return g(r,s,o,l);vs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=a(s,o)).return=r,r=s):(n(r,s),(s=Uc(o,r.mode,l)).return=r,r=s),i(r)):n(r,s)}}var ws=bs(!0),xs=bs(!1),Ss=_a(null),ks=null,_s=null,js=null;function Ns(){js=_s=ks=null}function Es(e){var t=Ss.current;ja(Ss),e._currentValue=t}function Cs(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ts(e,t){ks=e,js=_s=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bi=!0),e.firstContext=null)}function Is(e){var t=e._currentValue;if(js!==e)if(e={context:e,memoizedValue:t,next:null},null===_s){if(null===ks)throw Error(s(308));_s=e,ks.dependencies={lanes:0,firstContext:e}}else _s=_s.next=e;return t}var Ps=null;function As(e){null===Ps?Ps=[e]:Ps.push(e)}function Rs(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,As(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ds(e,r)}function Ds(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ls=!1;function Os(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Us(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ms(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cl)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ds(e,n)}return null===(a=r.interleaved)?(t.next=t,As(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ds(e,n)}function Fs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Hs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?a=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?a=s=t:s=s.next=t}else a=s=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bs(e,t,n,r){var a=e.updateQueue;Ls=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var l=i,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((i=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===i?u.firstBaseUpdate=c:i.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=a.baseState;for(o=0,u=c=l=null,i=s;;){var h=i.lane,p=i.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var f=e,m=i;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=U({},d,h);break e;case 2:Ls=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[i]:h.push(i))}else p={eventTime:p,lane:h,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,o|=h;if(null===(i=i.next)){if(null===(i=a.shared.pending))break;i=(h=i).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===s&&(a.shared.lanes=0);Ol|=o,e.lanes=o,e.memoizedState=d}}function Ws(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(s(191,a));a.call(r)}}}var Vs={},qs=_a(Vs),Ks=_a(Vs),$s=_a(Vs);function Js(e){if(e===Vs)throw Error(s(174));return e}function Qs(e,t){switch(Na($s,t),Na(Ks,e),Na(qs,Vs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ja(qs),Na(qs,t)}function Gs(){ja(qs),ja(Ks),ja($s)}function Ys(e){Js($s.current);var t=Js(qs.current),n=le(t,e.type);t!==n&&(Na(Ks,e),Na(qs,n))}function Zs(e){Ks.current===e&&(ja(qs),ja(Ks))}var Xs=_a(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=w.ReactCurrentDispatcher,ao=w.ReactCurrentBatchConfig,so=0,oo=null,io=null,lo=null,co=!1,uo=!1,ho=0,po=0;function fo(){throw Error(s(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ir(e[n],t[n]))return!1;return!0}function go(e,t,n,r,a,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Xo:ei,e=n(r,a),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(s(301));o+=1,lo=io=null,t.updateQueue=null,ro.current=ti,e=n(r,a)}while(uo)}if(ro.current=Zo,t=null!==io&&null!==io.next,so=0,lo=io=oo=null,co=!1,t)throw Error(s(300));return e}function vo(){var e=0!==ho;return ho=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function bo(){if(null===io){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=io.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,io=e;else{if(null===e)throw Error(s(310));e={memoizedState:(io=e).memoizedState,baseState:io.baseState,baseQueue:io.baseQueue,queue:io.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function wo(e,t){return"function"===typeof t?t(e):t}function xo(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=io,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var i=a.next;a.next=o.next,o.next=i}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var l=i=null,c=null,u=o;do{var d=u.lane;if((so&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,i=r):c=c.next=h,oo.lanes|=d,Ol|=d}u=u.next}while(null!==u&&u!==o);null===c?i=r:c.next=l,ir(r,t.memoizedState)||(bi=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,oo.lanes|=o,Ol|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function So(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var i=a=a.next;do{o=e(o,i.action),i=i.next}while(i!==a);ir(o,t.memoizedState)||(bi=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ko(){}function _o(e,t){var n=oo,r=bo(),a=t(),o=!ir(r.memoizedState,a);if(o&&(r.memoizedState=a,bi=!0),r=r.queue,Oo(Eo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Po(9,No.bind(null,n,r,a,t),void 0,null),null===Tl)throw Error(s(349));0!==(30&so)||jo(n,t,a)}return a}function jo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function No(e,t,n,r){t.value=n,t.getSnapshot=r,Co(t)&&To(e)}function Eo(e,t,n){return n(function(){Co(t)&&To(e)})}function Co(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ir(e,n)}catch(r){return!0}}function To(e){var t=Ds(e,1);null!==t&&nc(t,e,1,-1)}function Io(e){var t=yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Jo.bind(null,oo,e),[t.memoizedState,e]}function Po(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ao(){return bo().memoizedState}function Ro(e,t,n,r){var a=yo();oo.flags|=e,a.memoizedState=Po(1|t,n,void 0,void 0===r?null:r)}function Do(e,t,n,r){var a=bo();r=void 0===r?null:r;var s=void 0;if(null!==io){var o=io.memoizedState;if(s=o.destroy,null!==r&&mo(r,o.deps))return void(a.memoizedState=Po(t,n,s,r))}oo.flags|=e,a.memoizedState=Po(1|t,n,s,r)}function Lo(e,t){return Ro(8390656,8,e,t)}function Oo(e,t){return Do(2048,8,e,t)}function Uo(e,t){return Do(4,2,e,t)}function Mo(e,t){return Do(4,4,e,t)}function zo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Fo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Do(4,4,zo.bind(null,t,e),n)}function Ho(){}function Bo(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Wo(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Vo(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,bi=!0),e.memoizedState=n):(ir(n,t)||(n=mt(),oo.lanes|=n,Ol|=n,e.baseState=!0),t)}function qo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ao.transition;ao.transition={};try{e(!1),t()}finally{bt=n,ao.transition=r}}function Ko(){return bo().memoizedState}function $o(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qo(e))Go(t,n);else if(null!==(n=Rs(e,t,n,r))){nc(n,e,r,ec()),Yo(n,t,r)}}function Jo(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))Go(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,i=s(o,n);if(a.hasEagerState=!0,a.eagerState=i,ir(i,o)){var l=t.interleaved;return null===l?(a.next=a,As(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Rs(e,t,a,r))&&(nc(n,e,r,a=ec()),Yo(n,t,r))}}function Qo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Go(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Zo={readContext:Is,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},Xo={readContext:Is,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:Is,useEffect:Lo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ro(4194308,4,zo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ro(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ro(4,2,e,t)},useMemo:function(e,t){var n=yo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=$o.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:Io,useDebugValue:Ho,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=Io(!1),t=e[0];return e=qo.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,a=yo();if(as){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Tl)throw Error(s(349));0!==(30&so)||jo(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Lo(Eo.bind(null,r,o,e),[e]),r.flags|=2048,Po(9,No.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=yo(),t=Tl.identifierPrefix;if(as){var n=Ya;t=":"+t+"R"+(n=(Ga&~(1<<32-ot(Ga)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ei={readContext:Is,useCallback:Bo,useContext:Is,useEffect:Oo,useImperativeHandle:Fo,useInsertionEffect:Uo,useLayoutEffect:Mo,useMemo:Wo,useReducer:xo,useRef:Ao,useState:function(){return xo(wo)},useDebugValue:Ho,useDeferredValue:function(e){return Vo(bo(),io.memoizedState,e)},useTransition:function(){return[xo(wo)[0],bo().memoizedState]},useMutableSource:ko,useSyncExternalStore:_o,useId:Ko,unstable_isNewReconciler:!1},ti={readContext:Is,useCallback:Bo,useContext:Is,useEffect:Oo,useImperativeHandle:Fo,useInsertionEffect:Uo,useLayoutEffect:Mo,useMemo:Wo,useReducer:So,useRef:Ao,useState:function(){return So(wo)},useDebugValue:Ho,useDeferredValue:function(e){var t=bo();return null===io?t.memoizedState=e:Vo(t,io.memoizedState,e)},useTransition:function(){return[So(wo)[0],bo().memoizedState]},useMutableSource:ko,useSyncExternalStore:_o,useId:Ko,unstable_isNewReconciler:!1};function ni(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ri(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ai={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),s=Ms(r,a);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=zs(e,s,a))&&(nc(t,e,a,r),Fs(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),s=Ms(r,a);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=zs(e,s,a))&&(nc(t,e,a,r),Fs(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=Ms(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=zs(e,a,r))&&(nc(t,e,r,n),Fs(t,e,r))}};function si(e,t,n,r,a,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,s))}function oi(e,t,n){var r=!1,a=Ea,s=t.contextType;return"object"===typeof s&&null!==s?s=Is(s):(a=Aa(t)?Ia:Ca.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pa(e,a):Ea),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ai,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function ii(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ai.enqueueReplaceState(t,t.state,null)}function li(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Os(e);var s=t.contextType;"object"===typeof s&&null!==s?a.context=Is(s):(s=Aa(t)?Ia:Ca.current,a.context=Pa(e,s)),a.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ri(e,t,s,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ai.enqueueReplaceState(a,a.state,null),Bs(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function ci(e,t){try{var n="",r=t;do{n+=H(r),r=r.return}while(r);var a=n}catch(s){a="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:a,digest:null}}function ui(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function di(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var hi="function"===typeof WeakMap?WeakMap:Map;function pi(e,t,n){(n=Ms(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vl||(Vl=!0,ql=r),di(0,t)},n}function fi(e,t,n){(n=Ms(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){di(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){di(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mi(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hi;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=jc.bind(null,e,t,n),t.then(e,e))}function gi(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vi(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ms(-1,1)).tag=2,zs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var yi=w.ReactCurrentOwner,bi=!1;function wi(e,t,n,r){t.child=null===e?xs(t,null,n,r):ws(t,e.child,n,r)}function xi(e,t,n,r,a){n=n.render;var s=t.ref;return Ts(t,a),r=go(e,t,n,r,s,a),n=vo(),null===e||bi?(as&&n&&es(t),t.flags|=1,wi(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vi(e,t,a))}function Si(e,t,n,r,a){if(null===e){var s=n.type;return"function"!==typeof s||Ac(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,ki(e,t,s,r,a))}if(s=e.child,0===(e.lanes&a)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return Vi(e,t,a)}return t.flags|=1,(e=Rc(s,r)).ref=t.ref,e.return=t,t.child=e}function ki(e,t,n,r,a){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(bi=!1,t.pendingProps=r=s,0===(e.lanes&a))return t.lanes=e.lanes,Vi(e,t,a);0!==(131072&e.flags)&&(bi=!0)}}return Ni(e,t,n,r,a)}function _i(e,t,n){var r=t.pendingProps,a=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Na(Rl,Al),Al|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Na(Rl,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Na(Rl,Al),Al|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Na(Rl,Al),Al|=r;return wi(e,t,a,n),t.child}function ji(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ni(e,t,n,r,a){var s=Aa(n)?Ia:Ca.current;return s=Pa(t,s),Ts(t,a),n=go(e,t,n,r,s,a),r=vo(),null===e||bi?(as&&r&&es(t),t.flags|=1,wi(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vi(e,t,a))}function Ei(e,t,n,r,a){if(Aa(n)){var s=!0;Oa(t)}else s=!1;if(Ts(t,a),null===t.stateNode)Wi(e,t),oi(t,n,r),li(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,i=t.memoizedProps;o.props=i;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Is(c):c=Pa(t,c=Aa(n)?Ia:Ca.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==r||l!==c)&&ii(t,o,r,c),Ls=!1;var h=t.memoizedState;o.state=h,Bs(t,r,o,a),l=t.memoizedState,i!==r||h!==l||Ta.current||Ls?("function"===typeof u&&(ri(t,n,u,r),l=t.memoizedState),(i=Ls||si(t,n,i,r,h,l,c))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=i):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Us(e,t),i=t.memoizedProps,c=t.type===t.elementType?i:ni(t.type,i),o.props=c,d=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Is(l):l=Pa(t,l=Aa(n)?Ia:Ca.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==d||h!==l)&&ii(t,o,r,l),Ls=!1,h=t.memoizedState,o.state=h,Bs(t,r,o,a);var f=t.memoizedState;i!==d||h!==f||Ta.current||Ls?("function"===typeof p&&(ri(t,n,p,r),f=t.memoizedState),(c=Ls||si(t,n,c,r,h,f,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ci(e,t,n,r,s,a)}function Ci(e,t,n,r,a,s){ji(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&Ua(t,n,!1),Vi(e,t,s);r=t.stateNode,yi.current=t;var i=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,i,s)):wi(e,t,i,s),t.memoizedState=r.state,a&&Ua(t,n,!0),t.child}function Ti(e){var t=e.stateNode;t.pendingContext?Da(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Da(0,t.context,!1),Qs(e,t.containerInfo)}function Ii(e,t,n,r,a){return ps(),fs(a),t.flags|=256,wi(e,t,n,r),t.child}var Pi,Ai,Ri,Di,Li={dehydrated:null,treeContext:null,retryLane:0};function Oi(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ui(e,t,n){var r,a=t.pendingProps,o=Xs.current,i=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Na(Xs,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,i?(a=t.mode,i=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==i?(i.childLanes=0,i.pendingProps=l):i=Oc(l,a,0,null),e=Lc(e,a,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Oi(n),t.memoizedState=Li,e):Mi(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,i){if(n)return 256&t.flags?(t.flags&=-257,zi(e,t,i,r=ui(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Oc({mode:"visible",children:r.children},a,0,null),(o=Lc(o,a,i,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,i),t.child.memoizedState=Oi(i),t.memoizedState=Li,o);if(0===(1&t.mode))return zi(e,t,i,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,zi(e,t,i,r=ui(o=Error(s(419)),r,void 0))}if(l=0!==(i&e.childLanes),bi||l){if(null!==(r=Tl)){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|i))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ds(e,a),nc(r,e,a,-1))}return mc(),zi(e,t,i,r=ui(Error(s(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,rs=ca(a.nextSibling),ns=t,as=!0,ss=null,null!==e&&($a[Ja++]=Ga,$a[Ja++]=Ya,$a[Ja++]=Qa,Ga=e.id,Ya=e.overflow,Qa=t),t=Mi(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,o,n);if(i){i=a.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Rc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?i=Rc(r,i):(i=Lc(i,l,n,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,l=null===(l=e.child.memoizedState)?Oi(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=Li,a}return e=(i=e.child).sibling,a=Rc(i,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Mi(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zi(e,t,n,r){return null!==r&&fs(r),ws(t,e.child,null,n),(e=Mi(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fi(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Cs(e.return,t,n)}function Hi(e,t,n,r,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a)}function Bi(e,t,n){var r=t.pendingProps,a=r.revealOrder,s=r.tail;if(wi(e,t,r.children,n),0!==(2&(r=Xs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fi(e,n,t);else if(19===e.tag)Fi(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Na(Xs,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Hi(t,!1,a,n,s);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===eo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Hi(t,!0,n,null,s);break;case"together":Hi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wi(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vi(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qi(e,t){if(!as)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ki(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function $i(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ki(t),null;case 1:case 17:return Aa(t.type)&&Ra(),Ki(t),null;case 3:return r=t.stateNode,Gs(),ja(Ta),ja(Ca),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Ai(e,t),Ki(t),null;case 5:Zs(t);var a=Js($s.current);if(n=t.type,null!==e&&null!=t.stateNode)Ri(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ki(t),null}if(e=Js(qs.current),ds(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[ha]=t,r[pa]=o,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(a=0;a<Lr.length;a++)zr(Lr[a],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":G(r,o),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},zr("invalid",r);break;case"textarea":ae(r,o),zr("invalid",r)}for(var l in ye(n,o),a=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,c,e),a=["children",""+c]):i.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zr("scroll",r)}switch(n){case"input":K(r),X(r,o,!0);break;case"textarea":K(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Xr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ha]=t,e[pa]=r,Pi(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),a=r;break;case"iframe":case"object":case"embed":zr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Lr.length;a++)zr(Lr[a],e);a=r;break;case"source":zr("error",e),a=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),a=r;break;case"details":zr("toggle",e),a=r;break;case"input":G(e,r),a=Q(e,r),zr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=U({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),zr("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(i.hasOwnProperty(o)?null!=u&&"onScroll"===o&&zr("scroll",e):null!=u&&b(e,o,u,l))}switch(n){case"input":K(e),X(e,r,!1);break;case"textarea":K(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Xr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ki(t),null;case 6:if(e&&null!=t.stateNode)Di(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Js($s.current),Js(qs.current),ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return Ki(t),null;case 13:if(ja(Xs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(as&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))hs(),ps(),t.flags|=98560,o=!1;else if(o=ds(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[ha]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ki(t),o=!1}else null!==ss&&(oc(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Xs.current)?0===Dl&&(Dl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ki(t),null);case 4:return Gs(),Ai(e,t),null===e&&Br(t.stateNode.containerInfo),Ki(t),null;case 10:return Es(t.type._context),Ki(t),null;case 19:if(ja(Xs),null===(o=t.memoizedState))return Ki(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)qi(o,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,qi(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Na(Xs,1&Xs.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>Bl&&(t.flags|=128,r=!0,qi(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qi(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!as)return Ki(t),null}else 2*Ye()-o.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,qi(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=Xs.current,Na(Xs,r?1&n|2:1&n),t):(Ki(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Al)&&(Ki(t),6&t.subtreeFlags&&(t.flags|=8192)):Ki(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ji(e,t){switch(ts(t),t.tag){case 1:return Aa(t.type)&&Ra(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Gs(),ja(Ta),ja(Ca),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zs(t),null;case 13:if(ja(Xs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ja(Xs),null;case 4:return Gs(),null;case 10:return Es(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Pi=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ai=function(){},Ri=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Js(qs.current);var s,o=null;switch(n){case"input":a=Q(e,a),r=Q(e,r),o=[];break;case"select":a=U({},a,{value:void 0}),r=U({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Xr)}for(u in ye(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(i.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(i.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zr("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Di=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qi=!1,Gi=!1,Yi="function"===typeof WeakSet?WeakSet:Set,Zi=null;function Xi(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){_c(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){_c(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,void 0!==s&&el(t,n,s)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[ma],delete t[ga],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function il(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(at,n)}catch(i){}switch(n.tag){case 5:Gi||Xi(n,t);case 6:var r=ul,a=dl;ul=null,hl(e,t,n),dl=a,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Bt(e)):la(ul,n.stateNode));break;case 4:r=ul,a=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=a;break;case 0:case 11:case 14:case 15:if(!Gi&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var s=a,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),a=a.next}while(a!==r)}hl(e,t,n);break;case 1:if(!Gi&&(Xi(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){_c(n,t,i)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Gi=(r=Gi)||null!==n.memoizedState,hl(e,t,n),Gi=r):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Yi),t.forEach(function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,i=t,l=i;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));pl(o,i,a),ul=null,dl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(u){_c(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){_c(e,e.return,g)}try{nl(5,e,e.return)}catch(g){_c(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&r&&null!==n&&Xi(n,n.return);break;case 5:if(ml(t,e),vl(e),512&r&&null!==n&&Xi(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){_c(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,i=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&Y(a,o),be(l,i);var u=be(l,o);for(i=0;i<c.length;i+=2){var d=c[i],h=c[i+1];"style"===d?ge(a,h):"dangerouslySetInnerHTML"===d?de(a,h):"children"===d?he(a,h):b(a,d,h,u)}switch(l){case"input":Z(a,o);break;case"textarea":se(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(a,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[pa]=o}catch(g){_c(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(s(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(g){_c(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){_c(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Hl=Ye())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Gi=(u=Gi)||d,ml(t,e),Gi=u):ml(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Zi=e,d=e.child;null!==d;){for(h=Zi=d;null!==Zi;){switch(f=(p=Zi).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Xi(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){_c(r,n,g)}}break;case 5:Xi(p,p.return);break;case 22:if(null!==p.memoizedState){xl(h);continue}}null!==f?(f.return=p,Zi=f):xl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,u?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,i=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",i))}catch(g){_c(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){_c(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&r&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cl(e,il(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,il(e),o);break;default:throw Error(s(161))}}catch(i){_c(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Zi=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Zi;){var a=Zi,s=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Qi;if(!o){var i=a.alternate,l=null!==i&&null!==i.memoizedState||Gi;i=Qi;var c=Gi;if(Qi=o,(Gi=l)&&!c)for(Zi=a;null!==Zi;)l=(o=Zi).child,22===o.tag&&null!==o.memoizedState?Sl(a):null!==l?(l.return=o,Zi=l):Sl(a);for(;null!==s;)Zi=s,bl(s,t,n),s=s.sibling;Zi=a,Qi=i,Gi=c}wl(e)}else 0!==(8772&a.subtreeFlags)&&null!==s?(s.return=a,Zi=s):wl(e)}}function wl(e){for(;null!==Zi;){var t=Zi;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Gi||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Gi)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ni(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ws(t,o,r);break;case 3:var i=t.updateQueue;if(null!==i){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ws(t,i,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(s(163))}Gi||512&t.flags&&al(t)}catch(p){_c(t,t.return,p)}}if(t===e){Zi=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zi=n;break}Zi=t.return}}function xl(e){for(;null!==Zi;){var t=Zi;if(t===e){Zi=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zi=n;break}Zi=t.return}}function Sl(e){for(;null!==Zi;){var t=Zi;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){_c(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){_c(t,a,l)}}var s=t.return;try{al(t)}catch(l){_c(t,s,l)}break;case 5:var o=t.return;try{al(t)}catch(l){_c(t,o,l)}}}catch(l){_c(t,t.return,l)}if(t===e){Zi=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Zi=i;break}Zi=t.return}}var kl,_l=Math.ceil,jl=w.ReactCurrentDispatcher,Nl=w.ReactCurrentOwner,El=w.ReactCurrentBatchConfig,Cl=0,Tl=null,Il=null,Pl=0,Al=0,Rl=_a(0),Dl=0,Ll=null,Ol=0,Ul=0,Ml=0,zl=null,Fl=null,Hl=0,Bl=1/0,Wl=null,Vl=!1,ql=null,Kl=null,$l=!1,Jl=null,Ql=0,Gl=0,Yl=null,Zl=-1,Xl=0;function ec(){return 0!==(6&Cl)?Ye():-1!==Zl?Zl:Zl=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Pl?Pl&-Pl:null!==ms.transition?(0===Xl&&(Xl=mt()),Xl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Gt(e.type)}function nc(e,t,n,r){if(50<Gl)throw Gl=0,Yl=null,Error(s(185));vt(e,n,r),0!==(2&Cl)&&e===Tl||(e===Tl&&(0===(2&Cl)&&(Ul|=n),4===Dl&&ic(e,Pl)),rc(e,r),1===n&&0===Cl&&0===(1&t.mode)&&(Bl=Ye()+500,za&&Ba()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),i=1<<o,l=a[o];-1===l?0!==(i&n)&&0===(i&r)||(a[o]=pt(i,t)):l<=t&&(e.expiredLanes|=i),s&=~i}}(e,t);var r=ht(e,e===Tl?Pl:0);if(0===r)null!==n&&Je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Je(n),1===t)0===e.tag?function(e){za=!0,Ha(e)}(lc.bind(null,e)):Ha(lc.bind(null,e)),oa(function(){0===(6&Cl)&&Ba()}),n=null;else{switch(wt(r)){case 1:n=Xe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Zl=-1,Xl=0,0!==(6&Cl))throw Error(s(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=ht(e,e===Tl?Pl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=Cl;Cl|=2;var o=fc();for(Tl===e&&Pl===t||(Wl=null,Bl=Ye()+500,hc(e,t));;)try{yc();break}catch(l){pc(e,l)}Ns(),jl.current=o,Cl=a,null!==Il?t=0:(Tl=null,Pl=0,t=Dl)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(r=a,t=sc(e,a))),1===t)throw n=Ll,hc(e,0),ic(e,r),rc(e,Ye()),n;if(6===t)ic(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],s=a.getSnapshot;a=a.value;try{if(!ir(s(),a))return!1}catch(i){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(o=ft(e))&&(r=o,t=sc(e,o))),1===t))throw n=Ll,hc(e,0),ic(e,r),rc(e,Ye()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:xc(e,Fl,Wl);break;case 3:if(ic(e,r),(130023424&r)===r&&10<(t=Hl+500-Ye())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(xc.bind(null,e,Fl,Wl),t);break}xc(e,Fl,Wl);break;case 4:if(ic(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var i=31-ot(r);o=1<<i,(i=t[i])>a&&(a=i),r&=~o}if(r=a,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_l(r/1960))-r)){e.timeoutHandle=ra(xc.bind(null,e,Fl,Wl),r);break}xc(e,Fl,Wl);break;default:throw Error(s(329))}}}return rc(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function sc(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Fl,Fl=n,null!==t&&oc(t)),e}function oc(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function ic(e,t){for(t&=~Ml,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Cl))throw Error(s(327));Sc();var t=ht(e,0);if(0===(1&t))return rc(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Ll,hc(e,0),ic(e,t),rc(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Fl,Wl),rc(e,Ye()),null}function cc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Bl=Ye()+500,za&&Ba())}}function uc(e){null!==Jl&&0===Jl.tag&&0===(6&Cl)&&Sc();var t=Cl;Cl|=1;var n=El.transition,r=bt;try{if(El.transition=null,bt=1,e)return e()}finally{bt=r,El.transition=n,0===(6&(Cl=t))&&Ba()}}function dc(){Al=Rl.current,ja(Rl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Il)for(n=Il.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ra();break;case 3:Gs(),ja(Ta),ja(Ca),no();break;case 5:Zs(r);break;case 4:Gs();break;case 13:case 19:ja(Xs);break;case 10:Es(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Tl=e,Il=e=Rc(e.current,null),Pl=Al=t,Dl=0,Ll=null,Ml=Ul=Ol=0,Fl=zl=null,null!==Ps){for(t=0;t<Ps.length;t++)if(null!==(r=(n=Ps[t]).interleaved)){n.interleaved=null;var a=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=a,r.next=o}n.pending=r}Ps=null}return e}function pc(e,t){for(;;){var n=Il;try{if(Ns(),ro.current=Zo,co){for(var r=oo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}co=!1}if(so=0,lo=io=oo=null,uo=!1,ho=0,Nl.current=null,null===n||null===n.return){Dl=1,Ll=t,Il=null;break}e:{var o=e,i=n.return,l=n,c=t;if(t=Pl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=gi(i);if(null!==f){f.flags&=-257,vi(f,i,l,0,t),1&f.mode&&mi(o,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mi(o,u,t),mc();break e}c=Error(s(426))}else if(as&&1&l.mode){var v=gi(i);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vi(v,i,l,0,t),fs(ci(c,l));break e}}o=c=ci(c,l),4!==Dl&&(Dl=2),null===zl?zl=[o]:zl.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Hs(o,pi(0,c,t));break e;case 1:l=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Kl||!Kl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Hs(o,fi(o,l,t));break e}}o=o.return}while(null!==o)}wc(n)}catch(w){t=w,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function fc(){var e=jl.current;return jl.current=Zo,null===e?Zo:e}function mc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Tl||0===(268435455&Ol)&&0===(268435455&Ul)||ic(Tl,Pl)}function gc(e,t){var n=Cl;Cl|=2;var r=fc();for(Tl===e&&Pl===t||(Wl=null,hc(e,t));;)try{vc();break}catch(a){pc(e,a)}if(Ns(),Cl=n,jl.current=r,null!==Il)throw Error(s(261));return Tl=null,Pl=0,Dl}function vc(){for(;null!==Il;)bc(Il)}function yc(){for(;null!==Il&&!Qe();)bc(Il)}function bc(e){var t=kl(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?wc(e):Il=t,Nl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=$i(n,t,Al)))return void(Il=n)}else{if(null!==(n=Ji(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Dl=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Dl&&(Dl=5)}function xc(e,t,n){var r=bt,a=El.transition;try{El.transition=null,bt=1,function(e,t,n,r){do{Sc()}while(null!==Jl);if(0!==(6&Cl))throw Error(s(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),s=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~s}}(e,o),e===Tl&&(Il=Tl=null,Pl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||$l||($l=!0,Tc(tt,function(){return Sc(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=El.transition,El.transition=null;var i=bt;bt=1;var l=Cl;Cl|=4,Nl.current=null,function(e,t){if(ea=Vt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break e}var i=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==a&&3!==h.nodeType||(l=i+a),h!==o||0!==r&&3!==h.nodeType||(c=i+r),3===h.nodeType&&(i+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===a&&(l=i),p===o&&++d===r&&(c=i),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Vt=!1,Zi=t;null!==Zi;)if(e=(t=Zi).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zi=e;else for(;null!==Zi;){t=Zi;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ni(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(x){_c(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Zi=e;break}Zi=t.return}m=tl,tl=!1}(e,n),gl(n,e),fr(ta),Vt=!!ea,ta=ea=null,e.current=n,yl(n,e,a),Ge(),Cl=l,bt=i,El.transition=o}else e.current=n;if($l&&($l=!1,Jl=e,Ql=a),o=e.pendingLanes,0===o&&(Kl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Vl)throw Vl=!1,e=ql,ql=null,e;0!==(1&Ql)&&0!==e.tag&&Sc(),o=e.pendingLanes,0!==(1&o)?e===Yl?Gl++:(Gl=0,Yl=e):Gl=0,Ba()}(e,t,n,r)}finally{El.transition=a,bt=r}return null}function Sc(){if(null!==Jl){var e=wt(Ql),t=El.transition,n=bt;try{if(El.transition=null,bt=16>e?16:e,null===Jl)var r=!1;else{if(e=Jl,Jl=null,Ql=0,0!==(6&Cl))throw Error(s(331));var a=Cl;for(Cl|=4,Zi=e.current;null!==Zi;){var o=Zi,i=o.child;if(0!==(16&Zi.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zi=u;null!==Zi;){var d=Zi;switch(d.tag){case 0:case 11:case 15:nl(8,d,o)}var h=d.child;if(null!==h)h.return=d,Zi=h;else for(;null!==Zi;){var p=(d=Zi).sibling,f=d.return;if(sl(d),d===u){Zi=null;break}if(null!==p){p.return=f,Zi=p;break}Zi=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Zi=o}}if(0!==(2064&o.subtreeFlags)&&null!==i)i.return=o,Zi=i;else e:for(;null!==Zi;){if(0!==(2048&(o=Zi).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Zi=y;break e}Zi=o.return}}var b=e.current;for(Zi=b;null!==Zi;){var w=(i=Zi).child;if(0!==(2064&i.subtreeFlags)&&null!==w)w.return=i,Zi=w;else e:for(i=b;null!==Zi;){if(0!==(2048&(l=Zi).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(S){_c(l,l.return,S)}if(l===i){Zi=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Zi=x;break e}Zi=l.return}}if(Cl=a,Ba(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(at,e)}catch(S){}r=!0}return r}finally{bt=n,El.transition=t}}return!1}function kc(e,t,n){e=zs(e,t=pi(0,t=ci(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function _c(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=zs(t,e=fi(t,e=ci(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function jc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Pl&n)===n&&(4===Dl||3===Dl&&(130023424&Pl)===Pl&&500>Ye()-Hl?hc(e,0):Ml|=n),rc(e,t)}function Nc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ds(e,t))&&(vt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Nc(e,n)}function Tc(e,t){return $e(e,t)}function Ic(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,n,r){return new Ic(e,t,n,r)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,r,a,o){var i=2;if(r=e,"function"===typeof e)Ac(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case k:return Lc(n.children,a,o,t);case _:i=8,a|=8;break;case j:return(e=Pc(12,n,t,2|a)).elementType=j,e.lanes=o,e;case T:return(e=Pc(13,n,t,a)).elementType=T,e.lanes=o,e;case I:return(e=Pc(19,n,t,a)).elementType=I,e.lanes=o,e;case R:return Oc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case N:i=10;break e;case E:i=9;break e;case C:i=11;break e;case P:i=14;break e;case A:i=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Pc(i,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Lc(e,t,n,r){return(e=Pc(7,e,r,t)).lanes=n,e}function Oc(e,t,n,r){return(e=Pc(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=Pc(6,e,null,t)).lanes=n,e}function Mc(e,t,n){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Fc(e,t,n,r,a,s,o,i,l){return e=new zc(e,t,n,i,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Pc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Os(s),e}function Hc(e){if(!e)return Ea;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Aa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Aa(n))return La(e,n,t)}return t}function Bc(e,t,n,r,a,s,o,i,l){return(e=Fc(n,r,!0,e,0,s,0,i,l)).context=Hc(null),n=e.current,(s=Ms(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,zs(n,s,a),e.current.lanes=a,vt(e,a,r),rc(e,r),e}function Wc(e,t,n,r){var a=t.current,s=ec(),o=tc(a);return n=Hc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ms(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zs(a,t,o))&&(nc(e,a,o,s),Fs(e,a,o)),o}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ta.current)bi=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bi=!1,function(e,t,n){switch(t.tag){case 3:Ti(t),ps();break;case 5:Ys(t);break;case 1:Aa(t.type)&&Oa(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Na(Ss,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Na(Xs,1&Xs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ui(e,t,n):(Na(Xs,1&Xs.current),null!==(e=Vi(e,t,n))?e.sibling:null);Na(Xs,1&Xs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bi(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Na(Xs,Xs.current),r)break;return null;case 22:case 23:return t.lanes=0,_i(e,t,n)}return Vi(e,t,n)}(e,t,n);bi=0!==(131072&e.flags)}else bi=!1,as&&0!==(1048576&t.flags)&&Xa(t,Ka,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wi(e,t),e=t.pendingProps;var a=Pa(t,Ca.current);Ts(t,n),a=go(null,t,r,e,a,n);var o=vo();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Aa(r)?(o=!0,Oa(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Os(t),a.updater=ai,t.stateNode=a,a._reactInternals=t,li(t,r,e,n),t=Ci(null,t,r,!0,o,n)):(t.tag=0,as&&o&&es(t),wi(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wi(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Ac(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===P)return 14}return 2}(r),e=ni(r,e),a){case 0:t=Ni(null,t,r,e,n);break e;case 1:t=Ei(null,t,r,e,n);break e;case 11:t=xi(null,t,r,e,n);break e;case 14:t=Si(null,t,r,ni(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ni(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 1:return r=t.type,a=t.pendingProps,Ei(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 3:e:{if(Ti(t),null===e)throw Error(s(387));r=t.pendingProps,a=(o=t.memoizedState).element,Us(e,t),Bs(t,r,null,n);var i=t.memoizedState;if(r=i.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ii(e,t,r,n,a=ci(Error(s(423)),t));break e}if(r!==a){t=Ii(e,t,r,n,a=ci(Error(s(424)),t));break e}for(rs=ca(t.stateNode.containerInfo.firstChild),ns=t,as=!0,ss=null,n=xs(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),r===a){t=Vi(e,t,n);break e}wi(e,t,r,n)}t=t.child}return t;case 5:return Ys(t),null===e&&cs(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,i=a.children,na(r,a)?i=null:null!==o&&na(r,o)&&(t.flags|=32),ji(e,t),wi(e,t,i,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Ui(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wi(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,xi(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 7:return wi(e,t,t.pendingProps,n),t.child;case 8:case 12:return wi(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,i=a.value,Na(Ss,r._currentValue),r._currentValue=i,null!==o)if(ir(o.value,i)){if(o.children===a.children&&!Ta.current){t=Vi(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){i=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Ms(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Cs(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)i=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(i=o.return))throw Error(s(341));i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Cs(i,n,t),i=o.sibling}else i=o.child;if(null!==i)i.return=o;else for(i=o;null!==i;){if(i===t){i=null;break}if(null!==(o=i.sibling)){o.return=i.return,i=o;break}i=i.return}o=i}wi(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ts(t,n),r=r(a=Is(a)),t.flags|=1,wi(e,t,r,n),t.child;case 14:return a=ni(r=t.type,t.pendingProps),Si(e,t,r,a=ni(r.type,a),n);case 15:return ki(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ni(r,a),Wi(e,t),t.tag=1,Aa(r)?(e=!0,Oa(t)):e=!1,Ts(t,n),oi(t,r,a),li(t,r,a,n),Ci(null,t,r,!0,e,n);case 19:return Bi(e,t,n);case 22:return _i(e,t,n)}throw Error(s(156,t.tag))};var $c="function"===typeof reportError?reportError:function(e){console.error(e)};function Jc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Gc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function Xc(e,t,n,r,a){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof a){var i=a;a=function(){var e=Vc(o);i.call(e)}}Wc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var s=r;r=function(){var e=Vc(o);s.call(e)}}var o=Bc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=o,e[fa]=o.current,Br(8===e.nodeType?e.parentNode:e),uc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var i=r;r=function(){var e=Vc(l);i.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[fa]=l.current,Br(8===e.nodeType?e.parentNode:e),uc(function(){Wc(t,l,n,r)}),l}(n,t,e,a,r);return Vc(o)}Qc.prototype.render=Jc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Wc(e,t,null,null)},Qc.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Wc(null,e,null,null)}),t[fa]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Ut(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Ye()),0===(6&Cl)&&(Bl=Ye()+500,Ba()))}break;case 13:uc(function(){var t=Ds(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Kc(e,1)}},St=function(e){if(13===e.tag){var t=Ds(e,134217728);if(null!==t)nc(t,e,134217728,ec());Kc(e,134217728)}},kt=function(e){if(13===e.tag){var t=tc(e),n=Ds(e,t);if(null!==n)nc(n,e,t,ec());Kc(e,t)}},_t=function(){return bt},jt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Se=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=xa(r);if(!a)throw Error(s(90));$(r),Z(r,a)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=cc,Te=uc;var eu={usingClientEntryPoint:!1,Events:[ba,wa,xa,Ne,Ee,cc]},tu={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{at=ru.inject(nu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Gc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Gc(e))throw Error(s(299));var n=!1,r="",a=$c;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Fc(e,1,!1,null,0,n,0,r,a),e[fa]=t.current,Br(8===e.nodeType?e.parentNode:e),new Jc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(s(200));return Xc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Gc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",i=$c;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(i=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,a,0,o,i),e[fa]=t.current,Br(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Qc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(s(200));return Xc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){Xc(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Xc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l=n(43),c=n(391);function u(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const d=["sri"],h=["page"],p=["page","matches"],f=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],m=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],g=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var v="popstate";function y(){return j(function(e,t){let{pathname:n,search:r,hash:a}=e.location;return S("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:k(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function b(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function w(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function S(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return i(i({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?_(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function k(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function _(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function j(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:a=document.defaultView,v5Compat:s=!1}=r,o=a.history,l="POP",c=null,u=d();function d(){return(o.state||{idx:null}).idx}function h(){l="POP";let e=d(),t=null==e?null:e-u;u=e,c&&c({action:l,location:f.location,delta:t})}function p(e){return N(e)}null==u&&(u=0,o.replaceState(i(i({},o.state),{},{idx:u}),""));let f={get action(){return l},get location(){return e(a,o)},listen(e){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(v,h),c=e,()=>{a.removeEventListener(v,h),c=null}},createHref:e=>t(a,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let r=S(f.location,e,t);n&&n(r,e),u=d()+1;let i=x(r,u),h=f.createHref(r);try{o.pushState(i,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;a.location.assign(h)}s&&c&&c({action:l,location:f.location,delta:1})},replace:function(e,t){l="REPLACE";let r=S(f.location,e,t);n&&n(r,e),u=d();let a=x(r,u),i=f.createHref(r);o.replaceState(a,"",i),s&&c&&c({action:l,location:f.location,delta:0})},go:e=>o.go(e)};return f}function N(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),b(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:k(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function E(e,t){return C(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function C(e,t,n,r){let a=W(("string"===typeof t?_(t):t).pathname||"/",n);if(null==a)return null;let s=T(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let o=null;for(let i=0;null==o&&i<s.length;++i){let e=B(a);o=z(s[i],e,r)}return o}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,s){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,i=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&o)return;b(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let c=J([r,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(b(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),T(e.children,t,u,c,o)),(null!=e.path||e.index)&&t.push({path:c,score:M(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of I(e.path))s(e,t,!0,r);else s(e,t)}),t}function I(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return a?[s,""]:[s];let o=I(r.join("/")),i=[];return i.push(...o.map(e=>""===e?s:[s,e].join("/"))),a&&i.push(...o),i.map(t=>e.startsWith("/")&&""===t?"/":t)}var P=/^:[\w-]+$/,A=3,R=2,D=1,L=10,O=-2,U=e=>"*"===e;function M(e,t){let n=e.split("/"),r=n.length;return n.some(U)&&(r+=O),t&&(r+=R),n.filter(e=>!U(e)).reduce((e,t)=>e+(P.test(t)?A:""===t?D:L),r)}function z(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,a={},s="/",o=[];for(let i=0;i<r.length;++i){let e=r[i],l=i===r.length-1,c="/"===s?t:t.slice(s.length)||"/",u=F({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=F({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),o.push({params:a,pathname:J([s,u.pathname]),pathnameBase:Q(J([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=J([s,u.pathnameBase]))}return o}function F(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=H(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=i[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=i[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:o,pattern:e}}function H(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];w("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function B(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return w(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function W(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function V(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function q(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function K(e){let t=q(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function $(e,t,n){let r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=_(e):(r=i({},e),b(!r.pathname||!r.pathname.includes("?"),V("?","pathname","search",r)),b(!r.pathname||!r.pathname.includes("#"),V("#","pathname","hash",r)),b(!r.search||!r.search.includes("#"),V("#","search","hash",r)));let s,o=""===e||""===r.pathname,l=o?"/":r.pathname;if(null==l)s=n;else{let e=t.length-1;if(!a&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:a=""}="string"===typeof e?_(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:G(r),hash:Y(a)}}(r,s),u=l&&"/"!==l&&l.endsWith("/"),d=(o||"."===l)&&n.endsWith("/");return c.pathname.endsWith("/")||!u&&!d||(c.pathname+="/"),c}var J=e=>e.join("/").replace(/\/\/+/g,"/"),Q=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),G=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Y=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Z(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var X=["POST","PUT","PATCH","DELETE"],ee=(new Set(X),["GET",...X]);new Set(ee),Symbol("ResetLoaderData");var te=l.createContext(null);te.displayName="DataRouter";var ne=l.createContext(null);ne.displayName="DataRouterState";var re=l.createContext(!1);var ae=l.createContext({isTransitioning:!1});ae.displayName="ViewTransition";var se=l.createContext(new Map);se.displayName="Fetchers";var oe=l.createContext(null);oe.displayName="Await";var ie=l.createContext(null);ie.displayName="Navigation";var le=l.createContext(null);le.displayName="Location";var ce=l.createContext({outlet:null,matches:[],isDataRoute:!1});ce.displayName="Route";var ue=l.createContext(null);ue.displayName="RouteError";function de(){return null!=l.useContext(le)}function he(){return b(de(),"useLocation() may be used only in the context of a <Router> component."),l.useContext(le).location}var pe="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function fe(e){l.useContext(ie).static||l.useLayoutEffect(e)}function me(){let{isDataRoute:e}=l.useContext(ce);return e?function(){let{router:e}=je("useNavigate"),t=Ee("useNavigate"),n=l.useRef(!1);fe(()=>{n.current=!0});let r=l.useCallback(async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(n.current,pe),n.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,i({fromRouteId:t},a)))},[e,t]);return r}():function(){b(de(),"useNavigate() may be used only in the context of a <Router> component.");let e=l.useContext(te),{basename:t,navigator:n}=l.useContext(ie),{matches:r}=l.useContext(ce),{pathname:a}=he(),s=JSON.stringify(K(r)),o=l.useRef(!1);fe(()=>{o.current=!0});let i=l.useCallback(function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(w(o.current,pe),!o.current)return;if("number"===typeof r)return void n.go(r);let l=$(r,JSON.parse(s),a,"path"===i.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:J([t,l.pathname])),(i.replace?n.replace:n.push)(l,i.state,i)},[t,n,s,a,e]);return i}()}l.createContext(null);function ge(){let{matches:e}=l.useContext(ce),t=e[e.length-1];return t?t.params:{}}function ve(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=l.useContext(ce),{pathname:r}=he(),a=JSON.stringify(K(n));return l.useMemo(()=>$(e,JSON.parse(a),r,"path"===t),[e,a,r,t])}function ye(e,t,n,r,a){b(de(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=l.useContext(ie),{matches:o}=l.useContext(ce),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let e=p&&p.path||"";Ie(d,!p||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,m=he();if(t){var g;let e="string"===typeof t?_(t):t;b("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=m;let v=f.pathname||"/",y=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=E(e,{pathname:y});w(p||null!=x,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),w(null==x||void 0!==x[x.length-1].route.element||void 0!==x[x.length-1].route.Component||void 0!==x[x.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let S=ke(x&&x.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:J([h,s.encodeLocation?s.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:J([h,s.encodeLocation?s.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),o,n,r,a);return t&&S?l.createElement(le.Provider,{value:{location:i({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},S):S}function be(){let e=Ce(),t=Z(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=l.createElement(l.Fragment,null,l.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),l.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",l.createElement("code",{style:s},"ErrorBoundary")," or"," ",l.createElement("code",{style:s},"errorElement")," prop on your route.")),l.createElement(l.Fragment,null,l.createElement("h2",null,"Unexpected Application Error!"),l.createElement("h3",{style:{fontStyle:"italic"}},t),n?l.createElement("pre",{style:a},n):null,o)}var we=l.createElement(be,null),xe=class extends l.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?l.createElement(ce.Provider,{value:this.props.routeContext},l.createElement(ue.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Se(e){let{routeContext:t,match:n,children:r}=e,a=l.useContext(te);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),l.createElement(ce.Provider,{value:t},r)}function ke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let a=e,s=null===n||void 0===n?void 0:n.errors;if(null!=s){let e=a.findIndex(e=>e.route.id&&void 0!==(null===s||void 0===s?void 0:s[e.route.id]));b(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(s).join(","))),a=a.slice(0,Math.min(a.length,e+1))}let o=!1,i=-1;if(n)for(let l=0;l<a.length;l++){let e=a[l];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(i=l),e.route.id){let{loaderData:t,errors:r}=n,s=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||s){o=!0,a=i>=0?a.slice(0,i+1):[a[0]];break}}}return a.reduceRight((e,c,u)=>{let d,h=!1,p=null,f=null;n&&(d=s&&c.route.id?s[c.route.id]:void 0,p=c.route.errorElement||we,o&&(i<0&&0===u?(Ie("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,f=null):i===u&&(h=!0,f=c.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),g=()=>{let t;return t=d?p:h?f:c.route.Component?l.createElement(c.route.Component,null):c.route.element?c.route.element:e,l.createElement(Se,{match:c,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(c.route.ErrorBoundary||c.route.errorElement||0===u)?l.createElement(xe,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):g()},null)}function _e(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function je(e){let t=l.useContext(te);return b(t,_e(e)),t}function Ne(e){let t=l.useContext(ne);return b(t,_e(e)),t}function Ee(e){let t=function(e){let t=l.useContext(ce);return b(t,_e(e)),t}(e),n=t.matches[t.matches.length-1];return b(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Ce(){var e;let t=l.useContext(ue),n=Ne("useRouteError"),r=Ee("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[r]}var Te={};function Ie(e,t,n){t||Te[e]||(Te[e]=!0,w(!1,n))}var Pe={};function Ae(e,t){e||Pe[t]||(Pe[t]=!0,console.warn(t))}l.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:a}=e;return ye(t,void 0,r,a,n)});function Re(e){let{to:t,replace:n,state:r,relative:a}=e;b(de(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=l.useContext(ie);w(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=l.useContext(ce),{pathname:i}=he(),c=me(),u=$(t,K(o),i,"path"===a),d=JSON.stringify(u);return l.useEffect(()=>{c(JSON.parse(d),{replace:n,state:r,relative:a})},[c,d,a,n,r]),null}function De(e){b(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Le(e){let{basename:t="/",children:n=null,location:r,navigationType:a="POP",navigator:s,static:o=!1}=e;b(!de(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=t.replace(/^\/*/,"/"),c=l.useMemo(()=>({basename:i,navigator:s,static:o,future:{}}),[i,s,o]);"string"===typeof r&&(r=_(r));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:f="default"}=r,m=l.useMemo(()=>{let e=W(u,i);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:f},navigationType:a}},[i,u,d,h,p,f,a]);return w(null!=m,'<Router basename="'.concat(i,'"> is not able to match the URL "').concat(u).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:l.createElement(ie.Provider,{value:c},l.createElement(le.Provider,{children:n,value:m}))}function Oe(e){let{children:t,location:n}=e;return ye(Ue(t),n)}l.Component;function Ue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return l.Children.forEach(e,(e,r)=>{if(!l.isValidElement(e))return;let a=[...t,r];if(e.type===l.Fragment)return void n.push.apply(n,Ue(e.props.children,a));b(e.type===De,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),b(!e.props.index||!e.props.children,"An index route cannot have child routes.");let s={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=Ue(e.props.children,a)),n.push(s)}),n}var Me="get",ze="application/x-www-form-urlencoded";function Fe(e){return null!=e&&"string"===typeof e.tagName}function He(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(e=>[n,e]):[[n,r]])},[]))}var Be=null;var We=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ve(e){return null==e||We.has(e)?e:(w(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(ze,'"')),null)}function qe(e,t){let n,r,a,s,o;if(Fe(i=e)&&"form"===i.tagName.toLowerCase()){let o=e.getAttribute("action");r=o?W(o,t):null,n=e.getAttribute("method")||Me,a=Ve(e.getAttribute("enctype"))||ze,s=new FormData(e)}else if(function(e){return Fe(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Fe(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let o=e.form;if(null==o)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let i=e.getAttribute("formaction")||o.getAttribute("action");if(r=i?W(i,t):null,n=e.getAttribute("formmethod")||o.getAttribute("method")||Me,a=Ve(e.getAttribute("formenctype"))||Ve(o.getAttribute("enctype"))||ze,s=new FormData(o,e),!function(){if(null===Be)try{new FormData(document.createElement("form"),0),Be=!1}catch(e){Be=!0}return Be}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,r)}}else{if(Fe(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Me,r=null,a=ze,o=e}var i;return s&&"text/plain"===a&&(o=s,s=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function Ke(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function $e(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===W(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function Je(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Qe(e){return null!=e&&"string"===typeof e.page}function Ge(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ye(e,t,n,r,a,s){let o=(e,t)=>!n[t]||e.route.id!==n[t].route.id,i=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter((e,t)=>o(e,t)||i(e,t)):"data"===s?t.filter((t,s)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(o(t,s)||i(t,s))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function Ze(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1),[...new Set(r)];var r}function Xe(e,t){let n=new Set,r=new Set(t);return e.reduce((e,a)=>{if(t&&!Qe(a)&&"script"===a.as&&a.href&&r.has(a.href))return e;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(a));return n.has(s)||(n.add(s),e.push({key:s,link:a})),e},[])}function et(e,t){return"lazy"===e.mode&&!0===t}function tt(){let e=l.useContext(te);return Ke(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function nt(){let e=l.useContext(ne);return Ke(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var rt=l.createContext(void 0);function at(){let e=l.useContext(rt);return Ke(e,"You must render this element inside a <HydratedRouter> element"),e}function st(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function ot(e,t,n){if(n&&!ut)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}rt.displayName="FrameworkContext";function it(e){let{page:t}=e,n=u(e,h),{router:r}=tt(),a=l.useMemo(()=>E(r.routes,t,r.basename),[r.routes,t,r.basename]);return a?l.createElement(ct,i({page:t,matches:a},n)):null}function lt(e){let{manifest:t,routeModules:n}=at(),[r,a]=l.useState([]);return l.useEffect(()=>{let r=!1;return async function(e,t,n){return Xe((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await Je(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(Ge).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?i(i({},e),{},{rel:"prefetch",as:"style"}):i(i({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{r||a(e)}),()=>{r=!0}},[e,t,n]),r}function ct(e){let{page:t,matches:n}=e,r=u(e,p),a=he(),{manifest:s,routeModules:o}=at(),{basename:c}=tt(),{loaderData:d,matches:h}=nt(),f=l.useMemo(()=>Ye(t,n,h,s,a,"data"),[t,n,h,s,a]),m=l.useMemo(()=>Ye(t,n,h,s,a,"assets"),[t,n,h,s,a]),g=l.useMemo(()=>{if(t===a.pathname+a.search+a.hash)return[];let e=new Set,r=!1;if(n.forEach(t=>{var n;let a=s.routes[t.route.id];a&&a.hasLoader&&(!f.some(e=>e.route.id===t.route.id)&&t.route.id in d&&null!==(n=o[t.route.id])&&void 0!==n&&n.shouldRevalidate||a.hasClientLoader?r=!0:e.add(t.route.id))}),0===e.size)return[];let i=$e(t,c,"data");return r&&e.size>0&&i.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[i.pathname+i.search]},[c,d,a,s,f,n,t,o]),v=l.useMemo(()=>Ze(m,s),[m,s]),y=lt(m);return l.createElement(l.Fragment,null,g.map(e=>l.createElement("link",i({key:e,rel:"prefetch",as:"fetch",href:e},r))),v.map(e=>l.createElement("link",i({key:e,rel:"modulepreload",href:e},r))),y.map(e=>{let{key:t,link:n}=e;return l.createElement("link",i({key:t,nonce:r.nonce},n))}))}var ut=!1;function dt(e){let{manifest:t,serverHandoffString:n,isSpaMode:r,renderMeta:a,routeDiscovery:s,ssr:o}=at(),{router:c,static:h,staticContext:p}=tt(),{matches:f}=nt(),m=l.useContext(re),g=et(s,o);a&&(a.didRenderScripts=!0);let v=ot(f,null,r);l.useEffect(()=>{ut=!0},[]);let y=l.useMemo(()=>{var r;if(m)return null;let a=p?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",s=h?"".concat(null!==(r=t.hmr)&&void 0!==r&&r.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(v.map((e,n)=>{let r="route".concat(n),a=t.routes[e.route.id];Ke(a,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:o,clientMiddlewareModule:i,hydrateFallbackModule:l,module:c}=a,u=[...s?[{module:s,varName:"".concat(r,"_clientAction")}]:[],...o?[{module:o,varName:"".concat(r,"_clientLoader")}]:[],...i?[{module:i,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===u.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=u(e,d),a=new Set(t.state.matches.map(e=>e.route.id)),s=t.state.location.pathname.split("/").filter(Boolean),o=["/"];for(s.pop();s.length>0;)o.push("/".concat(s.join("/"))),s.pop();o.forEach(e=>{let n=E(t.routes,e,t.basename);n&&n.forEach(e=>a.add(e.route.id))});let l=[...a].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return i(i({},r),{},{routes:l,sri:!!n||void 0})}(t,c),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return l.createElement(l.Fragment,null,l.createElement("script",i(i({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:a},type:void 0})),l.createElement("script",i(i({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:s},type:"module",async:!0})))},[]),b=ut||m?[]:(w=t.entry.imports.concat(Ze(v,t,{includeHydrateFallback:!0})),[...new Set(w)]);var w;let x="object"===typeof t.sri?t.sri:{};return Ae(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),ut||m?null:l.createElement(l.Fragment,null,"object"===typeof t.sri?l.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:x})}}):null,g?null:l.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:x[t.url],suppressHydrationWarning:!0}),l.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:x[t.entry.module],suppressHydrationWarning:!0}),b.map(t=>l.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:x[t],suppressHydrationWarning:!0})),y)}function ht(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}l.Component;function pt(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let r,a=l.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Z(t))return l.createElement(ft,{title:"Unhandled Thrown Response!"},l.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),a);if(t instanceof Error)r=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);r=new Error(e)}return l.createElement(ft,{title:"Application Error!",isOutsideRemixApp:n},l.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),l.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),a)}function ft(e){var t;let{title:n,renderScripts:r,isOutsideRemixApp:a,children:s}=e,{routeModules:o}=at();return null!==(t=o.root)&&void 0!==t&&t.Layout&&!a?s:l.createElement("html",{lang:"en"},l.createElement("head",null,l.createElement("meta",{charSet:"utf-8"}),l.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),l.createElement("title",null,n)),l.createElement("body",null,l.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},s,r?l.createElement(dt,null):null)))}var mt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{mt&&(window.__reactRouterVersion="7.9.2")}catch(Is){}function gt(e){let{basename:t,children:n,window:r}=e,a=l.useRef();null==a.current&&(a.current=y({window:r,v5Compat:!0}));let s=a.current,[o,i]=l.useState({action:s.action,location:s.location}),c=l.useCallback(e=>{l.startTransition(()=>i(e))},[i]);return l.useLayoutEffect(()=>s.listen(c),[s,c]),l.createElement(Le,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:s})}var vt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yt=l.forwardRef(function(e,t){let n,{onClick:r,discover:a="render",prefetch:s="none",relative:o,reloadDocument:c,replace:d,state:h,target:p,to:m,preventScrollReset:g,viewTransition:v}=e,y=u(e,f),{basename:x}=l.useContext(ie),S="string"===typeof m&&vt.test(m),_=!1;if("string"===typeof m&&S&&(n=m,mt))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=W(t.pathname,x);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:_=!0}catch(Is){w(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let j=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(de(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=l.useContext(ie),{hash:a,pathname:s,search:o}=ve(e,{relative:t}),i=s;return"/"!==n&&(i="/"===s?n:J([n,s])),r.createHref({pathname:i,search:o,hash:a})}(m,{relative:o}),[N,E,C]=function(e,t){let n=l.useContext(rt),[r,a]=l.useState(!1),[s,o]=l.useState(!1),{onFocus:i,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,p=l.useRef(null);l.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[e]),l.useEffect(()=>{if(r){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[r]);let f=()=>{a(!0)},m=()=>{a(!1),o(!1)};return n?"intent"!==e?[s,p,{}]:[s,p,{onFocus:st(i,f),onBlur:st(c,m),onMouseEnter:st(u,f),onMouseLeave:st(d,m),onTouchStart:st(h,f)}]:[!1,p,{}]}(s,y),T=function(e){let{target:t,replace:n,state:r,preventScrollReset:a,relative:s,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=me(),c=he(),u=ve(e,{relative:s});return l.useCallback(l=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(l,t)){l.preventDefault();let t=void 0!==n?n:k(c)===k(u);i(e,{replace:t,state:r,preventScrollReset:a,relative:s,viewTransition:o})}},[c,i,u,n,r,t,e,a,s,o])}(m,{replace:d,state:h,target:p,preventScrollReset:g,relative:o,viewTransition:v});let I=l.createElement("a",i(i(i({},y),C),{},{href:n||j,onClick:_||c?r:function(e){r&&r(e),e.defaultPrevented||T(e)},ref:ht(t,E),target:p,"data-discover":S||"render"!==a?void 0:"true"}));return N&&!S?l.createElement(l.Fragment,null,I,l.createElement(it,{page:j})):I});yt.displayName="Link",l.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:r=!1,className:a="",end:s=!1,style:o,to:c,viewTransition:d,children:h}=e,p=u(e,m),f=ve(c,{relative:p.relative}),g=he(),v=l.useContext(ne),{navigator:y,basename:w}=l.useContext(ie),x=null!=v&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=l.useContext(ae);b(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=xt("useViewTransitionState"),a=ve(e,{relative:t});if(!n.isTransitioning)return!1;let s=W(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=W(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=F(a.pathname,o)||null!=F(a.pathname,s)}(f)&&!0===d,S=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,k=g.pathname,_=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(k=k.toLowerCase(),_=_?_.toLowerCase():null,S=S.toLowerCase()),_&&w&&(_=W(_,w)||_);const j="/"!==S&&S.endsWith("/")?S.length-1:S.length;let N,E=k===S||!s&&k.startsWith(S)&&"/"===k.charAt(j),C=null!=_&&(_===S||!s&&_.startsWith(S)&&"/"===_.charAt(S.length)),T={isActive:E,isPending:C,isTransitioning:x},I=E?n:void 0;N="function"===typeof a?a(T):[a,E?"active":null,C?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let P="function"===typeof o?o(T):o;return l.createElement(yt,i(i({},p),{},{"aria-current":I,className:N,ref:t,style:P,to:c,viewTransition:d}),"function"===typeof h?h(T):h)}).displayName="NavLink";var bt=l.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:r,navigate:a,reloadDocument:s,replace:o,state:c,method:d=Me,action:h,onSubmit:p,relative:f,preventScrollReset:m,viewTransition:v}=e,y=u(e,g),w=jt(),x=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=l.useContext(ie),r=l.useContext(ce);b(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),s=i({},ve(e||".",{relative:t})),o=he();if(null==e){s.search=o.search;let e=new URLSearchParams(s.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();s.search=n?"?".concat(n):""}}e&&"."!==e||!a.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(s.pathname="/"===s.pathname?n:J([n,s.pathname]));return k(s)}(h,{relative:f}),S="get"===d.toLowerCase()?"get":"post",_="string"===typeof h&&vt.test(h);return l.createElement("form",i(i({ref:t,method:S,action:x,onSubmit:s?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||d;w(t||e.currentTarget,{fetcherKey:r,method:n,navigate:a,replace:o,state:c,relative:f,preventScrollReset:m,viewTransition:v})}},y),{},{"data-discover":_||"render"!==n?void 0:"true"}))});function wt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function xt(e){let t=l.useContext(te);return b(t,wt(e)),t}function St(e){w("undefined"!==typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=l.useRef(He(e)),n=l.useRef(!1),r=he(),a=l.useMemo(()=>function(e,t){let n=He(e);return t&&t.forEach((e,r)=>{n.has(r)||t.getAll(r).forEach(e=>{n.append(r,e)})}),n}(r.search,n.current?null:t.current),[r.search]),s=me(),o=l.useCallback((e,t)=>{const r=He("function"===typeof e?e(new URLSearchParams(a)):e);n.current=!0,s("?"+r,t)},[s,a]);return[a,o]}bt.displayName="Form";var kt=0,_t=()=>"__".concat(String(++kt),"__");function jt(){let{router:e}=xt("useSubmit"),{basename:t}=l.useContext(ie),n=Ee("useRouteId");return l.useCallback(async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:o,encType:i,formData:l,body:c}=qe(r,t);if(!1===a.navigate){let t=a.fetcherKey||_t();await e.fetch(t,n,a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||o,formEncType:a.encType||i,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||o,formEncType:a.encType||i,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}class Nt extends Error{}function Et(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,(e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}(t)}catch(n){return atob(t)}}Nt.prototype.name="InvalidTokenError";const Ct=["timeoutInSeconds"],Tt=["grant_type","redirect_uri","client_id","client_secret","extraHeaders"],It=["grant_type","client_id","client_secret","scope"],Pt=["grant_type","client_id","client_secret","timeoutInSeconds","extraHeaders"],At=["url","authority","client_id","redirect_uri","response_type","scope","state_data","response_mode","request_type","client_secret","nonce","url_state","resource","skipUserInfo","extraQueryParams","extraTokenParams","disablePKCE","dpopJkt","omitScopeWhenRequesting"],Rt=["redirectMethod"],Dt=["popupWindowFeatures","popupWindowTarget","popupSignal"],Lt=["silentRequestTimeoutInSeconds"],Ot=["silentRequestTimeoutInSeconds"],Ut=["redirectMethod"],Mt=["popupWindowFeatures","popupWindowTarget","popupSignal"],zt=["silentRequestTimeoutInSeconds"];var Ft,Ht,Bt,Wt={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},Vt=(e=>(e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e))(Vt||{});(Bt=Vt||(Vt={})).reset=function(){Ft=3,Ht=Wt},Bt.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");Ft=e},Bt.setLogger=function(e){Ht=e};var qt=class e{constructor(e){this._name=e}debug(){if(Ft>=4){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ht.debug(e._format(this._name,this._method),...n)}}info(){if(Ft>=3){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ht.info(e._format(this._name,this._method),...n)}}warn(){if(Ft>=2){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ht.warn(e._format(this._name,this._method),...n)}}error(){if(Ft>=1){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ht.error(e._format(this._name,this._method),...n)}}throw(e){throw this.error(e),e}create(e){const t=Object.create(this);return t._method=e,t.debug("begin"),t}static createStatic(t,n){const r=new e("".concat(t,".").concat(n));return r.debug("begin"),r}static _format(e,t){const n="[".concat(e,"]");return t?"".concat(n," ").concat(t,":"):n}static debug(t){if(Ft>=4){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];Ht.debug(e._format(t),...r)}}static info(t){if(Ft>=3){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];Ht.info(e._format(t),...r)}}static warn(t){if(Ft>=2){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];Ht.warn(e._format(t),...r)}}static error(t){if(Ft>=1){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];Ht.error(e._format(t),...r)}}};Vt.reset();var Kt=class{static decode(e){try{return function(e,t){if("string"!==typeof e)throw new Nt("Invalid token specified: must be a string");t||(t={});const n=!0===t.header?0:1,r=e.split(".")[n];if("string"!==typeof r)throw new Nt("Invalid token specified: missing part #".concat(n+1));let a;try{a=Et(r)}catch(Is){throw new Nt("Invalid token specified: invalid base64 for part #".concat(n+1," (").concat(Is.message,")"))}try{return JSON.parse(a)}catch(Is){throw new Nt("Invalid token specified: invalid json for part #".concat(n+1," (").concat(Is.message,")"))}}(e)}catch(t){throw qt.error("JwtUtils.decode",t),t}}static async generateSignedJwt(e,t,n){const r=Qt.encodeBase64Url((new TextEncoder).encode(JSON.stringify(e))),a=Qt.encodeBase64Url((new TextEncoder).encode(JSON.stringify(t))),s="".concat(r,".").concat(a),o=await window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},n,(new TextEncoder).encode(s)),i=Qt.encodeBase64Url(new Uint8Array(o));return"".concat(s,".").concat(i)}},$t=e=>btoa([...new Uint8Array(e)].map(e=>String.fromCharCode(e)).join("")),Jt=class e{static _randomWord(){const e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}static generateUUIDv4(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t=>(+t^e._randomWord()&15>>+t/4).toString(16)).replace(/-/g,"")}static generateCodeVerifier(){return e.generateUUIDv4()+e.generateUUIDv4()+e.generateUUIDv4()}static async generateCodeChallenge(e){if(!crypto.subtle)throw new Error("Crypto.subtle is available only in secure contexts (HTTPS).");try{const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return $t(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(t){throw qt.error("CryptoUtils.generateCodeChallenge",t),t}}static generateBasicAuth(e,t){const n=(new TextEncoder).encode([e,t].join(":"));return $t(n)}static async hash(e,t){const n=(new TextEncoder).encode(t),r=await crypto.subtle.digest(e,n);return new Uint8Array(r)}static async customCalculateJwkThumbprint(t){let n;switch(t.kty){case"RSA":n={e:t.e,kty:t.kty,n:t.n};break;case"EC":n={crv:t.crv,kty:t.kty,x:t.x,y:t.y};break;case"OKP":n={crv:t.crv,kty:t.kty,x:t.x};break;case"oct":n={crv:t.k,kty:t.kty};break;default:throw new Error("Unknown jwk type")}const r=await e.hash("SHA-256",JSON.stringify(n));return e.encodeBase64Url(r)}static async generateDPoPProof(t){let n,r,{url:a,accessToken:s,httpMethod:o,keyPair:i,nonce:l}=t;const c={jti:window.crypto.randomUUID(),htm:null!=o?o:"GET",htu:a,iat:Math.floor(Date.now()/1e3)};s&&(n=await e.hash("SHA-256",s),r=e.encodeBase64Url(n),c.ath=r),l&&(c.nonce=l);try{const e=await crypto.subtle.exportKey("jwk",i.publicKey),t={alg:"ES256",typ:"dpop+jwt",jwk:{crv:e.crv,kty:e.kty,x:e.x,y:e.y}};return await Kt.generateSignedJwt(t,c,i.privateKey)}catch(u){throw u instanceof TypeError?new Error("Error exporting dpop public key: ".concat(u.message)):u}}static async generateDPoPJkt(t){try{const n=await crypto.subtle.exportKey("jwk",t.publicKey);return await e.customCalculateJwkThumbprint(n)}catch(n){throw n instanceof TypeError?new Error("Could not retrieve dpop keys from storage: ".concat(n.message)):n}}static async generateDPoPKeys(){return await window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!1,["sign","verify"])}};Jt.encodeBase64Url=e=>$t(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");var Qt=Jt,Gt=class{constructor(e){this._name=e,this._callbacks=[],this._logger=new qt("Event('".concat(this._name,"')"))}addHandler(e){return this._callbacks.push(e),()=>this.removeHandler(e)}removeHandler(e){const t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}async raise(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._logger.debug("raise:",...t);for(const r of this._callbacks)await r(...t)}},Yt=class{static center(e){let t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));var n;return null==t.width&&(t.width=null!=(n=[800,720,600,480].find(e=>e<=window.outerWidth/1.618))?n:360),null!=t.left||(t.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-t.width)/2))),null!=t.height&&(null!=t.top||(t.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-t.height)/2)))),t}static serialize(e){return Object.entries(e).filter(e=>{let[,t]=e;return null!=t}).map(e=>{let[t,n]=e;return"".concat(t,"=").concat("boolean"!==typeof n?n:n?"yes":"no")}).join(",")}},Zt=class e extends Gt{constructor(){super(...arguments),this._logger=new qt("Timer('".concat(this._name,"')")),this._timerHandle=null,this._expiration=0,this._callback=()=>{const t=this._expiration-e.getEpochTime();this._logger.debug("timer completes in",t),this._expiration<=e.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(t){const n=this._logger.create("init");t=Math.max(Math.floor(t),1);const r=e.getEpochTime()+t;if(this.expiration===r&&this._timerHandle)return void n.debug("skipping since already initialized for expiration at",this.expiration);this.cancel(),n.debug("using duration",t),this._expiration=r;const a=Math.min(t,5);this._timerHandle=setInterval(this._callback,1e3*a)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},Xt=class{static readParams(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"query";if(!e)throw new TypeError("Invalid URL");const n=new URL(e,"http://127.0.0.1")["fragment"===t?"hash":"search"];return new URLSearchParams(n.slice(1))}},en=";",tn=class extends Error{constructor(e,t){var n,r,a;if(super(e.error_description||e.error||""),this.form=t,this.name="ErrorResponse",!e.error)throw qt.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=e.error,this.error_description=null!=(n=e.error_description)?n:null,this.error_uri=null!=(r=e.error_uri)?r:null,this.state=e.userState,this.session_state=null!=(a=e.session_state)?a:null,this.url_state=e.url_state}},nn=class extends Error{constructor(e){super(e),this.name="ErrorTimeout"}},rn=class{constructor(e){this._logger=new qt("AccessTokenEvents"),this._expiringTimer=new Zt("Access token expiring"),this._expiredTimer=new Zt("Access token expired"),this._expiringNotificationTimeInSeconds=e.expiringNotificationTimeInSeconds}async load(e){const t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){const n=e.expires_in;if(t.debug("access token present, remaining duration:",n),n>0){let e=n-this._expiringNotificationTimeInSeconds;e<=0&&(e=1),t.debug("registering expiring timer, raising in",e,"seconds"),this._expiringTimer.init(e)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const r=n+1;t.debug("registering expired timer, raising in",r,"seconds"),this._expiredTimer.init(r)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}async unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(e){return this._expiringTimer.addHandler(e)}removeAccessTokenExpiring(e){this._expiringTimer.removeHandler(e)}addAccessTokenExpired(e){return this._expiredTimer.addHandler(e)}removeAccessTokenExpired(e){this._expiredTimer.removeHandler(e)}},an=class{constructor(e,t,n,r,a){this._callback=e,this._client_id=t,this._intervalInSeconds=r,this._stopOnError=a,this._logger=new qt("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=e=>{e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(e.data+" message from check session op iframe"))};const s=new URL(n);this._frame_origin=s.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=s.href}load(){return new Promise(e=>{this._frame.onload=()=>{e()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)})}start(e){if(this._session_state===e)return;this._logger.create("start"),this.stop(),this._session_state=e;const t=()=>{this._frame.contentWindow&&this._session_state&&this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};t(),this._timer=setInterval(t,1e3*this._intervalInSeconds)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}},sn=class{constructor(){this._logger=new qt("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(e){return this._logger.create("getItem('".concat(e,"')")),this._data[e]}setItem(e,t){this._logger.create("setItem('".concat(e,"')")),this._data[e]=t}removeItem(e){this._logger.create("removeItem('".concat(e,"')")),delete this._data[e]}get length(){return Object.getOwnPropertyNames(this._data).length}key(e){return Object.getOwnPropertyNames(this._data)[e]}},on=class extends Error{constructor(e,t){super(t),this.name="ErrorDPoPNonce",this.nonce=e}},ln=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._jwtHandler=t,this._extraHeaders=n,this._logger=new qt("JsonService"),this._contentTypes=[],this._contentTypes.push(...e,"application/json"),t&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{timeoutInSeconds:n}=t,r=u(t,Ct);if(!n)return await fetch(e,r);const a=new AbortController,s=setTimeout(()=>a.abort(),1e3*n);try{return await fetch(e,i(i({},t),{},{signal:a.signal}))}catch(o){if(o instanceof DOMException&&"AbortError"===o.name)throw new nn("Network timed out");throw o}finally{clearTimeout(s)}}async getJson(e){let{token:t,credentials:n,timeoutInSeconds:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=this._logger.create("getJson"),s={Accept:this._contentTypes.join(", ")};let o;t&&(a.debug("token passed, setting Authorization header"),s.Authorization="Bearer "+t),this._appendExtraHeaders(s);try{a.debug("url:",e),o=await this.fetchWithTimeout(e,{method:"GET",headers:s,timeoutInSeconds:r,credentials:n})}catch(c){throw a.error("Network Error"),c}a.debug("HTTP response received, status",o.status);const i=o.headers.get("Content-Type");if(i&&!this._contentTypes.find(e=>i.startsWith(e))&&a.throw(new Error("Invalid response Content-Type: ".concat(null!=i?i:"undefined",", from URL: ").concat(e))),o.ok&&this._jwtHandler&&(null==i?void 0:i.startsWith("application/jwt")))return await this._jwtHandler(await o.text());let l;try{l=await o.json()}catch(c){if(a.error("Error parsing JSON response",c),o.ok)throw c;throw new Error("".concat(o.statusText," (").concat(o.status,")"))}if(!o.ok){if(a.error("Error from server:",l),l.error)throw new tn(l);throw new Error("".concat(o.statusText," (").concat(o.status,"): ").concat(JSON.stringify(l)))}return l}async postForm(e,t){let{body:n,basicAuth:r,timeoutInSeconds:a,initCredentials:s,extraHeaders:o}=t;const l=this._logger.create("postForm"),c=i({Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"},o);let u;void 0!==r&&(c.Authorization="Basic "+r),this._appendExtraHeaders(c);try{l.debug("url:",e),u=await this.fetchWithTimeout(e,{method:"POST",headers:c,body:n,timeoutInSeconds:a,credentials:s})}catch(f){throw l.error("Network error"),f}l.debug("HTTP response received, status",u.status);const d=u.headers.get("Content-Type");if(d&&!this._contentTypes.find(e=>d.startsWith(e)))throw new Error("Invalid response Content-Type: ".concat(null!=d?d:"undefined",", from URL: ").concat(e));const h=await u.text();let p={};if(h)try{p=JSON.parse(h)}catch(f){if(l.error("Error parsing JSON response",f),u.ok)throw f;throw new Error("".concat(u.statusText," (").concat(u.status,")"))}if(!u.ok){if(l.error("Error from server:",p),u.headers.has("dpop-nonce")){const e=u.headers.get("dpop-nonce");throw new on(e,"".concat(JSON.stringify(p)))}if(p.error)throw new tn(p,n);throw new Error("".concat(u.statusText," (").concat(u.status,"): ").concat(JSON.stringify(p)))}return p}_appendExtraHeaders(e){const t=this._logger.create("appendExtraHeaders"),n=Object.keys(this._extraHeaders),r=["accept","content-type"],a=["authorization"];0!==n.length&&n.forEach(n=>{if(r.includes(n.toLocaleLowerCase()))return void t.warn("Protected header could not be set",n,r);if(a.includes(n.toLocaleLowerCase())&&Object.keys(e).includes(n))return void t.warn("Header could not be overridden",n,a);const s="function"===typeof this._extraHeaders[n]?this._extraHeaders[n]():this._extraHeaders[n];s&&""!==s&&(e[n]=s)})}},cn=class{constructor(e){this._settings=e,this._logger=new qt("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new ln(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const e=this._logger.create("getMetadata");if(this._metadata)return e.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw e.throw(new Error("No authority or metadataUrl configured on settings")),null;e.debug("getting metadata from",this._metadataUrl);const t=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials,timeoutInSeconds:this._settings.requestTimeoutInSeconds});return e.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},t,this._settings.metadataSeed),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("revocation_endpoint",e)}getKeysEndpoint(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("jwks_uri",e)}async _getMetadataProperty(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("_getMetadataProperty('".concat(e,"')")),r=await this.getMetadata();if(n.debug("resolved"),void 0===r[e]){if(!0===t)return void n.warn("Metadata does not contain optional property");n.throw(new Error("Metadata does not contain property "+e))}return r[e]}async getSigningKeys(){const e=this._logger.create("getSigningKeys");if(this._signingKeys)return e.debug("returning signingKeys from cache"),this._signingKeys;const t=await this.getKeysEndpoint(!1);e.debug("got jwks_uri",t);const n=await this._jsonService.getJson(t,{timeoutInSeconds:this._settings.requestTimeoutInSeconds});if(e.debug("got key set",n),!Array.isArray(n.keys))throw e.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=n.keys,this._signingKeys}},un=class{constructor(){let{prefix:e="oidc.",store:t=localStorage}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._logger=new qt("WebStorageStateStore"),this._store=t,this._prefix=e}async set(e,t){this._logger.create("set('".concat(e,"')")),e=this._prefix+e,await this._store.setItem(e,t)}async get(e){this._logger.create("get('".concat(e,"')")),e=this._prefix+e;return await this._store.getItem(e)}async remove(e){this._logger.create("remove('".concat(e,"')")),e=this._prefix+e;const t=await this._store.getItem(e);return await this._store.removeItem(e),t}async getAllKeys(){this._logger.create("getAllKeys");const e=await this._store.length,t=[];for(let n=0;n<e;n++){const e=await this._store.key(n);e&&0===e.indexOf(this._prefix)&&t.push(e.substr(this._prefix.length))}return t}},dn="code",hn="openid",pn="client_secret_post",fn=900,mn=class{constructor(e){let{authority:t,metadataUrl:n,metadata:r,signingKeys:a,metadataSeed:s,client_id:o,client_secret:i,response_type:l=dn,scope:c=hn,redirect_uri:u,post_logout_redirect_uri:d,client_authentication:h=pn,prompt:p,display:f,max_age:m,ui_locales:g,acr_values:v,resource:y,response_mode:b,filterProtocolClaims:w=!0,loadUserInfo:x=!1,requestTimeoutInSeconds:S,staleStateAgeInSeconds:k=fn,mergeClaimsStrategy:_={array:"replace"},disablePKCE:j=!1,stateStore:N,revokeTokenAdditionalContentTypes:E,fetchRequestCredentials:C,refreshTokenAllowedScope:T,extraQueryParams:I={},extraTokenParams:P={},extraHeaders:A={},dpop:R,omitScopeWhenRequesting:D=!1}=e;var L;if(this.authority=t,n?this.metadataUrl=n:(this.metadataUrl=t,t&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=s,this.signingKeys=a,this.client_id=o,this.client_secret=i,this.response_type=l,this.scope=c,this.redirect_uri=u,this.post_logout_redirect_uri=d,this.client_authentication=h,this.prompt=p,this.display=f,this.max_age=m,this.ui_locales=g,this.acr_values=v,this.resource=y,this.response_mode=b,this.filterProtocolClaims=null==w||w,this.loadUserInfo=!!x,this.staleStateAgeInSeconds=k,this.mergeClaimsStrategy=_,this.omitScopeWhenRequesting=D,this.disablePKCE=!!j,this.revokeTokenAdditionalContentTypes=E,this.fetchRequestCredentials=C||"same-origin",this.requestTimeoutInSeconds=S,N)this.stateStore=N;else{const e="undefined"!==typeof window?window.localStorage:new sn;this.stateStore=new un({store:e})}if(this.refreshTokenAllowedScope=T,this.extraQueryParams=I,this.extraTokenParams=P,this.extraHeaders=A,this.dpop=R,this.dpop&&!(null==(L=this.dpop)?void 0:L.store))throw new Error("A DPoPStore is required when dpop is enabled")}},gn=class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new qt("UserInfoService"),this._getClaimsFromJwt=async e=>{const t=this._logger.create("_getClaimsFromJwt");try{const n=Kt.decode(e);return t.debug("JWT decoding successful"),n}catch(n){throw t.error("Error parsing JWT response"),n}},this._jsonService=new ln(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}async getClaims(e){const t=this._logger.create("getClaims");e||this._logger.throw(new Error("No token passed"));const n=await this._metadataService.getUserInfoEndpoint();t.debug("got userinfo url",n);const r=await this._jsonService.getJson(n,{token:e,credentials:this._settings.fetchRequestCredentials,timeoutInSeconds:this._settings.requestTimeoutInSeconds});return t.debug("got claims",r),r}},vn=class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new qt("TokenClient"),this._jsonService=new ln(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}async exchangeCode(e){let{grant_type:t="authorization_code",redirect_uri:n=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:a=this._settings.client_secret,extraHeaders:s}=e,o=u(e,Tt);const i=this._logger.create("exchangeCode");r||i.throw(new Error("A client_id is required")),n||i.throw(new Error("A redirect_uri is required")),o.code||i.throw(new Error("A code is required"));const l=new URLSearchParams({grant_type:t,redirect_uri:n});for(const[u,p]of Object.entries(o))null!=p&&l.set(u,p);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(void 0===a||null===a)throw i.throw(new Error("A client_secret is required")),null;c=Qt.generateBasicAuth(r,a);break;case"client_secret_post":l.append("client_id",r),a&&l.append("client_secret",a)}const d=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const h=await this._jsonService.postForm(d,{body:l,basicAuth:c,timeoutInSeconds:this._settings.requestTimeoutInSeconds,initCredentials:this._settings.fetchRequestCredentials,extraHeaders:s});return i.debug("got response"),h}async exchangeCredentials(e){let{grant_type:t="password",client_id:n=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:a=this._settings.scope}=e,s=u(e,It);const o=this._logger.create("exchangeCredentials");n||o.throw(new Error("A client_id is required"));const i=new URLSearchParams({grant_type:t});this._settings.omitScopeWhenRequesting||i.set("scope",a);for(const[u,h]of Object.entries(s))null!=h&&i.set(u,h);let l;switch(this._settings.client_authentication){case"client_secret_basic":if(void 0===r||null===r)throw o.throw(new Error("A client_secret is required")),null;l=Qt.generateBasicAuth(n,r);break;case"client_secret_post":i.append("client_id",n),r&&i.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);o.debug("got token endpoint");const d=await this._jsonService.postForm(c,{body:i,basicAuth:l,timeoutInSeconds:this._settings.requestTimeoutInSeconds,initCredentials:this._settings.fetchRequestCredentials});return o.debug("got response"),d}async exchangeRefreshToken(e){let{grant_type:t="refresh_token",client_id:n=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:a,extraHeaders:s}=e,o=u(e,Pt);const i=this._logger.create("exchangeRefreshToken");n||i.throw(new Error("A client_id is required")),o.refresh_token||i.throw(new Error("A refresh_token is required"));const l=new URLSearchParams({grant_type:t});for(const[u,p]of Object.entries(o))Array.isArray(p)?p.forEach(e=>l.append(u,e)):null!=p&&l.set(u,p);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(void 0===r||null===r)throw i.throw(new Error("A client_secret is required")),null;c=Qt.generateBasicAuth(n,r);break;case"client_secret_post":l.append("client_id",n),r&&l.append("client_secret",r)}const d=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const h=await this._jsonService.postForm(d,{body:l,basicAuth:c,timeoutInSeconds:a,initCredentials:this._settings.fetchRequestCredentials,extraHeaders:s});return i.debug("got response"),h}async revoke(e){var t;const n=this._logger.create("revoke");e.token||n.throw(new Error("A token is required"));const r=await this._metadataService.getRevocationEndpoint(!1);n.debug("got revocation endpoint, revoking ".concat(null!=(t=e.token_type_hint)?t:"default token type"));const a=new URLSearchParams;for(const[s,o]of Object.entries(e))null!=o&&a.set(s,o);a.set("client_id",this._settings.client_id),this._settings.client_secret&&a.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(r,{body:a,timeoutInSeconds:this._settings.requestTimeoutInSeconds}),n.debug("got response")}},yn=class{constructor(e,t,n){this._settings=e,this._metadataService=t,this._claimsService=n,this._logger=new qt("ResponseValidator"),this._userInfoService=new gn(this._settings,this._metadataService),this._tokenClient=new vn(this._settings,this._metadataService)}async validateSigninResponse(e,t,n){const r=this._logger.create("validateSigninResponse");this._processSigninState(e,t),r.debug("state processed"),await this._processCode(e,t,n),r.debug("code processed"),e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,null==t?void 0:t.skipUserInfo,e.isOpenId),r.debug("claims processed")}async validateCredentialsResponse(e,t){const n=this._logger.create("validateCredentialsResponse"),r=e.isOpenId&&!!e.id_token;r&&this._validateIdTokenAttributes(e),n.debug("tokens validated"),await this._processClaims(e,t,r),n.debug("claims processed")}async validateRefreshResponse(e,t){const n=this._logger.create("validateRefreshResponse");e.userState=t.data,null!=e.session_state||(e.session_state=t.session_state),null!=e.scope||(e.scope=t.scope),e.isOpenId&&e.id_token&&(this._validateIdTokenAttributes(e,t.id_token),n.debug("ID Token validated")),e.id_token||(e.id_token=t.id_token,e.profile=t.profile);const r=e.isOpenId&&!!e.id_token;await this._processClaims(e,!1,r),n.debug("claims processed")}validateSignoutResponse(e,t){const n=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&n.throw(new Error("State does not match")),n.debug("state validated"),e.userState=t.data,e.error)throw n.warn("Response was error",e.error),new tn(e)}_processSigninState(e,t){const n=this._logger.create("_processSigninState");if(t.id!==e.state&&n.throw(new Error("State does not match")),t.client_id||n.throw(new Error("No client_id on state")),t.authority||n.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&n.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&n.throw(new Error("client_id mismatch on settings vs. signin state")),n.debug("state validated"),e.userState=t.data,e.url_state=t.url_state,null!=e.scope||(e.scope=t.scope),e.error)throw n.warn("Response was error",e.error),new tn(e);t.code_verifier&&!e.code&&n.throw(new Error("Expected code in response"))}async _processClaims(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._logger.create("_processClaims");if(e.profile=this._claimsService.filterProtocolClaims(e.profile),t||!this._settings.loadUserInfo||!e.access_token)return void r.debug("not loading user info");r.debug("loading user info");const a=await this._userInfoService.getClaims(e.access_token);r.debug("user info claims received from user info endpoint"),n&&a.sub!==e.profile.sub&&r.throw(new Error("subject from UserInfo response does not match subject in ID Token")),e.profile=this._claimsService.mergeClaims(e.profile,this._claimsService.filterProtocolClaims(a)),r.debug("user info claims received, updated profile:",e.profile)}async _processCode(e,t,n){const r=this._logger.create("_processCode");if(e.code){r.debug("Validating code");const a=await this._tokenClient.exchangeCode(i({client_id:t.client_id,client_secret:t.client_secret,code:e.code,redirect_uri:t.redirect_uri,code_verifier:t.code_verifier,extraHeaders:n},t.extraTokenParams));Object.assign(e,a)}else r.debug("No code to process")}_validateIdTokenAttributes(e,t){var n;const r=this._logger.create("_validateIdTokenAttributes");r.debug("decoding ID Token JWT");const a=Kt.decode(null!=(n=e.id_token)?n:"");if(a.sub||r.throw(new Error("ID Token is missing a subject claim")),t){const e=Kt.decode(t);a.sub!==e.sub&&r.throw(new Error("sub in id_token does not match current sub")),a.auth_time&&a.auth_time!==e.auth_time&&r.throw(new Error("auth_time in id_token does not match original auth_time")),a.azp&&a.azp!==e.azp&&r.throw(new Error("azp in id_token does not match original azp")),!a.azp&&e.azp&&r.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=a}},bn=class e{constructor(e){this.id=e.id||Qt.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=Zt.getEpochTime(),this.request_type=e.request_type,this.url_state=e.url_state}toStorageString(){return new qt("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state})}static fromStorageString(t){return qt.createStatic("State","fromStorageString"),Promise.resolve(new e(JSON.parse(t)))}static async clearStaleState(t,n){const r=qt.createStatic("State","clearStaleState"),a=Zt.getEpochTime()-n,s=await t.getAllKeys();r.debug("got keys",s);for(let i=0;i<s.length;i++){const n=s[i],l=await t.get(n);let c=!1;if(l)try{const t=await e.fromStorageString(l);r.debug("got item from key:",n,t.created),t.created<=a&&(c=!0)}catch(o){r.error("Error parsing state for key:",n,o),c=!0}else r.debug("no item in storage for key:",n),c=!0;c&&(r.debug("removed item for key:",n),t.remove(n))}}},wn=class e extends bn{constructor(e){super(e),this.code_verifier=e.code_verifier,this.code_challenge=e.code_challenge,this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}static async create(t){const n=!0===t.code_verifier?Qt.generateCodeVerifier():t.code_verifier||void 0,r=n?await Qt.generateCodeChallenge(n):void 0;return new e(i(i({},t),{},{code_verifier:n,code_challenge:r}))}toStorageString(){return new qt("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(t){qt.createStatic("SigninState","fromStorageString");const n=JSON.parse(t);return e.create(n)}},xn=class e{constructor(e){this.url=e.url,this.state=e.state}static async create(t){let{url:n,authority:r,client_id:a,redirect_uri:s,response_type:o,scope:l,state_data:c,response_mode:d,request_type:h,client_secret:p,nonce:f,url_state:m,resource:g,skipUserInfo:v,extraQueryParams:y,extraTokenParams:b,disablePKCE:w,dpopJkt:x,omitScopeWhenRequesting:S}=t,k=u(t,At);if(!n)throw this._logger.error("create: No url passed"),new Error("url");if(!a)throw this._logger.error("create: No client_id passed"),new Error("client_id");if(!s)throw this._logger.error("create: No redirect_uri passed"),new Error("redirect_uri");if(!o)throw this._logger.error("create: No response_type passed"),new Error("response_type");if(!l)throw this._logger.error("create: No scope passed"),new Error("scope");if(!r)throw this._logger.error("create: No authority passed"),new Error("authority");const _=await wn.create({data:c,request_type:h,url_state:m,code_verifier:!w,client_id:a,authority:r,redirect_uri:s,response_mode:d,client_secret:p,scope:l,extraTokenParams:b,skipUserInfo:v}),j=new URL(n);j.searchParams.append("client_id",a),j.searchParams.append("redirect_uri",s),j.searchParams.append("response_type",o),S||j.searchParams.append("scope",l),f&&j.searchParams.append("nonce",f),x&&j.searchParams.append("dpop_jkt",x);let N=_.id;if(m&&(N="".concat(N).concat(en).concat(m)),j.searchParams.append("state",N),_.code_challenge&&(j.searchParams.append("code_challenge",_.code_challenge),j.searchParams.append("code_challenge_method","S256")),g){(Array.isArray(g)?g:[g]).forEach(e=>j.searchParams.append("resource",e))}for(const[e,u]of Object.entries(i(i({response_mode:d},k),y)))null!=u&&j.searchParams.append(e,u.toString());return new e({url:j.href,state:_})}};xn._logger=new qt("SigninRequest");var Sn=xn,kn=class{constructor(e){if(this.access_token="",this.token_type="",this.profile={},this.state=e.get("state"),this.session_state=e.get("session_state"),this.state){const e=decodeURIComponent(this.state).split(en);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(en))}this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri"),this.code=e.get("code")}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-Zt.getEpochTime()}set expires_in(e){"string"===typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+Zt.getEpochTime())}get isOpenId(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}},_n=class{constructor(e){let{url:t,state_data:n,id_token_hint:r,post_logout_redirect_uri:a,extraQueryParams:s,request_type:o,client_id:l,url_state:c}=e;if(this._logger=new qt("SignoutRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");const u=new URL(t);if(r&&u.searchParams.append("id_token_hint",r),l&&u.searchParams.append("client_id",l),a&&(u.searchParams.append("post_logout_redirect_uri",a),n||c)){this.state=new bn({data:n,request_type:o,url_state:c});let e=this.state.id;c&&(e="".concat(e).concat(en).concat(c)),u.searchParams.append("state",e)}for(const[d,h]of Object.entries(i({},s)))null!=h&&u.searchParams.append(d,h.toString());this.url=u.href}},jn=class{constructor(e){if(this.state=e.get("state"),this.state){const e=decodeURIComponent(this.state).split(en);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(en))}this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri")}},Nn=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],En=["sub","iss","aud","exp","iat"],Cn=class{constructor(e){this._settings=e,this._logger=new qt("ClaimsService")}filterProtocolClaims(e){const t=i({},e);if(this._settings.filterProtocolClaims){let e;e=Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:Nn;for(const n of e)En.includes(n)||delete t[n]}return t}mergeClaims(e,t){const n=i({},e);for(const[r,a]of Object.entries(t))if(n[r]!==a)if(Array.isArray(n[r])||Array.isArray(a))if("replace"==this._settings.mergeClaimsStrategy.array)n[r]=a;else{const e=Array.isArray(n[r])?n[r]:[n[r]];for(const t of Array.isArray(a)?a:[a])e.includes(t)||e.push(t);n[r]=e}else"object"===typeof n[r]&&"object"===typeof a?n[r]=this.mergeClaims(n[r],a):n[r]=a;return n}},Tn=class{constructor(e,t){this.keys=e,this.nonce=t}},In=class{constructor(e,t){this._logger=new qt("OidcClient"),this.settings=e instanceof mn?e:new mn(e),this.metadataService=null!=t?t:new cn(this.settings),this._claimsService=new Cn(this.settings),this._validator=new yn(this.settings,this.metadataService,this._claimsService),this._tokenClient=new vn(this.settings,this.metadataService)}async createSigninRequest(e){let{state:t,request:n,request_uri:r,request_type:a,id_token_hint:s,login_hint:o,skipUserInfo:i,nonce:l,url_state:c,response_type:u=this.settings.response_type,scope:d=this.settings.scope,redirect_uri:h=this.settings.redirect_uri,prompt:p=this.settings.prompt,display:f=this.settings.display,max_age:m=this.settings.max_age,ui_locales:g=this.settings.ui_locales,acr_values:v=this.settings.acr_values,resource:y=this.settings.resource,response_mode:b=this.settings.response_mode,extraQueryParams:w=this.settings.extraQueryParams,extraTokenParams:x=this.settings.extraTokenParams,dpopJkt:S,omitScopeWhenRequesting:k=this.settings.omitScopeWhenRequesting}=e;const _=this._logger.create("createSigninRequest");if("code"!==u)throw new Error("Only the Authorization Code flow (with PKCE) is supported");const j=await this.metadataService.getAuthorizationEndpoint();_.debug("Received authorization endpoint",j);const N=await Sn.create({url:j,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:h,response_type:u,scope:d,state_data:t,url_state:c,prompt:p,display:f,max_age:m,ui_locales:g,id_token_hint:s,login_hint:o,acr_values:v,dpopJkt:S,resource:y,request:n,request_uri:r,extraQueryParams:w,extraTokenParams:x,request_type:a,response_mode:b,client_secret:this.settings.client_secret,skipUserInfo:i,nonce:l,disablePKCE:this.settings.disablePKCE,omitScopeWhenRequesting:k});await this.clearStaleState();const E=N.state;return await this.settings.stateStore.set(E.id,E.toStorageString()),N}async readSigninResponseState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("readSigninResponseState"),r=new kn(Xt.readParams(e,this.settings.response_mode));if(!r.state)throw n.throw(new Error("No state in response")),null;const a=await this.settings.stateStore[t?"remove":"get"](r.state);if(!a)throw n.throw(new Error("No matching state found in storage")),null;return{state:await wn.fromStorageString(a),response:r}}async processSigninResponse(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._logger.create("processSigninResponse"),{state:a,response:s}=await this.readSigninResponseState(e,n);if(r.debug("received state from storage; validating response"),this.settings.dpop&&this.settings.dpop.store){const e=await this.getDpopProof(this.settings.dpop.store);t=i(i({},t),{},{DPoP:e})}try{await this._validator.validateSigninResponse(s,a,t)}catch(o){if(!(o instanceof on&&this.settings.dpop))throw o;{const e=await this.getDpopProof(this.settings.dpop.store,o.nonce);t.DPoP=e,await this._validator.validateSigninResponse(s,a,t)}}return s}async getDpopProof(e,t){let n,r;return(await e.getAllKeys()).includes(this.settings.client_id)?(r=await e.get(this.settings.client_id),r.nonce!==t&&t&&(r.nonce=t,await e.set(this.settings.client_id,r))):(n=await Qt.generateDPoPKeys(),r=new Tn(n,t),await e.set(this.settings.client_id,r)),await Qt.generateDPoPProof({url:await this.metadataService.getTokenEndpoint(!1),httpMethod:"POST",keyPair:r.keys,nonce:r.nonce})}async processResourceOwnerPasswordCredentials(e){let{username:t,password:n,skipUserInfo:r=!1,extraTokenParams:a={}}=e;const s=await this._tokenClient.exchangeCredentials(i({username:t,password:n},a)),o=new kn(new URLSearchParams);return Object.assign(o,s),await this._validator.validateCredentialsResponse(o,r),o}async useRefreshToken(e){let{state:t,redirect_uri:n,resource:r,timeoutInSeconds:a,extraHeaders:s,extraTokenParams:o}=e;var l;const c=this._logger.create("useRefreshToken");let u,d;if(void 0===this.settings.refreshTokenAllowedScope)u=t.scope;else{const e=this.settings.refreshTokenAllowedScope.split(" ");u=((null==(l=t.scope)?void 0:l.split(" "))||[]).filter(t=>e.includes(t)).join(" ")}if(this.settings.dpop&&this.settings.dpop.store){const e=await this.getDpopProof(this.settings.dpop.store);s=i(i({},s),{},{DPoP:e})}try{d=await this._tokenClient.exchangeRefreshToken(i({refresh_token:t.refresh_token,scope:u,redirect_uri:n,resource:r,timeoutInSeconds:a,extraHeaders:s},o))}catch(p){if(!(p instanceof on&&this.settings.dpop))throw p;s.DPoP=await this.getDpopProof(this.settings.dpop.store,p.nonce),d=await this._tokenClient.exchangeRefreshToken(i({refresh_token:t.refresh_token,scope:u,redirect_uri:n,resource:r,timeoutInSeconds:a,extraHeaders:s},o))}const h=new kn(new URLSearchParams);return Object.assign(h,d),c.debug("validating response",h),await this._validator.validateRefreshResponse(h,i(i({},t),{},{scope:u})),h}async createSignoutRequest(){let{state:e,id_token_hint:t,client_id:n,request_type:r,url_state:a,post_logout_redirect_uri:s=this.settings.post_logout_redirect_uri,extraQueryParams:o=this.settings.extraQueryParams}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=this._logger.create("createSignoutRequest"),l=await this.metadataService.getEndSessionEndpoint();if(!l)throw i.throw(new Error("No end session endpoint")),null;i.debug("Received end session endpoint",l),n||!s||t||(n=this.settings.client_id);const c=new _n({url:l,id_token_hint:t,client_id:n,post_logout_redirect_uri:s,state_data:e,extraQueryParams:o,request_type:r,url_state:a});await this.clearStaleState();const u=c.state;return u&&(i.debug("Signout request has state to persist"),await this.settings.stateStore.set(u.id,u.toStorageString())),c}async readSignoutResponseState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("readSignoutResponseState"),r=new jn(Xt.readParams(e,this.settings.response_mode));if(!r.state){if(n.debug("No state in response"),r.error)throw n.warn("Response was error:",r.error),new tn(r);return{state:void 0,response:r}}const a=await this.settings.stateStore[t?"remove":"get"](r.state);if(!a)throw n.throw(new Error("No matching state found in storage")),null;return{state:await bn.fromStorageString(a),response:r}}async processSignoutResponse(e){const t=this._logger.create("processSignoutResponse"),{state:n,response:r}=await this.readSignoutResponseState(e,!0);return n?(t.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(r,n)):t.debug("No state from storage; skipping response validation"),r}clearStaleState(){return this._logger.create("clearStaleState"),bn.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(e,t){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:e,token_type_hint:t})}},Pn=class{constructor(e){this._userManager=e,this._logger=new qt("SessionMonitor"),this._start=async e=>{const t=e.session_state;if(!t)return;const n=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,n.debug("session_state",t,", sub",this._sub)):(this._sub=void 0,n.debug("session_state",t,", anonymous user")),this._checkSessionIFrame)this._checkSessionIFrame.start(t);else try{const e=await this._userManager.metadataService.getCheckSessionIframe();if(e){n.debug("initializing check session iframe");const r=this._userManager.settings.client_id,a=this._userManager.settings.checkSessionIntervalInSeconds,s=this._userManager.settings.stopCheckSessionOnError,o=new an(this._callback,r,e,a,s);await o.load(),this._checkSessionIFrame=o,o.start(t)}else n.warn("no check session iframe found in the metadata")}catch(r){n.error("Error from getCheckSessionIframe:",r instanceof Error?r.message:r)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const t=setInterval(async()=>{clearInterval(t);try{const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub?{sub:e.sub}:null};this._start(t)}}catch(n){e.error("error from querySessionStatus",n instanceof Error?n.message:n)}},1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const t=await this._userManager.querySessionStatus();let n=!0;t&&this._checkSessionIFrame?t.sub===this._sub?(n=!1,this._checkSessionIFrame.start(t.session_state),e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",t.session_state),await this._userManager.events._raiseUserSessionChanged()):e.debug("different subject signed into OP",t.sub):e.debug("subject no longer signed into OP"),n?this._sub?await this._userManager.events._raiseUserSignedOut():await this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(t){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",t),await this._userManager.events._raiseUserSignedOut())}},e||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch(e=>{this._logger.error(e)})}async _init(){this._logger.create("_init");const e=await this._userManager.getUser();if(e)this._start(e);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub?{sub:e.sub}:null};this._start(t)}}}},An=class e{constructor(e){var t;this.id_token=e.id_token,this.session_state=null!=(t=e.session_state)?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState,this.url_state=e.url_state}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-Zt.getEpochTime()}set expires_in(e){void 0!==e&&(this.expires_at=Math.floor(e)+Zt.getEpochTime())}get expired(){const e=this.expires_in;if(void 0!==e)return e<=0}get scopes(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}toStorageString(){return new qt("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(t){return qt.createStatic("User","fromStorageString"),new e(JSON.parse(t))}},Rn="oidc-client",Dn=class{constructor(){this._abort=new Gt("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(e){const t=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");t.debug("setting URL in window"),this._window.location.replace(e.url);const{url:n,keepOpen:r}=await new Promise((n,r)=>{const a=a=>{var s;const o=a.data,i=null!=(s=e.scriptOrigin)?s:window.location.origin;if(a.origin===i&&(null==o?void 0:o.source)===Rn){try{const n=Xt.readParams(o.url,e.response_mode).get("state");if(n||t.warn("no state found in response url"),a.source!==this._window&&n!==e.state)return}catch(l){this._dispose(),r(new Error("Invalid response from window"))}n(o)}};window.addEventListener("message",a,!1),this._disposeHandlers.add(()=>window.removeEventListener("message",a,!1));const s=new BroadcastChannel("oidc-client-popup-".concat(e.state));s.addEventListener("message",a,!1),this._disposeHandlers.add(()=>s.close()),this._disposeHandlers.add(this._abort.addHandler(e=>{this._dispose(),r(e)}))});return t.debug("got response from window"),this._dispose(),r||this.close(),{url:n}}_dispose(){this._logger.create("_dispose");for(const e of this._disposeHandlers)e();this._disposeHandlers.clear()}static _notifyParent(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.location.origin;const a={source:Rn,url:t,keepOpen:n},s=new qt("_notifyParent");if(e)s.debug("With parent. Using parent.postMessage."),e.postMessage(a,r);else{s.debug("No parent. Using BroadcastChannel.");const e=new URL(t).searchParams.get("state");if(!e)throw new Error("No parent and no state in URL. Can't complete notification.");const n=new BroadcastChannel("oidc-client-popup-".concat(e));n.postMessage(a),n.close()}}},Ln={location:!1,toolbar:!1,height:640,closePopupWindowAfterInSeconds:-1},On="_blank",Un=60,Mn=2,zn=10,Fn=class extends mn{constructor(e){const{popup_redirect_uri:t=e.redirect_uri,popup_post_logout_redirect_uri:n=e.post_logout_redirect_uri,popupWindowFeatures:r=Ln,popupWindowTarget:a=On,redirectMethod:s="assign",redirectTarget:o="self",iframeNotifyParentOrigin:i=e.iframeNotifyParentOrigin,iframeScriptOrigin:l=e.iframeScriptOrigin,requestTimeoutInSeconds:c,silent_redirect_uri:u=e.redirect_uri,silentRequestTimeoutInSeconds:d,automaticSilentRenew:h=!0,validateSubOnSilentRenew:p=!0,includeIdTokenInSilentRenew:f=!1,monitorSession:m=!1,monitorAnonymousSession:g=!1,checkSessionIntervalInSeconds:v=Mn,query_status_response_type:y="code",stopCheckSessionOnError:b=!0,revokeTokenTypes:w=["access_token","refresh_token"],revokeTokensOnSignout:x=!1,includeIdTokenInSilentSignout:S=!1,accessTokenExpiringNotificationTimeInSeconds:k=Un,userStore:_}=e;if(super(e),this.popup_redirect_uri=t,this.popup_post_logout_redirect_uri=n,this.popupWindowFeatures=r,this.popupWindowTarget=a,this.redirectMethod=s,this.redirectTarget=o,this.iframeNotifyParentOrigin=i,this.iframeScriptOrigin=l,this.silent_redirect_uri=u,this.silentRequestTimeoutInSeconds=d||c||zn,this.automaticSilentRenew=h,this.validateSubOnSilentRenew=p,this.includeIdTokenInSilentRenew=f,this.monitorSession=m,this.monitorAnonymousSession=g,this.checkSessionIntervalInSeconds=v,this.stopCheckSessionOnError=b,this.query_status_response_type=y,this.revokeTokenTypes=w,this.revokeTokensOnSignout=x,this.includeIdTokenInSilentSignout=S,this.accessTokenExpiringNotificationTimeInSeconds=k,_)this.userStore=_;else{const e="undefined"!==typeof window?window.sessionStorage:new sn;this.userStore=new un({store:e})}}},Hn=class e extends Dn{constructor(t){let{silentRequestTimeoutInSeconds:n=zn}=t;super(),this._logger=new qt("IFrameWindow"),this._timeoutInSeconds=n,this._frame=e.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",window.document.body.appendChild(e),e}async navigate(e){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const t=setTimeout(()=>{this._abort.raise(new nn("IFrame timed out without a response"))},1e3*this._timeoutInSeconds);return this._disposeHandlers.add(()=>clearTimeout(t)),await super.navigate(e)}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",e=>{var t;const n=e.target;null==(t=n.parentNode)||t.removeChild(n),this._abort.raise(new Error("IFrame removed from DOM"))},!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,t){return super._notifyParent(window.parent,e,!1,t)}},Bn=class{constructor(e){this._settings=e,this._logger=new qt("IFrameNavigator")}async prepare(e){let{silentRequestTimeoutInSeconds:t=this._settings.silentRequestTimeoutInSeconds}=e;return new Hn({silentRequestTimeoutInSeconds:t})}async callback(e){this._logger.create("callback"),Hn.notifyParent(e,this._settings.iframeNotifyParentOrigin)}},Wn=class extends Dn{constructor(e){let{popupWindowTarget:t=On,popupWindowFeatures:n={},popupSignal:r}=e;super(),this._logger=new qt("PopupWindow");const a=Yt.center(i(i({},Ln),n));this._window=window.open(void 0,t,Yt.serialize(a)),r&&r.addEventListener("abort",()=>{var e;this._abort.raise(new Error(null!=(e=r.reason)?e:"Popup aborted"))}),n.closePopupWindowAfterInSeconds&&n.closePopupWindowAfterInSeconds>0&&setTimeout(()=>{this._window&&"boolean"===typeof this._window.closed&&!this._window.closed?this.close():this._abort.raise(new Error("Popup blocked by user"))},1e3*n.closePopupWindowAfterInSeconds)}async navigate(e){var t;null==(t=this._window)||t.focus();const n=setInterval(()=>{this._window&&!this._window.closed||(this._logger.debug("Popup closed by user or isolated by redirect"),r(),this._disposeHandlers.delete(r))},500),r=()=>clearInterval(n);return this._disposeHandlers.add(r),await super.navigate(e)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(e,t){super._notifyParent(window.opener,e,t),t||window.opener||window.close()}},Vn=class{constructor(e){this._settings=e,this._logger=new qt("PopupNavigator")}async prepare(e){let{popupWindowFeatures:t=this._settings.popupWindowFeatures,popupWindowTarget:n=this._settings.popupWindowTarget,popupSignal:r}=e;return new Wn({popupWindowFeatures:t,popupWindowTarget:n,popupSignal:r})}async callback(e,t){let{keepOpen:n=!1}=t;this._logger.create("callback"),Wn.notifyOpener(e,n)}},qn=class{constructor(e){this._settings=e,this._logger=new qt("RedirectNavigator")}async prepare(e){let{redirectMethod:t=this._settings.redirectMethod,redirectTarget:n=this._settings.redirectTarget}=e;var r;this._logger.create("prepare");let a=window.self;"top"===n&&(a=null!=(r=window.top)?r:window.self);const s=a.location[t].bind(a.location);let o;return{navigate:async e=>{this._logger.create("navigate");const t=new Promise((e,t)=>{o=t});return s(e.url),await t},close:()=>{this._logger.create("close"),null==o||o(new Error("Redirect aborted")),a.stop()}}}async callback(){}},Kn=class extends rn{constructor(e){super({expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new qt("UserManagerEvents"),this._userLoaded=new Gt("User loaded"),this._userUnloaded=new Gt("User unloaded"),this._silentRenewError=new Gt("Silent renew error"),this._userSignedIn=new Gt("User signed in"),this._userSignedOut=new Gt("User signed out"),this._userSessionChanged=new Gt("User session changed")}async load(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];await super.load(e),t&&await this._userLoaded.raise(e)}async unload(){await super.unload(),await this._userUnloaded.raise()}addUserLoaded(e){return this._userLoaded.addHandler(e)}removeUserLoaded(e){return this._userLoaded.removeHandler(e)}addUserUnloaded(e){return this._userUnloaded.addHandler(e)}removeUserUnloaded(e){return this._userUnloaded.removeHandler(e)}addSilentRenewError(e){return this._silentRenewError.addHandler(e)}removeSilentRenewError(e){return this._silentRenewError.removeHandler(e)}async _raiseSilentRenewError(e){await this._silentRenewError.raise(e)}addUserSignedIn(e){return this._userSignedIn.addHandler(e)}removeUserSignedIn(e){this._userSignedIn.removeHandler(e)}async _raiseUserSignedIn(){await this._userSignedIn.raise()}addUserSignedOut(e){return this._userSignedOut.addHandler(e)}removeUserSignedOut(e){this._userSignedOut.removeHandler(e)}async _raiseUserSignedOut(){await this._userSignedOut.raise()}addUserSessionChanged(e){return this._userSessionChanged.addHandler(e)}removeUserSessionChanged(e){this._userSessionChanged.removeHandler(e)}async _raiseUserSessionChanged(){await this._userSessionChanged.raise()}},$n=class{constructor(e){this._userManager=e,this._logger=new qt("SilentRenewService"),this._isStarted=!1,this._retryTimer=new Zt("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(t){if(t instanceof nn)return e.warn("ErrorTimeout from signinSilent:",t,"retry in 5s"),void this._retryTimer.init(5);e.error("Error from signinSilent:",t),await this._userManager.events._raiseSilentRenewError(t)}}}async start(){const e=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(t){e.error("getUser error",t)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}},Jn=class{constructor(e){this.refresh_token=e.refresh_token,this.id_token=e.id_token,this.session_state=e.session_state,this.scope=e.scope,this.profile=e.profile,this.data=e.state}};const Qn=["children","onSigninCallback","skipSigninCallback","matchSignoutCallback","onSignoutCallback","onRemoveUser","userManager"];var Gn=l.createContext(void 0);Gn.displayName="AuthContext";var Yn={isLoading:!0,isAuthenticated:!1},Zn=(e,t)=>{switch(t.type){case"INITIALISED":case"USER_LOADED":return i(i({},e),{},{user:t.user,isLoading:!1,isAuthenticated:!!t.user&&!t.user.expired,error:void 0});case"USER_SIGNED_OUT":case"USER_UNLOADED":return i(i({},e),{},{user:void 0,isAuthenticated:!1});case"NAVIGATOR_INIT":return i(i({},e),{},{isLoading:!0,activeNavigator:t.method});case"NAVIGATOR_CLOSE":return i(i({},e),{},{isLoading:!1,activeNavigator:void 0});case"ERROR":{const n=t.error;return n.toString=()=>"".concat(n.name,": ").concat(n.message),i(i({},e),{},{isLoading:!1,error:n})}default:{const n=new TypeError("unknown type ".concat(t.type)),r={name:n.name,message:n.message,innerError:n,stack:n.stack,source:"unknown",toString:()=>"".concat(r.name,": ").concat(r.message)};return i(i({},e),{},{isLoading:!1,error:r})}}},Xn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location,t=new URLSearchParams(e.search);return!(!t.get("code")&&!t.get("error")||!t.get("state"))||(t=new URLSearchParams(e.hash.replace("#","?")),!(!t.get("code")&&!t.get("error")||!t.get("state")))},er=ar("signinCallback","Sign-in failed"),tr=ar("signoutCallback","Sign-out failed"),nr=ar("renewSilent","Renew silent failed");function rr(e,t){return{name:sr(e,"name",()=>"Error"),message:sr(e,"message",()=>t),stack:sr(e,"stack",()=>(new Error).stack),innerError:e}}function ar(e,t){return n=>i(i({},rr(n,t)),{},{source:e})}function sr(e,t,n){if(e&&"object"===typeof e){const n=e[t];if("string"===typeof n)return n}return n()}var or=["clearStaleState","querySessionStatus","revokeTokens","startSilentRenew","stopSilentRenew"],ir=["signinPopup","signinSilent","signinRedirect","signinResourceOwnerCredentials","signoutPopup","signoutRedirect","signoutSilent"],lr=e=>()=>{throw new Error("UserManager#".concat(e," was called from an unsupported context. If this is a server-rendered page, defer this call with useEffect() or pass a custom UserManager implementation."))},cr="undefined"===typeof window?null:class{constructor(e,t,n,r){this._logger=new qt("UserManager"),this.settings=new Fn(e),this._client=new In(e),this._redirectNavigator=null!=t?t:new qn(this.settings),this._popupNavigator=null!=n?n:new Vn(this.settings),this._iframeNavigator=null!=r?r:new Bn(this.settings),this._events=new Kn(this.settings),this._silentRenewService=new $n(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new Pn(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this._logger.create("getUser"),n=await this._loadUser();return n?(t.info("user loaded"),await this._events.load(n,e),n):(t.info("user not found in storage"),null)}async removeUser(){const e=this._logger.create("removeUser");await this.storeUser(null),e.info("user removed from storage"),await this._events.unload()}async signinRedirect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;this._logger.create("signinRedirect");const{redirectMethod:n}=e,r=u(e,Rt);let a;(null==(t=this.settings.dpop)?void 0:t.bind_authorization_code)&&(a=await this.generateDPoPJkt(this.settings.dpop));const s=await this._redirectNavigator.prepare({redirectMethod:n});await this._signinStart(i({request_type:"si:r",dpopJkt:a},r),s)}async signinRedirectCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signinRedirectCallback"),n=await this._signinEnd(e);return n.profile&&n.profile.sub?t.info("success, signed in subject",n.profile.sub):t.info("no subject"),n}async signinResourceOwnerCredentials(e){let{username:t,password:n,skipUserInfo:r=!1}=e;const a=this._logger.create("signinResourceOwnerCredential"),s=await this._client.processResourceOwnerPasswordCredentials({username:t,password:n,skipUserInfo:r,extraTokenParams:this.settings.extraTokenParams});a.debug("got signin response");const o=await this._buildUser(s);return o.profile&&o.profile.sub?a.info("success, signed in subject",o.profile.sub):a.info("no subject"),o}async signinPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const n=this._logger.create("signinPopup");let r;(null==(t=this.settings.dpop)?void 0:t.bind_authorization_code)&&(r=await this.generateDPoPJkt(this.settings.dpop));const{popupWindowFeatures:a,popupWindowTarget:s,popupSignal:o}=e,l=u(e,Dt),c=this.settings.popup_redirect_uri;c||n.throw(new Error("No popup_redirect_uri configured"));const d=await this._popupNavigator.prepare({popupWindowFeatures:a,popupWindowTarget:s,popupSignal:o}),h=await this._signin(i({request_type:"si:p",redirect_uri:c,display:"popup",dpopJkt:r},l),d);return h&&(h.profile&&h.profile.sub?n.info("success, signed in subject",h.profile.sub):n.info("no subject")),h}async signinPopupCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(e,{keepOpen:t}),n.info("success")}async signinSilent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t,n;const r=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:a}=e,s=u(e,Lt);let o,l=await this._loadUser();if(null==l?void 0:l.refresh_token){r.debug("using refresh token");const e=new Jn(l);return await this._useRefreshToken({state:e,redirect_uri:s.redirect_uri,resource:s.resource,extraTokenParams:s.extraTokenParams,timeoutInSeconds:a})}(null==(t=this.settings.dpop)?void 0:t.bind_authorization_code)&&(o=await this.generateDPoPJkt(this.settings.dpop));const c=this.settings.silent_redirect_uri;let d;c||r.throw(new Error("No silent_redirect_uri configured")),l&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",l.profile.sub),d=l.profile.sub);const h=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:a});return l=await this._signin(i({request_type:"si:s",redirect_uri:c,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==l?void 0:l.id_token:void 0,dpopJkt:o},s),h,d),l&&((null==(n=l.profile)?void 0:n.sub)?r.info("success, signed in subject",l.profile.sub):r.info("no subject")),l}async _useRefreshToken(e){const t=await this._client.useRefreshToken(i({timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds},e)),n=new An(i(i({},e.state),t));return await this.storeUser(n),await this._events.load(n),n}async signinSilentCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async signinCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const{state:t}=await this._client.readSigninResponseState(e);switch(t.request_type){case"si:r":return await this.signinRedirectCallback(e);case"si:p":await this.signinPopupCallback(e);break;case"si:s":await this.signinSilentCallback(e);break;default:throw new Error("invalid response_type in state")}}async signoutCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:n}=await this._client.readSignoutResponseState(e);if(n)switch(n.request_type){case"so:r":return await this.signoutRedirectCallback(e);case"so:p":await this.signoutPopupCallback(e,t);break;case"so:s":await this.signoutSilentCallback(e);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:n}=e,r=u(e,Ot),a=this.settings.silent_redirect_uri;a||t.throw(new Error("No silent_redirect_uri configured"));const s=await this._loadUser(),o=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n}),l=await this._signinStart(i({request_type:"si:s",redirect_uri:a,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==s?void 0:s.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0},r),o);try{const e={},n=await this._client.processSigninResponse(l.url,e);return t.debug("got signin response"),n.session_state&&n.profile.sub?(t.info("success for subject",n.profile.sub),{session_state:n.session_state,sub:n.profile.sub}):(t.info("success, user not authenticated"),null)}catch(c){if(this.settings.monitorAnonymousSession&&c instanceof tn)switch(c.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return t.info("success for anonymous user"),{session_state:c.session_state}}throw c}}async _signin(e,t,n){const r=await this._signinStart(e,t);return await this._signinEnd(r.url,n)}async _signinStart(e,t){const n=this._logger.create("_signinStart");try{const r=await this._client.createSigninRequest(e);return n.debug("got signin request"),await t.navigate({url:r.url,state:r.state.id,response_mode:r.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(r){throw n.debug("error after preparing navigator, closing navigator window"),t.close(),r}}async _signinEnd(e,t){const n=this._logger.create("_signinEnd"),r=await this._client.processSigninResponse(e,{});n.debug("got signin response");return await this._buildUser(r,t)}async _buildUser(e,t){const n=this._logger.create("_buildUser"),r=new An(e);if(t){if(t!==r.profile.sub)throw n.debug("current user does not match user returned from signin. sub from signin:",r.profile.sub),new tn(i(i({},e),{},{error:"login_required"}));n.debug("current user matches user returned from signin")}return await this.storeUser(r),n.debug("user stored"),await this._events.load(r),r}async signoutRedirect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("signoutRedirect"),{redirectMethod:n}=e,r=u(e,Ut),a=await this._redirectNavigator.prepare({redirectMethod:n});await this._signoutStart(i({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri},r),a),t.info("success")}async signoutRedirectCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signoutRedirectCallback"),n=await this._signoutEnd(e);return t.info("success"),n}async signoutPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("signoutPopup"),{popupWindowFeatures:n,popupWindowTarget:r,popupSignal:a}=e,s=u(e,Mt),o=this.settings.popup_post_logout_redirect_uri,l=await this._popupNavigator.prepare({popupWindowFeatures:n,popupWindowTarget:r,popupSignal:a});await this._signout(i({request_type:"so:p",post_logout_redirect_uri:o,state:null==o?void 0:{}},s),l),t.info("success")}async signoutPopupCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(e,{keepOpen:t}),n.info("success")}async _signout(e,t){const n=await this._signoutStart(e,t);return await this._signoutEnd(n.url)}async _signoutStart(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;var n;const r=this._logger.create("_signoutStart");try{const a=await this._loadUser();r.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(a);const s=e.id_token_hint||a&&a.id_token;s&&(r.debug("setting id_token_hint in signout request"),e.id_token_hint=s),await this.removeUser(),r.debug("user removed, creating signout request");const o=await this._client.createSignoutRequest(e);return r.debug("got signout request"),await t.navigate({url:o.url,state:null==(n=o.state)?void 0:n.id,scriptOrigin:this.settings.iframeScriptOrigin})}catch(a){throw r.debug("error after preparing navigator, closing navigator window"),t.close(),a}}async _signoutEnd(e){const t=this._logger.create("_signoutEnd"),n=await this._client.processSignoutResponse(e);return t.debug("got signout response"),n}async signoutSilent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const n=this._logger.create("signoutSilent"),{silentRequestTimeoutInSeconds:r}=e,a=u(e,zt),s=this.settings.includeIdTokenInSilentSignout?null==(t=await this._loadUser())?void 0:t.id_token:void 0,o=this.settings.popup_post_logout_redirect_uri,l=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r});await this._signout(i({request_type:"so:s",post_logout_redirect_uri:o,id_token_hint:s},a),l),n.info("success")}async signoutSilentCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async revokeTokens(e){const t=await this._loadUser();await this._revokeInternal(t,e)}async _revokeInternal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.settings.revokeTokenTypes;const n=this._logger.create("_revokeInternal");if(!e)return;const r=t.filter(t=>"string"===typeof e[t]);if(r.length){for(const t of r)await this._client.revokeToken(e[t],t),n.info("".concat(t," revoked successfully")),"access_token"!==t&&(e[t]=null);await this.storeUser(e),n.debug("user stored"),await this._events.load(e)}else n.debug("no need to revoke due to no token(s)")}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return"user:".concat(this.settings.authority,":").concat(this.settings.client_id)}async _loadUser(){const e=this._logger.create("_loadUser"),t=await this.settings.userStore.get(this._userStoreKey);return t?(e.debug("user storageString loaded"),An.fromStorageString(t)):(e.debug("no user storageString"),null)}async storeUser(e){const t=this._logger.create("storeUser");if(e){t.debug("storing user");const n=e.toStorageString();await this.settings.userStore.set(this._userStoreKey,n)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey),this.settings.dpop&&await this.settings.dpop.store.remove(this.settings.client_id)}async clearStaleState(){await this._client.clearStaleState()}async dpopProof(e,t,n,r){var a,s;const o=await(null==(s=null==(a=this.settings.dpop)?void 0:a.store)?void 0:s.get(this.settings.client_id));if(o)return await Qt.generateDPoPProof({url:e,accessToken:null==t?void 0:t.access_token,httpMethod:n,keyPair:o.keys,nonce:r})}async generateDPoPJkt(e){let t=await e.store.get(this.settings.client_id);if(!t){const n=await Qt.generateDPoPKeys();t=new Tn(n),await e.store.set(this.settings.client_id,t)}return await Qt.generateDPoPJkt(t.keys)}},ur=e=>{const{children:t,onSigninCallback:n,skipSigninCallback:r,matchSignoutCallback:a,onSignoutCallback:s,onRemoveUser:o,userManager:c=null}=e,d=u(e,Qn),[h]=l.useState(()=>null!=c?c:cr?new cr(d):{settings:d}),[p,f]=l.useReducer(Zn,Yn),m=l.useMemo(()=>Object.assign({settings:h.settings,events:h.events},Object.fromEntries(or.map(e=>{var t,n;return[e,null!=(n=null==(t=h[e])?void 0:t.bind(h))?n:lr(e)]})),Object.fromEntries(ir.map(e=>[e,h[e]?async t=>{f({type:"NAVIGATOR_INIT",method:e});try{return await h[e](t)}catch(n){return f({type:"ERROR",error:i(i({},rr(n,"Unknown error while executing ".concat(e,"(...)."))),{},{source:e,args:t})}),null}finally{f({type:"NAVIGATOR_CLOSE"})}}:lr(e)]))),[h]),g=l.useRef(!1);l.useEffect(()=>{h&&!g.current&&(g.current=!0,(async()=>{try{let e=null;Xn()&&!r&&(e=await h.signinCallback(),n&&await n(e)),e=e||await h.getUser(),f({type:"INITIALISED",user:e})}catch(e){f({type:"ERROR",error:er(e)})}try{if(a&&a(h.settings)){const e=await h.signoutCallback();s&&await s(e)}}catch(e){f({type:"ERROR",error:tr(e)})}})())},[h,r,n,s,a]),l.useEffect(()=>{if(!h)return;const e=e=>{f({type:"USER_LOADED",user:e})};h.events.addUserLoaded(e);const t=()=>{f({type:"USER_UNLOADED"})};h.events.addUserUnloaded(t);const n=()=>{f({type:"USER_SIGNED_OUT"})};h.events.addUserSignedOut(n);const r=e=>{f({type:"ERROR",error:nr(e)})};return h.events.addSilentRenewError(r),()=>{h.events.removeUserLoaded(e),h.events.removeUserUnloaded(t),h.events.removeUserSignedOut(n),h.events.removeSilentRenewError(r)}},[h]);const v=l.useCallback(async()=>{h||lr("removeUser"),await h.removeUser(),o&&await o()},[h,o]),y=l.useMemo(()=>i(i(i({},p),m),{},{removeUser:v}),[p,m,v]);return l.createElement(Gn.Provider,{value:y},t)},dr=()=>{const e=l.useContext(Gn);return e||console.warn("AuthProvider context is undefined, please verify you are calling useAuth() as child of a <AuthProvider> component."),e};const hr="https://user-service.duckdns.org/Api-user";class pr{static setToken(e){this.token=e,localStorage.setItem("uplearn_token",e)}static getToken(){return this.token||(this.token=localStorage.getItem("uplearn_token")),this.token}static clearToken(){this.token=null,localStorage.removeItem("uplearn_token")}static setCognitoToken(e){this.token=e,localStorage.setItem("uplearn_cognito_token",e)}static getCognitoToken(){return localStorage.getItem("uplearn_cognito_token")||this.token}static decodeToken(){const e=this.getToken();if(!e)return null;try{const t=e.split(".")[1];return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(Is){return console.error("Error decoding token:",Is),null}}static getCurrentUser(){const e=this.decodeToken();return e&&e?{userId:e.sub,role:e.role}:null}static async login(e,t){try{const n=await fetch("".concat(hr,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,password:t})});if(!n.ok){const e=await n.text();throw console.error("Error del servidor:",e),new Error("HTTP error! status: ".concat(n.status))}const r=await n.json();return r.authenticated&&r.token&&this.setToken(r.token),r}catch(n){throw console.error("Error en login:",n),new Error("Error de conexi\xf3n. Verifica que el servidor est\xe9 disponible.")}}static logout(){this.clearToken()}static async getStudentProfile(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(hr,"/student/profile"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(t){throw console.error("Error obteniendo perfil de estudiante:",t),t}}static async updateStudentProfile(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||this.getToken();if(!t)throw new Error("No hay token de autenticaci\xf3n");try{const n=await fetch("".concat(hr,"/student/profile"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(!n.ok){const e=await n.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(n.status))}return await n.json()}catch(n){throw console.error("Error actualizando perfil de estudiante:",n),n}}static async removeStudentRole(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(hr,"/student/profile"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}const n=await t.json();return n.userDeleted&&this.clearToken(),n}catch(t){throw console.error("Error eliminando rol de estudiante:",t),t}}static async getTutorProfile(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(hr,"/tutor/profile"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(t){throw console.error("Error obteniendo perfil de tutor:",t),t}}static async updateTutorProfile(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||this.getToken();if(!t)throw new Error("No hay token de autenticaci\xf3n");try{const n=await fetch("".concat(hr,"/tutor/profile"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(!n.ok){const e=await n.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(n.status))}return await n.json()}catch(n){throw console.error("Error actualizando perfil de tutor:",n),n}}static async removeTutorRole(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(hr,"/tutor/profile"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}const n=await t.json();return n.userDeleted&&this.clearToken(),n}catch(t){throw console.error("Error eliminando rol de tutor:",t),t}}static async getTutorTokensRate(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(hr,"/tutor/tokens-rate"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor obteniendo tarifa de tokens:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return t.json()}catch(t){throw console.error("Error obteniendo tarifa de tokens del tutor:",t),t}}static async getTutorTokensRateBySubOrId(e){if(!e)throw new Error("idOrSub requerido");const t=async t=>{const n="".concat(hr,"/tutor/tokens-rate-by-sub?").concat(t,"=").concat(encodeURIComponent(e)),r=await fetch(n,{method:"GET",headers:{Accept:"application/json"}});if(!r.ok)return null;try{return await r.json()}catch(a){return null}},n=await t("sub");if(n&&"undefined"!==typeof n.tokensPerHour)return n;const r=await t("id");if(r&&"undefined"!==typeof r.tokensPerHour)return r;throw new Error("No se pudo obtener tokensPerHour del tutor")}static async getAllUsers(){const e=this.getToken();try{const t=await fetch("".concat(hr,"/users"),{method:"GET",headers:i({"Content-Type":"application/json"},e?{Authorization:"Bearer ".concat(e)}:{})});if(!t.ok)throw new Error("HTTP error! status: ".concat(t.status));return t.json()}catch(t){throw console.error("Error obteniendo usuarios:",t),t}}static async getUserById(e){const t=this.getToken();try{const n=await fetch("".concat(hr,"/users/").concat(e),{method:"GET",headers:i({"Content-Type":"application/json"},t?{Authorization:"Bearer ".concat(t)}:{})});if(!n.ok)throw new Error("HTTP error! status: ".concat(n.status));return n.json()}catch(n){throw console.error("Error obteniendo usuario:",n),n}}static async processCognitoUser(e){try{const t=await fetch("".concat(hr,"/process-cognito-user"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(!t.ok){const e=await t.text();throw console.error("Error del servidor procesando Cognito:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(t){throw console.error("Error procesando usuario de Cognito:",t),t}}static async saveUserRole(e,t){try{const n=Array.isArray(t)?t:[t],r=await fetch("".concat(hr,"/save-user-role"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({roles:n})});if(!r.ok){const e=await r.text();throw console.error("Error del servidor guardando roles:",e),new Error(e||"HTTP error! status: ".concat(r.status))}return await r.json()}catch(n){throw console.error("Error guardando roles de usuario:",n),n}}static async getMyRoles(e){try{const t=await fetch("".concat(hr,"/my-roles"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor obteniendo roles:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(t){throw console.error("Error obteniendo roles del usuario:",t),t}}static async getProfileStatus(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const n=t?"".concat(hr,"/profile-status?role=").concat(t):"".concat(hr,"/profile-status"),r=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!r.ok){const e=await r.text();throw console.error("Error del servidor obteniendo estado del perfil:",e),new Error(e||"HTTP error! status: ".concat(r.status))}return await r.json()}catch(n){throw console.error("Error obteniendo estado del perfil:",n),n}}static async addRoleToUser(e,t,n){try{const r=await fetch("".concat(hr,"/add-role"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({userId:t,role:n})});if(!r.ok){const e=await r.text();throw console.error("Error del servidor a\xf1adiendo rol:",e),new Error(e||"HTTP error! status: ".concat(r.status))}return await r.json()}catch(r){throw console.error("Error a\xf1adiendo rol al usuario:",r),r}}static async uploadTutorCredentials(e,t){if(!e)throw new Error("No hay token de autenticaci\xf3n");if(!t||0===t.length)throw new Error("Debe seleccionar al menos un archivo");const n=new FormData;for(const a of t)n.append("files",a);try{const t=await fetch("".concat(hr,"/tutor/credentials"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:n});if(!t.ok){const e=await t.text();throw console.error("Error subiendo credenciales:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return t.json()}catch(r){throw console.error("Error en uploadTutorCredentials:",r),r}}static async deleteTutorCredentials(e,t){if(!e)throw new Error("No hay token de autenticaci\xf3n");if(!t||0===t.length)throw new Error("Debe proporcionar al menos una URL para eliminar");try{const n=await fetch("".concat(hr,"/tutor/credentials"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({urls:t})});if(!n.ok){const e=await n.text();throw console.error("Error eliminando credenciales:",e),new Error(e||"HTTP error! status: ".concat(n.status))}return n.json()}catch(n){throw console.error("Error en deleteTutorCredentials:",n),n}}}pr.token=null;const fr=pr;let mr=null,gr=!1,vr=null,yr=null;const br=()=>{mr=null,gr=!1,vr=null,yr=null},wr=()=>{var e;const t=dr(),[n,r]=(me(),(0,l.useState)(()=>mr&&mr.isAuthenticated&&!mr.isLoading?mr:{isLoading:!0,isAuthenticated:!1,needsRoleSelection:!1,userRoles:null,error:null}));return(0,l.useEffect)(()=>{const e=async()=>{try{var e,n;const r=null===(e=t.user)||void 0===e?void 0:e.id_token;if(!r)throw new Error("Token de Cognito no disponible");const a=await fr.processCognitoUser(r),s=null===(n=a.user)||void 0===n?void 0:n.roles,o=!s||0===s.length||Array.isArray(s)&&s.every(e=>!e||""===e.trim())||null===s||void 0===s;if(a.isNewUser||o)return{isLoading:!1,isAuthenticated:!0,needsRoleSelection:!0,userRoles:null,error:null};return{isLoading:!1,isAuthenticated:!0,needsRoleSelection:!1,userRoles:a.user.roles,error:null}}catch(r){throw console.error("Error procesando flujo de autenticaci\xf3n:",r),r}};(async()=>{var n;const a=null===(n=t.user)||void 0===n?void 0:n.id_token;if(!t.isAuthenticated||!a){const e={isLoading:!1,isAuthenticated:!1,needsRoleSelection:!1,userRoles:null,error:null};return r(e),mr=e,void(yr=null)}if(mr&&mr.isAuthenticated&&!mr.isLoading&&yr===a)r(mr);else{if(yr&&yr!==a&&br(),gr&&vr&&yr===a)try{const e=await vr;return void r(e)}catch(s){console.error("Error esperando proceso:",s)}gr=!0,yr=a,vr=e();try{const e=await vr;r(e),mr=e}catch(s){console.error("Error en el flujo de autenticaci\xf3n:",s);const e={isLoading:!1,isAuthenticated:!1,needsRoleSelection:!1,userRoles:null,error:s instanceof Error?s.message:"Error de autenticaci\xf3n"};r(e),mr=e}finally{gr=!1,vr=null}}})()},[t.isAuthenticated,null===(e=t.user)||void 0===e?void 0:e.id_token]),i(i({},n),{},{auth:t})};var xr=n(579);const Sr=()=>{var e,t;const n=me(),r=dr(),{userRoles:a,isAuthenticated:s}=wr();return r.isLoading?(0,xr.jsx)("div",{className:"home-container",children:(0,xr.jsxs)("div",{className:"content",children:[(0,xr.jsx)("h1",{className:"title",children:"Cargando..."}),(0,xr.jsx)("p",{className:"subtitle",children:"Verificando estado de autenticaci\xf3n..."})]})}):(0,xr.jsx)("div",{className:"home-container",children:(0,xr.jsxs)("div",{className:"content",children:[(0,xr.jsx)("h1",{className:"title",children:"Bienvenido a UpLearn"}),(0,xr.jsx)("p",{className:"subtitle",children:"Tu plataforma de aprendizaje online"}),r.isAuthenticated?(0,xr.jsxs)("div",{className:"authenticated-section",children:[(0,xr.jsxs)("div",{className:"user-info",children:[(0,xr.jsxs)("p",{className:"welcome-message",children:["\xa1Hola, ",(null===(e=r.user)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.email)||"Usuario","! \ud83d\udc4b"]}),(0,xr.jsxs)("p",{className:"auth-status",children:["Estado: ",(0,xr.jsx)("strong",{children:"Autenticado con AWS Cognito"})]})]}),(0,xr.jsxs)("div",{className:"buttons-container",children:[(0,xr.jsx)("button",{className:"btn btn-dashboard",onClick:()=>{if(s&&a&&a.length>0){const e=a.includes("student")?"/student-dashboard":"/tutor-dashboard";n(e)}else n("/login")},children:"Ir al Dashboard"}),(0,xr.jsx)("button",{className:"btn btn-logout",onClick:async()=>{r.removeUser();window.location.href="".concat("https://us-east-18mvprkbvu.auth.us-east-1.amazoncognito.com","/logout?client_id=").concat("342s18a96gl2pbaroorqh316l8","&logout_uri=").concat(encodeURIComponent("https://nice-mud-05a4c8f10.3.azurestaticapps.net/"))},children:"Cerrar Sesi\xf3n"})]})]}):(0,xr.jsxs)("div",{className:"buttons-container",children:[(0,xr.jsx)("button",{className:"btn btn-login",onClick:()=>{r.signinRedirect()},children:"Iniciar Sesi\xf3n"}),(0,xr.jsx)("button",{className:"btn btn-register",onClick:()=>{r.signinRedirect({extraQueryParams:{signup:"true"}})},children:"Registrarse"})]}),r.error&&(0,xr.jsxs)("div",{className:"error-info",children:[(0,xr.jsx)("h3",{children:"Error de Autenticaci\xf3n"}),(0,xr.jsx)("p",{children:r.error.message})]})]})})},kr=()=>{var e,t,n,r;const a=dr(),s=he(),[o,i]=(0,l.useState)(null),[c,u]=(0,l.useState)(!0),[d,h]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{var e;if(!a.isAuthenticated||null===(e=a.user)||void 0===e||!e.id_token)return console.log("\ud83d\udd0d useProfileStatus: No autenticado o sin token"),void u(!1);try{let e;u(!0),h(null),s.pathname.includes("/student-dashboard")?e="STUDENT":s.pathname.includes("/tutor-dashboard")&&(e="TUTOR"),console.log("\ud83d\udd0d useProfileStatus: Verificando estado del perfil...",e?"para rol: ".concat(e):"sin rol espec\xedfico");const t=await fr.getProfileStatus(a.user.id_token,e);console.log("\u2705 useProfileStatus: Estado recibido:",t),i(t)}catch(t){console.error("\u274c useProfileStatus: Error verificando estado del perfil:",t),h(t instanceof Error?t.message:"Error verificando el perfil")}finally{u(!1)}})()},[a.isAuthenticated,null===(e=a.user)||void 0===e?void 0:e.id_token,s.pathname]);const p={profileStatus:o,isLoading:c,error:d,isProfileComplete:null===(t=null!==(n=null===o||void 0===o?void 0:o.complete)&&void 0!==n?n:null===o||void 0===o?void 0:o.isComplete)||void 0===t||t,missingFields:null!==(r=null===o||void 0===o?void 0:o.missingFields)&&void 0!==r?r:null};return console.log("\ud83d\udcca useProfileStatus: Retornando resultado:",p),p},_r={},jr={SCHEDULER_BASE:_r.VITE_SCHEDULER_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SCHEDULER_API_BASE||"https://reservations-service.duckdns.org",TASKS_BASE:_r.VITE_TASKS_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_TASKS_API_BASE||_r.VITE_SCHEDULER_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SCHEDULER_API_BASE||"https://reservations-service.duckdns.org",USERS_BASE:_r.VITE_USERS_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_USER_API_BASE||"https://user-service.duckdns.org/Api-user",USERS_PROFILE_PATH:_r.VITE_USERS_PROFILE_PATH||"/public/profile",PAYMENT_BASE:_r.VITE_PAYMENT_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_PAYMENT_API_BASE||"https://wallet-service.duckdns.org/api"},Nr=(jr.SCHEDULER_BASE||"https://reservations-service.duckdns.org").replace(/\/$/,"");function Er(e){const t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t}async function Cr(e){if(!e.ok){var t,n,r;let s=null;try{s=await e.json()}catch(a){s=await e.text().catch(()=>null)}const o="string"===typeof s?s:(null===(t=s)||void 0===t?void 0:t.message)||(null===(n=s)||void 0===n?void 0:n.error)||(null===(r=s)||void 0===r?void 0:r.path)||"HTTP ".concat(e.status),i="HTTP ".concat(e.status,": ").concat(o);throw new Error(i)}return 204===e.status?null:e.json()}async function Tr(e,t,n,r){const a="".concat(Nr,"/api/reservations");return Cr(await fetch(a,{method:"POST",headers:Er(r),body:JSON.stringify({tutorId:e,date:t,hour:n})}))}async function Ir(e,t,n){const r="".concat(Nr,"/api/reservations/my?from=").concat(e,"&to=").concat(t);return Cr(await fetch(r,{method:"GET",headers:Er(n)}))}async function Pr(e,t,n){const r="".concat(Nr,"/api/reservations/for-me?from=").concat(e,"&to=").concat(t);return Cr(await fetch(r,{method:"GET",headers:Er(n)}))}async function Ar(e,t){const n="".concat(Nr,"/api/reservations/").concat(e,"/cancel");return Cr(await fetch(n,{method:"PATCH",headers:Er(t)}))}async function Rr(e,t,n){const r="".concat(Nr,"/api/schedule/tutor/").concat(encodeURIComponent(e),"?weekStart=").concat(t);return Cr(await fetch(r,{method:"GET",headers:Er(n)}))}async function Dr(e,t,n){const r="".concat(Nr,"/api/availability/add");return Cr(await fetch(r,{method:"POST",headers:Er(n),body:JSON.stringify({date:e,hours:t})}))}async function Lr(e,t){const n="".concat(Nr,"/api/availability/day/").concat(e),r=await fetch(n,{method:"PUT",headers:Er(t),body:JSON.stringify({hours:[]})});await Cr(r)}const Or=e=>{let{currentRole:t,className:n="",asMenuItem:r=!1}=e;const{switchToDashboard:a,canSwitchTo:s,isLoading:o,error:i}=(()=>{const e=me(),t=dr(),[n,r]=(0,l.useState)(!1),[a,s]=(0,l.useState)("");return{switchToDashboard:async n=>{var o;if(null===(o=t.user)||void 0===o||!o.id_token)return s("No hay token de autenticaci\xf3n disponible"),!1;r(!0),s("");try{return((await fr.getMyRoles(t.user.id_token)).roles||[]).includes(n)?(e("student"===n?"/student-dashboard":"/tutor-dashboard"),!0):(s("No tienes permisos para acceder como ".concat("student"===n?"estudiante":"tutor")),!1)}catch(a){return console.error("Error cambiando dashboard:",a),s(a instanceof Error?a.message:"Error al cambiar de dashboard"),!1}finally{r(!1)}},canSwitchTo:async e=>{var n;if(null===(n=t.user)||void 0===n||!n.id_token)return!1;try{return((await fr.getMyRoles(t.user.id_token)).roles||[]).includes(e)}catch(a){return console.error("Error verificando roles:",a),!1}},isLoading:n,error:a}})(),[c,u]=(0,l.useState)(!1),d="student"===t?"tutor":"student",h="student"===d?"Estudiante":"Tutor",p="student"===d?"\ud83d\udcda":"\ud83d\udc68\u200d\ud83c\udfeb";(0,l.useEffect)(()=>{const e=async()=>{const e=await s(d);u(e)};e();const t=setInterval(e,2e3);return()=>clearInterval(t)},[d,s]);const f=async()=>{await a(d)};return c?r?(0,xr.jsxs)("button",{className:"dropdown-item ".concat(n),onClick:f,disabled:o,children:[(0,xr.jsx)("span",{children:p})," ",o?"Cambiando...":"Ir a ".concat(h)]}):(0,xr.jsxs)("div",{className:"dashboard-switch-container",children:[(0,xr.jsxs)("button",{className:"dashboard-switch-btn ".concat(n),onClick:f,disabled:o,title:"Cambiar a dashboard de ".concat(h),children:[(0,xr.jsx)("span",{className:"switch-icon",children:p}),(0,xr.jsx)("span",{className:"switch-text",children:o?"Cambiando...":"Ir a ".concat(h)})]}),i&&(0,xr.jsx)("div",{className:"switch-error",style:{color:"red",fontSize:"12px",marginTop:"4px"},children:i})]}):null},Ur=e=>{let{currentRole:t,className:n="",asMenuItem:r=!1}=e;const{addRole:a,canAddRole:s,isLoading:o,error:i,success:c,clearMessages:u}=(()=>{const e=dr(),[t,n]=(0,l.useState)(!1),[r,a]=(0,l.useState)(""),[s,o]=(0,l.useState)("");return{addRole:async t=>{var s,i,l;if(null===(s=e.user)||void 0===s||!s.id_token)return a("No hay token de autenticaci\xf3n disponible"),!1;if(null===(i=e.user)||void 0===i||null===(l=i.profile)||void 0===l||!l.sub)return a("No se pudo obtener el ID del usuario"),!1;n(!0),a(""),o("");try{return((await fr.getMyRoles(e.user.id_token)).roles||[]).includes(t)?(a("Ya tienes el rol de ".concat("student"===t?"estudiante":"tutor")),!1):(await fr.addRoleToUser(e.user.id_token,e.user.profile.sub,t),o("\xa1Ahora tambi\xe9n eres ".concat("student"===t?"estudiante":"tutor","! Puedes cambiar entre dashboards.")),br(),!0)}catch(r){return console.error("Error a\xf1adiendo rol:",r),a(r instanceof Error?r.message:"Error al a\xf1adir el rol"),!1}finally{n(!1)}},canAddRole:async t=>{var n;if(null===(n=e.user)||void 0===n||!n.id_token)return!1;try{return!((await fr.getMyRoles(e.user.id_token)).roles||[]).includes(t)}catch(r){return console.error("Error verificando roles:",r),!1}},isLoading:t,error:r,success:s,clearMessages:()=>{a(""),o("")}}})(),[d,h]=(0,l.useState)(!1),[p,f]=(0,l.useState)(!1),m="student"===t?"tutor":"student",g="student"===m?"Estudiante":"Tutor",v="student"===m?"\ud83d\udcda":"\ud83d\udc68\u200d\ud83c\udfeb";(0,l.useEffect)(()=>{(async()=>{const e=await s(m);h(e)})()},[m,s]);const y=async()=>{const e=await a(m);if((e||i)&&(f(!0),setTimeout(()=>{f(!1),u()},5e3),e)){const e=await s(m);h(e)}};return d?r?(0,xr.jsxs)("button",{className:"dropdown-item ".concat(n),onClick:y,disabled:o,children:[(0,xr.jsx)("span",{children:v})," ",o?"A\xf1adiendo...":"Ser ".concat(g)]}):(0,xr.jsxs)("div",{className:"add-role-container",children:[(0,xr.jsxs)("button",{className:"add-role-btn ".concat(n),onClick:y,disabled:o,title:"Convertirte tambi\xe9n en ".concat(g),children:[(0,xr.jsx)("span",{className:"add-role-icon",children:v}),(0,xr.jsx)("span",{className:"add-role-text",children:o?"A\xf1adiendo...":"Ser ".concat(g)})]}),p&&(c||i)&&(0,xr.jsx)("div",{className:"add-role-message ".concat(c?"success":"error"),children:(0,xr.jsxs)("div",{className:"message-content",children:[(0,xr.jsx)("span",{className:"message-icon",children:c?"\u2705":"\u274c"}),(0,xr.jsx)("span",{className:"message-text",children:c||i}),(0,xr.jsx)("button",{className:"message-close",onClick:()=>{f(!1),u()},title:"Cerrar mensaje",children:"\xd7"})]})})]}):null},Mr=e=>{let{missingFields:t,currentRole:n,onDismiss:r}=e;const a=me();return(0,xr.jsxs)("section",{className:"profile-incomplete-notification","aria-label":"Aviso de perfil incompleto","aria-live":"polite",children:[r&&(0,xr.jsx)("button",{type:"button",className:"btn-dismiss btn-dismiss-floating","aria-label":"Cerrar aviso de perfil incompleto",onClick:r,children:"\xd7"}),(0,xr.jsxs)("div",{className:"notification-content",children:[(0,xr.jsxs)("div",{className:"notification-text",children:[(0,xr.jsx)("h3",{children:"Perfil Incompleto"}),(0,xr.jsx)("p",{children:"Por favor completa tu perfil para aprovechar todas las funcionalidades."})]}),(0,xr.jsx)("div",{className:"notification-actions",children:(0,xr.jsx)("button",{className:"btn-complete-profile",onClick:()=>{a("/edit-profile",{state:{currentRole:n}})},type:"button",children:"Completar Perfil"})})]})]})},zr="https://wallet-service.duckdns.org/api";function Fr(e){const t=[e.url,e.sessionUrl,e.session_url,e.checkoutUrl,e.checkout_url,e.redirectUrl,e.redirect_url].filter(Boolean);if(t.length>0)return t[0];for(const n of Object.values(e))if("string"===typeof n&&n.startsWith("http")&&n.includes("stripe.com"))return n;return null}const Hr=class{static getCognitoToken(){return localStorage.getItem("uplearn_cognito_token")}static async checkStudentTokens(e,t){if(e<=0)return{hasEnoughTokens:!0,requiredTokens:e,currentBalance:1/0,role:"STUDENT"};const n=t||this.getCognitoToken();if(!n)throw new Error("No hay token de autenticaci\xf3n");const r=async e=>{const t=await fetch(e,{method:"GET",headers:{Authorization:"Bearer ".concat(n)}});if(!t.ok)throw new Error(String(t.status));return t.json()},a="".concat(zr,"/wallet/student/check/").concat(e),s="".concat(zr,"/wallet/check/student/").concat(e);try{return await r(a)}catch(Is){if("404"===(null===Is||void 0===Is?void 0:Is.message))try{return await r(s)}catch(o){throw new Error("Error verificando tokens del estudiante")}if("500"===(null===Is||void 0===Is?void 0:Is.message))try{return await r(s)}catch(o){throw new Error("Error verificando tokens del estudiante")}throw new Error("Error verificando tokens del estudiante")}}static async createCheckoutSession(e,t){const n=t||this.getCognitoToken();if(!n)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(zr,"/stripe/checkout"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({quantity:e.quantity,name:e.name||"Token",currency:e.currency||"cop"})});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}const r=await t.json(),a=Fr(r);return console.log("[ApiPayment] createCheckoutSession raw response:",r),console.log("[ApiPayment] extracted checkoutUrl:",a),"success"===r.status&&a?i(i({},r),{},{url:a}):r}catch(r){throw console.error("Error creando sesi\xf3n de checkout:",r),r}}static async getStudentBalance(e){const t=e||this.getCognitoToken();if(!t)throw new Error("No hay token de autenticaci\xf3n");try{const e=await fetch("".concat(zr,"/wallet/balance/student"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(!e.ok){const t=await e.text();throw console.error("Error del servidor:",t),new Error(t||"HTTP error! status: ".concat(e.status))}return await e.json()}catch(n){throw console.error("Error obteniendo balance de estudiante:",n),n}}static async getTutorBalance(e){const t=e||this.getCognitoToken();if(!t)throw new Error("No hay token de autenticaci\xf3n");try{const e=await fetch("".concat(zr,"/wallet/balance/tutor"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(!e.ok){const t=await e.text();throw console.error("Error del servidor:",t),new Error(t||"HTTP error! status: ".concat(e.status))}return await e.json()}catch(n){throw console.error("Error obteniendo balance de tutor:",n),n}}static async handlePaymentSuccess(e,t){const n=t||this.getCognitoToken();if(!n)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(zr,"/stripe/webhook/success"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(r){throw console.error("Error procesando pago exitoso:",r),r}}static async confirmPayment(e){if(!e)throw new Error("sessionId requerido");try{const n=await fetch("".concat(zr,"/stripe/confirm-payment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e})}),r=await n.text();let a={};try{a=r?JSON.parse(r):{}}catch(t){}if(!n.ok)throw new Error(a.message||r||"Error HTTP ".concat(n.status));if(!a.success)throw new Error(a.message||"Pago no confirmado por el servidor");return a}catch(Is){if("Failed to fetch"===(null===Is||void 0===Is?void 0:Is.message))throw new Error("No se pudo conectar al servicio de pagos para confirmar.");throw Is}}static async transferTokens(e,t,n,r,a){const s=a||this.getCognitoToken();if(!s)throw new Error("No hay token de autenticaci\xf3n");try{const a=await fetch("".concat(zr,"/wallet/transfer"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({fromUserId:e,toUserId:t,tokens:n,reservationId:r})});if(!a.ok){const e=await a.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(a.status))}return await a.json()}catch(o){throw console.error("Error transfiriendo tokens:",o),o}}static async refundOnCancellation(e,t){const n=t||this.getCognitoToken();if(!n)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(zr,"/wallet/refund"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return t.json()}catch(r){throw console.error("Error procesando cancelaci\xf3n (refund):",r),r}}},Br=[{tokens:10,price:2e4,popular:!1},{tokens:25,price:5e4,popular:!0},{tokens:50,price:1e5,popular:!1},{tokens:100,price:2e5,popular:!1}],Wr=e=>{let{isOpen:t,onClose:n,currentBalance:r,cognitoToken:a}=e;const[s,o]=(0,l.useState)(null),[i,c]=(0,l.useState)(""),[u,d]=(0,l.useState)(!1),[h,p]=(0,l.useState)(null);if(!t)return null;const f=2e3,m=2e3,g=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(e),v=s||parseInt(i,10)||0,y=v*m;return(0,xr.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,xr.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,xr.jsxs)("div",{className:"modal-header",children:[(0,xr.jsxs)("h2",{children:[(0,xr.jsx)("img",{src:"/coin-icon.png",alt:"Moneda",className:"coin-icon"}),"Comprar Tokens"]}),(0,xr.jsx)("button",{className:"close-button",onClick:n,type:"button",children:"\u2715"})]}),(0,xr.jsxs)("div",{className:"modal-body",children:[(0,xr.jsxs)("div",{className:"current-balance",children:[(0,xr.jsx)("span",{className:"balance-label",children:"Balance actual:"}),(0,xr.jsxs)("span",{className:"balance-amount",children:[r," tokens"]})]}),(0,xr.jsxs)("div",{className:"packages-section",children:[(0,xr.jsx)("h3",{children:"Paquetes de tokens"}),(0,xr.jsxs)("p",{className:"conversion-rate",children:["1 Token = ",g(m)," (m\xednimo total ",g(f),")"]}),(0,xr.jsx)("div",{className:"packages-grid",children:Br.map(e=>(0,xr.jsxs)("button",{className:"package-card ".concat(s===e.tokens?"selected":""," ").concat(e.popular?"popular":""),onClick:()=>{return t=e.tokens,o(t),c(""),void p(null);var t},disabled:u,type:"button",children:[e.popular&&(0,xr.jsx)("span",{className:"popular-badge",children:"M\xe1s popular"}),(0,xr.jsxs)("div",{className:"package-tokens",children:[e.tokens," tokens"]}),(0,xr.jsx)("div",{className:"package-price",children:g(e.price)})]},e.tokens))})]}),(0,xr.jsxs)("div",{className:"custom-amount-section",children:[(0,xr.jsx)("h3",{children:"Cantidad personalizada"}),(0,xr.jsxs)("div",{className:"custom-input-wrapper",children:[(0,xr.jsx)("input",{type:"text",className:"custom-input",placeholder:"Ingresa cantidad de tokens",value:i,onChange:e=>{const t=e.target.value;(""===t||/^\d+$/.test(t))&&(c(t),o(null),p(null))},disabled:u}),(0,xr.jsx)("span",{className:"input-suffix",children:"tokens"})]}),i&&parseInt(i,10)>0&&(0,xr.jsxs)("p",{className:"custom-price",children:["Total: ",g(parseInt(i,10)*m)]})]}),h&&(0,xr.jsxs)("div",{className:"error-message",children:["\u26a0\ufe0f ",h]}),(0,xr.jsx)("div",{className:"purchase-summary",children:v>0&&(0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsxs)("div",{className:"summary-row",children:[(0,xr.jsx)("span",{children:"Tokens a comprar:"}),(0,xr.jsx)("strong",{children:v})]}),(0,xr.jsxs)("div",{className:"summary-row total",children:[(0,xr.jsx)("span",{children:"Total a pagar:"}),(0,xr.jsx)("strong",{children:g(y)})]}),y<f&&(0,xr.jsxs)("div",{className:"summary-row",style:{color:"#dc2626"},children:[(0,xr.jsx)("span",{children:"Falta para m\xednimo:"}),(0,xr.jsx)("strong",{children:g(f-y)})]})]})})]}),(0,xr.jsxs)("div",{className:"modal-footer",children:[(0,xr.jsx)("button",{className:"btn-secondary",onClick:n,disabled:u,type:"button",children:"Cancelar"}),(0,xr.jsx)("button",{className:"btn-primary",onClick:()=>{const e=s||parseInt(i,10);!e||e<=0?p("Por favor selecciona un paquete o ingresa una cantidad v\xe1lida"):e>1e3?p("La cantidad m\xe1xima es 1000 tokens"):(async e=>{d(!0),p(null);try{const t=e*m;if(t<f){const e=f-t;return p("El total debe ser \u2265 ".concat(f," COP. Faltan ").concat(e," COP.")),void d(!1)}const n={quantity:e,name:"Token",currency:"cop"},r=await Hr.createCheckoutSession(n,a);console.log("[BuyTokensModal] checkout response:",r);const s=Fr(r);if("success"===r.status&&s)return void(window.location.href=s);if("success"===r.status&&!s)throw new Error("Respuesta exitosa sin URL. Claves recibidas: ".concat(Object.keys(r).join(", ")));throw new Error(r.message||"Error desconocido del backend de pagos")}catch(t){console.error("Error al crear sesi\xf3n de pago:",t),p(t instanceof Error?t.message:"Error al procesar la compra"),d(!1)}})(e)},disabled:u||v<=0,type:"button",children:u?"\u23f3 Procesando...":"\ud83d\udd12 Pagar con Stripe"})]}),(0,xr.jsxs)("div",{className:"payment-info",children:[(0,xr.jsx)("p",{children:"\ud83d\udd12 Pago seguro procesado por Stripe"}),(0,xr.jsx)("p",{children:"Los tokens se agregar\xe1n a tu cuenta despu\xe9s del pago exitoso"}),(0,xr.jsxs)("p",{style:{fontSize:"12px",color:"#6b7280"},children:["Cantidad seleccionada: ",v]})]})]})})};function Vr(e,t){switch(t){case"dashboard":e("/student-dashboard");break;case"find-tutors":e("/student-finds-tutors");break;case"my-reservations":e("/student-reservations");break;case"my-tasks":e("/student/tasks");break;case"post-task":e("/student/tasks/new")}}function qr(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function Kr(e,t){const n=new Date(e+"T00:00:00");return n.setDate(n.getDate()+t),qr(n)}function $r(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}const Jr=e=>{var t,n;let{currentUser:r,activeSection:a="none",onSectionChange:s=()=>{},tokenBalance:o=0,onBuyTokensClick:i=()=>{}}=e;const c=me(),u=dr(),[d,h]=(0,l.useState)(!1);return(0,xr.jsx)("header",{className:"dashboard-header",children:(0,xr.jsxs)("div",{className:"header-content",children:[(0,xr.jsx)("div",{className:"logo",children:(0,xr.jsx)("h2",{children:"UpLearn Student"})}),(0,xr.jsxs)("nav",{className:"main-nav",children:[(0,xr.jsxs)("button",{className:"nav-item ".concat("dashboard"===a?"active":""),onClick:()=>s("dashboard"),type:"button",children:[(0,xr.jsx)("span",{children:"\ud83d\udcca"})," Dashboard"]}),(0,xr.jsxs)("button",{className:"nav-item ".concat("find-tutors"===a?"active":""),onClick:()=>s("find-tutors"),type:"button",children:[(0,xr.jsx)("span",{children:"\ud83d\udd0d"})," Buscar Tutores"]}),(0,xr.jsxs)("button",{className:"nav-item ".concat("my-reservations"===a?"active":""),onClick:()=>s("my-reservations"),type:"button",children:[(0,xr.jsx)("span",{children:"\ud83d\uddd3\ufe0f"})," Mis Reservas"]}),(0,xr.jsxs)("button",{className:"nav-item ".concat("my-tasks"===a?"active":""),onClick:()=>s("my-tasks"),type:"button",children:[(0,xr.jsx)("span",{children:"\ud83d\udccb"})," Mis Tareas"]}),(0,xr.jsxs)("button",{className:"nav-item ".concat("post-task"===a?"active":""),onClick:()=>s("post-task"),type:"button",children:[(0,xr.jsx)("span",{children:"\u2795"})," Publicar Tarea"]})]}),(0,xr.jsxs)("div",{className:"header-actions",style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,xr.jsxs)("div",{className:"token-display",onClick:i,style:{cursor:"pointer"},children:[(0,xr.jsx)("img",{src:"/coin-icon.png",alt:"Moneda",className:"token-icon",style:{width:"24px",height:"24px",objectFit:"contain"}}),(0,xr.jsx)("span",{className:"token-amount",children:o}),(0,xr.jsx)("span",{className:"token-label",children:"tokens"})]}),(0,xr.jsxs)("div",{className:"user-menu-container",children:[(0,xr.jsxs)("button",{className:"user-avatar",onClick:()=>h(!d),type:"button",children:[(0,xr.jsx)("span",{className:"avatar-icon",children:"\ud83d\udc64"}),(0,xr.jsx)("span",{className:"user-name",children:null!==(t=null===r||void 0===r?void 0:r.name)&&void 0!==t?t:"Usuario"}),(0,xr.jsx)("span",{className:"dropdown-arrow",children:"\u25bc"})]}),d&&(0,xr.jsxs)("div",{className:"user-dropdown",children:[(0,xr.jsxs)("div",{className:"user-info",children:[(0,xr.jsx)("p",{className:"user-email",children:null!==(n=null===r||void 0===r?void 0:r.email)&&void 0!==n?n:"No email"}),(0,xr.jsxs)("p",{className:"user-role",children:["Estudiante",null!==r&&void 0!==r&&r.educationLevel?" - ".concat(r.educationLevel):""]})]}),(0,xr.jsx)("div",{className:"dropdown-divider"}),(0,xr.jsxs)("button",{className:"dropdown-item",onClick:()=>{c("/edit-profile",{state:{currentRole:"student"}})},type:"button",children:[(0,xr.jsx)("span",{children:"\u270f\ufe0f"})," Editar Perfil"]}),(0,xr.jsx)(Ur,{currentRole:"student",asMenuItem:!0}),(0,xr.jsx)(Or,{currentRole:"student",asMenuItem:!0}),(0,xr.jsxs)("button",{className:"dropdown-item logout",onClick:async()=>{u.removeUser();globalThis.location.href="".concat("https://us-east-18mvprkbvu.auth.us-east-1.amazoncognito.com","/logout?client_id=").concat("342s18a96gl2pbaroorqh316l8","&logout_uri=").concat(encodeURIComponent("http://localhost:3000"))},type:"button",children:[(0,xr.jsx)("span",{children:"\ud83d\udeaa"})," Cerrar Sesi\xf3n"]})]})]})]})]})})},Qr=e=>{let{tasks:t,setTasks:n}=e;const[r,a]=(0,l.useState)({title:"",description:"",subject:"",dueDate:"",priority:"medium"});return(0,xr.jsx)("div",{className:"task-form-container",children:(0,xr.jsxs)("div",{className:"task-form",children:[(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"task-title",children:"T\xedtulo"}),(0,xr.jsx)("input",{id:"task-title",type:"text",value:r.title,onChange:e=>a(i(i({},r),{},{title:e.target.value})),placeholder:"Ej: Ayuda con c\xe1lculo",className:"form-input"})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"task-description",children:"Descripci\xf3n"}),(0,xr.jsx)("textarea",{id:"task-description",value:r.description,onChange:e=>a(i(i({},r),{},{description:e.target.value})),placeholder:"Describe lo que necesitas...",className:"form-textarea",rows:4})]}),(0,xr.jsxs)("div",{className:"form-row",children:[(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"task-subject",children:"Materia"}),(0,xr.jsxs)("select",{id:"task-subject",value:r.subject,onChange:e=>a(i(i({},r),{},{subject:e.target.value})),className:"form-select",children:[(0,xr.jsx)("option",{value:"",children:"Seleccionar materia"}),["Matem\xe1ticas","F\xedsica","Qu\xedmica","Programaci\xf3n","Ingl\xe9s","Historia","Biolog\xeda"].map(e=>(0,xr.jsx)("option",{value:e,children:e},e))]})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"task-due-date",children:"Fecha L\xedmite"}),(0,xr.jsx)("input",{id:"task-due-date",type:"date",value:r.dueDate,onChange:e=>a(i(i({},r),{},{dueDate:e.target.value})),className:"form-input"})]})]}),(0,xr.jsxs)("fieldset",{className:"form-group",children:[(0,xr.jsx)("legend",{children:"Prioridad"}),(0,xr.jsx)("div",{className:"priority-options",children:["low","medium","high"].map(e=>(0,xr.jsxs)("label",{className:"priority-option",htmlFor:"priority-".concat(e),children:[(0,xr.jsx)("input",{id:"priority-".concat(e),type:"radio",name:"priority",value:e,checked:r.priority===e,onChange:e=>a(i(i({},r),{},{priority:e.target.value}))}),(0,xr.jsx)("span",{className:"priority-label",children:e.charAt(0).toUpperCase()+e.slice(1)})]},e))})]}),(0,xr.jsxs)("div",{className:"form-actions",children:[(0,xr.jsx)("button",{className:"btn-primary btn-large",onClick:()=>{if(r.title&&r.description&&r.subject){const e=i(i({id:Date.now().toString()},r),{},{status:"pending"});n(t=>[...t,e]),a({title:"",description:"",subject:"",dueDate:"",priority:"medium"}),alert("Tarea publicada exitosamente!")}},type:"button",children:"Publicar Tarea"}),(0,xr.jsx)("button",{className:"btn-secondary",onClick:()=>a({title:"",description:"",subject:"",dueDate:"",priority:"medium"}),type:"button",children:"Limpiar"})]})]})})},Gr=()=>{var e;const t=me(),n=he(),r=dr(),[a,s]=(0,l.useState)(void 0);(0,l.useEffect)(()=>{var e,t,n;r.isAuthenticated&&r.user?s(null!==(e=null===(t=r.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=r.user)||void 0===n?void 0:n.access_token):s(void 0)},[r.isAuthenticated,r.user]);const{userRoles:o,isAuthenticated:i,needsRoleSelection:c}=wr(),{isProfileComplete:u,missingFields:d}=kr(),[h,p]=(0,l.useState)(!0),[f,m]=(0,l.useState)(null),[g,v]=(0,l.useState)("dashboard"),[y,b]=(0,l.useState)(0),[w,x]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(!a)return;const e=async()=>{try{const e=await Hr.getStudentBalance(a);b(e.tokenBalance)}catch(e){console.error("Error cargando balance de tokens:",e),b(0)}};e();const t=setInterval(e,3e4),n=()=>{e()};return globalThis.addEventListener("tokens:refresh",n),()=>{clearInterval(t),globalThis.removeEventListener("tokens:refresh",n)}},[a]),(0,l.useEffect)(()=>{const e=new URLSearchParams(n.search).get("section");e&&e!==g&&v(e)},[n.search]),(0,l.useEffect)(()=>{var e,n,a,s;null!==i&&null!==o&&(i?c?t("/role-selection"):null!==o&&void 0!==o&&o.includes("student")?r.user&&m({userId:(null===(e=r.user.profile)||void 0===e?void 0:e.sub)||"unknown",name:(null===(n=r.user.profile)||void 0===n?void 0:n.name)||(null===(a=r.user.profile)||void 0===a?void 0:a.nickname)||"Usuario",email:(null===(s=r.user.profile)||void 0===s?void 0:s.email)||"No email",role:"student"}):t("/"):t("/login"))},[i,o,c,t,r.user]);const[S,k]=(0,l.useState)([{id:"1",title:"Tarea de C\xe1lculo",description:"Resolver ejercicios de derivadas",subject:"Matem\xe1ticas",dueDate:"2025-10-01",priority:"high",status:"pending"},{id:"2",title:"Proyecto de Programaci\xf3n",description:"Crear una aplicaci\xf3n web con React",subject:"Programaci\xf3n",dueDate:"2025-10-05",priority:"medium",status:"in_progress"}]),[_]=(0,l.useState)(()=>function(e){const t=new Date(e+"T00:00:00"),n=t.getDay(),r=(0===n?-6:1)-n;return t.setDate(t.getDate()+r),qr(t)}(qr(new Date))),[j,N]=(0,l.useState)([]);(0,l.useEffect)(()=>{a&&(async()=>{const e=Kr(_,-35),t=Kr(_,35);try{const n=await Ir(e,t,a);N(n)}catch(n){N([])}})()},[a,_]);const E=(0,l.useMemo)(()=>j.filter(e=>"CANCELADO"!==e.status&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return new Date("".concat(e.date,"T").concat($r(e.end))).getTime()>=t.getTime()}(e)).length,[j]),C=(0,l.useMemo)(()=>{const e=new Set;for(const t of j)t.tutorId&&e.add(t.tutorId);return e.size},[j]);if(r.isLoading)return(0,xr.jsx)("div",{className:"full-center",children:"\u23f3 Verificando acceso..."});if(!f)return(0,xr.jsx)("div",{className:"full-center",children:"\ud83d\udd0d Cargando informaci\xf3n..."});return(0,xr.jsxs)("div",{className:"dashboard-container",children:[!u&&d&&h&&(0,xr.jsx)(Mr,{missingFields:d,currentRole:"student",onDismiss:()=>p(!1)}),(0,xr.jsx)(Wr,{isOpen:w,onClose:()=>x(!1),currentBalance:y,cognitoToken:a}),(0,xr.jsx)(Jr,{currentUser:f,activeSection:g,onSectionChange:e=>{"dashboard"!==e?Vr(t,e):v(e)},tokenBalance:y,onBuyTokensClick:()=>x(!0)}),(0,xr.jsxs)("main",{className:"dashboard-main",children:["dashboard"===g&&(0,xr.jsxs)("div",{className:"dashboard-content",children:[(0,xr.jsxs)("h1",{children:["\xa1Bienvenido, ",f.name,"! \ud83d\udc4b"]}),(0,xr.jsxs)("div",{className:"stats-grid",children:[(0,xr.jsxs)("button",{type:"button",className:"stat-card stat-card--action",onClick:()=>v("my-tasks"),"aria-label":"Ir a Mis Tareas",children:[(0,xr.jsx)("span",{className:"stat-icon",children:"\ud83d\udcda"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:S.filter(e=>"completed"===e.status).length}),(0,xr.jsx)("p",{children:"Tareas Activas"})]})]}),(0,xr.jsxs)("button",{type:"button",className:"stat-card stat-card--action",onClick:()=>Vr(t,"find-tutors"),"aria-label":"Ir a Mis Reservas",children:[(0,xr.jsx)("div",{className:"stat-icon",children:"\ud83e\uddd1\u200d\ud83c\udfeb"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:C}),(0,xr.jsx)("p",{children:"Tutores Encontrados"})]})]}),(0,xr.jsxs)("button",{type:"button",className:"stat-card stat-card--action",onClick:()=>Vr(t,"my-tasks"),"aria-label":"Ir a Mis Tareas",children:[(0,xr.jsx)("div",{className:"stat-icon",children:"\u2705"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:S.filter(e=>"completed"===e.status).length}),(0,xr.jsx)("p",{children:"Tareas Completadas"})]})]}),(0,xr.jsxs)("button",{onClick:()=>Vr(t,"my-reservations"),className:"stat-card stat-card--action","aria-label":"Ir a Mis Reservas",children:[(0,xr.jsx)("div",{className:"stat-icon",children:"\ud83d\uddd3\ufe0f"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:E}),(0,xr.jsx)("p",{children:"Reservas Pr\xf3ximas"})]})]})]}),(0,xr.jsxs)("div",{className:"recent-activity",children:[(0,xr.jsx)("h2",{children:"Actividad Reciente"}),(0,xr.jsxs)("div",{className:"activity-list",children:[S.length>0&&(0,xr.jsxs)("div",{className:"activity-item",children:[(0,xr.jsx)("span",{className:"activity-icon",children:"\ud83d\udcdd"}),(0,xr.jsxs)("div",{className:"activity-content",children:[(0,xr.jsxs)("p",{children:[(0,xr.jsx)("strong",{children:"Nueva tarea:"})," ",null===(e=S[0])||void 0===e?void 0:e.title]}),(0,xr.jsx)("small",{children:"Hace 2 horas"})]})]}),j.length>0&&(0,xr.jsxs)("div",{className:"activity-item",children:[(0,xr.jsx)("span",{className:"activity-icon",children:"\ud83d\uddd3\ufe0f"}),(0,xr.jsxs)("div",{className:"activity-content",children:[(0,xr.jsxs)("p",{children:[(0,xr.jsx)("strong",{children:"Reserva:"})," ",j[0].date," a las ",$r(j[0].start)]}),(0,xr.jsx)("small",{children:"Ayer"})]})]})]})]})]}),"my-tasks"===g&&(0,xr.jsxs)("div",{className:"tasks-section",children:[(0,xr.jsx)("h1",{children:"Mis Tareas \ud83d\udccb"}),(0,xr.jsx)("div",{className:"tasks-grid",children:S.map(e=>(0,xr.jsxs)("div",{className:"task-card",children:[(0,xr.jsxs)("div",{className:"task-header",children:[(0,xr.jsx)("h3",{children:e.title}),(0,xr.jsxs)("div",{className:"task-meta",children:[(0,xr.jsx)("span",{className:"priority-badge",style:{backgroundColor:{high:"#ef4444",medium:"#f59e0b",low:"#10b981"}[e.priority]},children:e.priority.toUpperCase()}),(0,xr.jsx)("span",{className:"status-badge",style:{color:{completed:"#10b981",in_progress:"#3b82f6",pending:"#6b7280"}[e.status]},children:e.status.replace("_"," ").toUpperCase()})]})]}),(0,xr.jsx)("p",{className:"task-description",children:e.description}),(0,xr.jsxs)("div",{className:"task-details",children:[(0,xr.jsxs)("span",{className:"task-subject",children:["\ud83d\udcda ",e.subject]}),(0,xr.jsxs)("span",{className:"task-due-date",children:["\ud83d\udcc5 ",e.dueDate]})]}),(0,xr.jsxs)("div",{className:"task-actions",children:[(0,xr.jsx)("button",{className:"btn-primary",type:"button",children:"Ver Detalles"}),(0,xr.jsx)("button",{className:"btn-secondary",type:"button",children:"Editar"})]})]},e.id))})]}),"post-task"===g&&(0,xr.jsxs)("div",{className:"post-task-section",children:[(0,xr.jsx)("h1",{children:"Publicar Nueva Tarea \u2795"}),(0,xr.jsx)(Qr,{tasks:S,setTasks:k})]})]})]})};function Yr(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}const Zr=Array.from({length:24},(e,t)=>"".concat(String(t).padStart(2,"0"),":00"));function Xr(e,t){return function(e,t){const[n,r]=Yr(t).split(":").map(Number),a=new Date(e+"T00:00:00");return a.setHours(n,r,0,0),a}(e,Yr(t)).getTime()<function(){const e=new Date;e.setSeconds(0,0);const t=new Date(e);return t.setMinutes(0,0,0),t.setHours(t.getHours()+(e.getMinutes()>0?1:0)),t}().getTime()}function ea(e){const t=(null!==e&&void 0!==e?e:"").toString().toUpperCase();return"DISPONIBLE"===t?"cell available":"PENDIENTE"===t||"ACTIVA"===t?"cell pending":"ACEPTADO"===t||"ACEPTADA"===t?"cell accepted":"CANCELADO"===t||"CANCELADA"===t?"cell canceled":"VENCIDA"===t||"EXPIRED"===t||"INCUMPLIDA"===t||"FINALIZADA"===t?"cell expired":"cell disabled"}const ta=e=>{let{weekStart:t,cells:n,mode:r,selectedKeys:a,onToggle:s,onSinglePick:o}=e;const c=(0,l.useMemo)(()=>Array.from({length:7},(e,n)=>function(e,t){const[n,r,a]=e.split("-").map(Number),s=new Date(Date.UTC(n,r-1,a));return s.setUTCDate(s.getUTCDate()+t),s.toISOString().slice(0,10)}(t,n)),[t]),u=(0,l.useMemo)(()=>{const e={ACEPTADO:5,ACEPTADA:5,PENDIENTE:4,ACTIVA:4,DISPONIBLE:3,CANCELADO:2,CANCELADA:2,INCUMPLIDA:1,FINALIZADA:1,VENCIDA:1,EXPIRED:1},t=t=>{var n;return null!==(n=e[(null!==t&&void 0!==t?t:"").toString().toUpperCase()])&&void 0!==n?n:0},r=new Map;for(const a of n||[]){const e=Yr(a.hour),n="".concat(a.date,"_").concat(e),s=i(i({},a),{},{hour:e}),o=r.get(n);(!o||t(s.status)>=t(o.status))&&r.set(n,s)}return r},[n]),d=(0,l.useRef)(!1),h=(0,l.useRef)(null),p=(0,l.useRef)(new Set),f=()=>{d.current=!1,h.current=null,p.current.clear()};l.useEffect(()=>{const e=()=>{d.current&&f()};return globalThis.addEventListener("mouseup",e),globalThis.addEventListener("touchend",e),()=>{globalThis.removeEventListener("mouseup",e),globalThis.removeEventListener("touchend",e)}},[]);const m=(e,t)=>{var n,i,l;const c="".concat(e,"_").concat(t),m=u.get(c)||{date:e,hour:t,status:null};let g=null!==(n=m.status)&&void 0!==n?n:null;const v=(null!==(i=g)&&void 0!==i?i:"").toString().toUpperCase();!Xr(e,t)||"DISPONIBLE"!==v&&"PENDIENTE"!==v&&"ACTIVA"!==v||(g="VENCIDA");const y=!(null===a||void 0===a||!a.has(c)),b="student"!==r||"DISPONIBLE"===(null!==(l=g)&&void 0!==l?l:"").toString().toUpperCase(),w=[ea(g),y?"selected":"",b?"can-pick":"not-pickable"].join(" ").trim(),x=function(e){const t=(null!==e&&void 0!==e?e:"").toString().toUpperCase();return"DISPONIBLE"===t?"Disponible":"PENDIENTE"===t||"ACTIVA"===t?"Pendiente":"ACEPTADO"===t||"ACEPTADA"===t?"Aceptada":"CANCELADO"===t||"CANCELADA"===t?"Cancelada":"VENCIDA"===t||"EXPIRED"===t?"Vencida":"INCUMPLIDA"===t?"Incumplida":"FINALIZADA"===t?"Finalizada":""}(g);return(0,xr.jsxs)("button",{type:"button",className:w,onMouseDown:e=>{e.preventDefault(),((e,t)=>{if("tutor"!==r||!s)return;d.current=!0,p.current=new Set;const n=(null===a||void 0===a?void 0:a.has(e))||!1;h.current=n?"deselect":"select",p.current.add(e),s(e,t)})(c,m)},onMouseEnter:()=>((e,t)=>{if(!d.current||"tutor"!==r||!s)return;if(p.current.has(e))return;p.current.add(e);const n=(null===a||void 0===a?void 0:a.has(e))||!1;("select"===h.current&&!n||"deselect"===h.current&&n)&&s(e,t)})(c,m),onMouseUp:f,onClick:()=>((e,t)=>{var n;"student"===r&&"DISPONIBLE"===(null!==(n=t.status)&&void 0!==n?n:"").toString().toUpperCase()&&o&&o(t)})(0,m),title:"".concat(e," ").concat(t," ").concat(g||""),style:{cursor:"pointer",userSelect:"none"},children:[x&&(0,xr.jsx)("span",{children:x}),x&&(0,xr.jsx)("span",{className:"dot"})]},c)};return(0,xr.jsx)("fieldset",{className:"calendar-wrapper","aria-label":"Week calendar",children:(0,xr.jsxs)("div",{className:"calendar-grid",children:[(0,xr.jsxs)("div",{className:"col hour-col",children:[(0,xr.jsx)("div",{className:"head-cell",children:"Hora"}),Zr.map(e=>(0,xr.jsx)("div",{className:"hour-cell",children:e},e))]}),c.map((e,t)=>(0,xr.jsxs)("div",{className:"col",children:[(0,xr.jsxs)("div",{className:"head-cell",children:[["Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b","Dom"][t],(0,xr.jsx)("br",{}),e]}),Zr.map(t=>m(e,t))]},e))]})})};function na(e,t){const[n,r,a]=e.split("-").map(Number),s=new Date(Date.UTC(n,r-1,a));return s.setUTCDate(s.getUTCDate()+t),s.toISOString().slice(0,10)}const ra=e=>{const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)};function aa(){const e=new Date;e.setSeconds(0,0);const t=new Date(e);return t.setMinutes(0,0,0),t.setHours(t.getHours()+(e.getMinutes()>0?1:0)),t}function sa(e,t){const n=aa(),r=function(e,t){const[n,r]=t.split(":").map(Number),a=new Date(e+"T00:00:00");return a.setHours(n,r,0,0),a}(e,ra(t));return r.getTime()>=n.getTime()}const oa=()=>{var e,t,n,r,a;const s=dr(),o=null!==(e=null===(t=s.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=s.user)||void 0===n?void 0:n.access_token,c=(null===(r=s.user)||void 0===r||null===(a=r.profile)||void 0===a?void 0:a.sub)||"",[u,d]=(0,l.useState)(()=>function(e){const[t,n,r]=e.split("-").map(Number),a=new Date(Date.UTC(t,n-1,r)),s=a.getUTCDay(),o=(0===s?-6:1)-s;return a.setUTCDate(a.getUTCDate()+o),a.toISOString().slice(0,10)}((new Date).toISOString().slice(0,10))),[h,p]=(0,l.useState)([]),[f,m]=(0,l.useState)(new Set),[g,v]=(0,l.useState)(!1),[y,b]=(0,l.useState)(null),[w,x]=(0,l.useState)("add"),S=(0,l.useCallback)(async()=>{if(c&&o){v(!0);try{const e=await Rr(c,u,o);p(e)}catch(Is){console.error(Is),b("\u274c "+(Is.message||"Error cargando disponibilidad"))}finally{v(!1)}}},[c,u,o]);(0,l.useEffect)(()=>{S()},[S]);const k=(0,l.useMemo)(()=>{const e=new Map;for(const t of h){const n="".concat(t.date,"_").concat(ra(t.hour));e.set(n,t)}return e},[h]),_=()=>{m(new Set),b(null)},j=(0,l.useMemo)(()=>{const e=new Map;return f.forEach(t=>{const[n,r]=t.split("_");if(sa(n,r)){const t=e.get(n)||[];t.push(ra(r)),e.set(n,t)}}),e.forEach(e=>e.sort((e,t)=>e.localeCompare(t))),e},[f]),N=(0,l.useMemo)(()=>h.map(e=>{var t;const n=ra(e.hour),r=((e,t)=>!sa(e,t))(e.date,n),a=(null!==(t=e.status)&&void 0!==t?t:"").toUpperCase();return!r||"DISPONIBLE"!==a&&"PENDIENTE"!==a?e:i(i({},e),{},{status:"EXPIRED"})}),[h]),E=()=>{d(na(u,-7)),m(new Set)},C=()=>{d(na(u,7)),m(new Set)},T=(0,l.useMemo)(()=>aa().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),[u]);return(0,xr.jsxs)("div",{className:"page",style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[(0,xr.jsx)("h1",{style:{marginBottom:"8px"},children:"Mi disponibilidad"}),(0,xr.jsxs)("p",{className:"instruction-text",children:["add"===w?"Haz clic y arrastra para seleccionar horas vac\xedas y agregarlas a tu disponibilidad.":"Haz clic y arrastra para seleccionar horas con disponibilidad existente y eliminarlas.",(0,xr.jsx)("br",{}),(0,xr.jsx)("strong",{children:"Regla:"})," Solo puedes seleccionar horas ",(0,xr.jsxs)("u",{children:["a partir de ",T]}),"."]}),y&&(()=>{let e="#FFF7ED";y.includes("\u2705")?e="#ECFDF5":y.includes("\u274c")&&(e="#FEF2F2");let t="#FED7AA";y.includes("\u2705")?t="#A7F3D0":y.includes("\u274c")&&(t="#FECACA");let n="#92400E";return y.includes("\u2705")?n="#065F46":y.includes("\u274c")&&(n="#991B1B"),(0,xr.jsx)("div",{style:{margin:"12px 0",padding:"12px 16px",background:e,border:"1px solid ".concat(t),borderRadius:"8px",color:n,fontWeight:500},children:y})})(),(0,xr.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"12px",padding:"8px",background:"#F9FAFB",borderRadius:"8px",border:"1px solid #E5E7EB"},children:[(0,xr.jsx)("span",{style:{fontWeight:600,marginRight:"8px",alignSelf:"center"},children:"Modo:"}),(0,xr.jsx)("button",{className:"btn-modern ".concat("add"===w?"btn-primary-modern":"btn-secondary-modern"),onClick:()=>{x("add"),_()},style:{fontSize:"13px",padding:"6px 12px"},children:"\u2795 Agregar disponibilidad"}),(0,xr.jsx)("button",{className:"btn-modern ".concat("delete"===w?"btn-primary-modern":"btn-secondary-modern"),onClick:()=>{x("delete"),_()},style:{fontSize:"13px",padding:"6px 12px"},children:"\ud83d\uddd1\ufe0f Eliminar disponibilidad"})]}),(0,xr.jsxs)("div",{className:"action-buttons",children:[(0,xr.jsx)("button",{className:"btn-modern btn-secondary-modern",onClick:_,disabled:0===f.size,children:"Limpiar selecci\xf3n"}),"add"===w?(0,xr.jsx)("button",{className:"btn-modern btn-primary-modern",onClick:async()=>{if(0===j.size)return void b("\u26a0\ufe0f Selecciona una o m\xe1s horas FUTURAS para agregar.");const e=[];for(const[n,r]of Array.from(j.entries())){const t=r.filter(e=>{const t="".concat(n,"_").concat(e),r=k.get(t);return sa(n,e)&&!("PENDIENTE"===(null===r||void 0===r?void 0:r.status)||"ACEPTADO"===(null===r||void 0===r?void 0:r.status))});t.length&&e.push([n,t])}if(0===e.length)return void b("\u26a0\ufe0f La selecci\xf3n no contiene horas v\xe1lidas para agregar.");const t=e.reduce((e,t)=>{let[,n]=t;return e+n.length},0);if(globalThis.confirm("\xbfAgregar disponibilidad en ".concat(e.length," d\xeda(s) con ").concat(t," hora(s) seleccionada(s)?"))){v(!0);try{let t=0,n=0;const r=[];for(const[a,s]of e)try{t+=(await Dr(a,s,o)).addedCount}catch(Is){n+=s.length,r.push("".concat(a,": ").concat(Is.message||"Error"))}b(0===n?"\u2705 ".concat(t," hora(s) de disponibilidad agregadas correctamente."):t>0?"\u26a0\ufe0f ".concat(t," agregadas, ").concat(n," fallaron.\n").concat(r.join("\n")):"\u274c No se pudo agregar disponibilidad.\n".concat(r.join("\n"))),m(new Set),await new Promise(e=>setTimeout(e,500)),await S()}catch(Is){b("\u274c "+(Is.message||"Error agregando disponibilidad"))}finally{v(!1)}}},disabled:g||0===f.size,children:g?"Agregando...":"\u2713 Confirmar agregar disponibilidad"}):(0,xr.jsx)("button",{className:"btn-modern",onClick:async()=>{if(0===f.size)return void b("\u26a0\ufe0f Selecciona una o m\xe1s horas DISPONIBLES futuras para eliminar.");const e=Array.from(f).map(e=>{const[t,n]=e.split("_");if(!sa(t,n))return null;const r=h.find(e=>e.date===t&&ra(e.hour)===ra(n));return r&&"DISPONIBLE"===r.status?r:null}).filter(Boolean);if(0===e.length)return void b("\u26a0\ufe0f No hay disponibilidad FUTURA para eliminar en la selecci\xf3n.");if(globalThis.confirm("\xbfEliminar ".concat(e.length," hora(s) de disponibilidad?"))){v(!0);try{const t=new Map;for(const n of e){const e=t.get(n.date)||[];e.push(ra(n.hour)),t.set(n.date,e)}for(const[e,n]of Array.from(t.entries())){const t=h.filter(t=>t.date===e&&"DISPONIBLE"===t.status).map(e=>ra(e.hour)).filter(e=>!n.includes(e));if(t.length>0){const n=await fetch("https://reservations-service.duckdns.org/api/availability/day/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({hours:t})});if(!n.ok)throw new Error(await n.text())}else await Lr(e,o)}b("\u2705 ".concat(e.length," hora(s) eliminada(s) correctamente.")),m(new Set),await new Promise(e=>setTimeout(e,500)),await S()}catch(Is){b("\u274c "+((null===Is||void 0===Is?void 0:Is.message)||"Error eliminando disponibilidad"))}finally{v(!1)}}},disabled:g||0===f.size,style:{background:"#EF4444",color:"white",border:"none"},children:g?"Eliminando...":"\ud83d\uddd1\ufe0f Confirmar eliminar disponibilidad"})]}),(0,xr.jsxs)("div",{className:"week-nav",style:{marginBottom:"16px"},children:[(0,xr.jsx)("button",{className:"btn-ghost",onClick:E,children:"\u25c0 Semana anterior"}),(0,xr.jsxs)("div",{className:"week-nav__title",children:["Semana ",u," \u2014 ",na(u,6)]}),(0,xr.jsx)("button",{className:"btn-ghost",onClick:C,children:"Siguiente semana \u25b6"})]}),g&&(0,xr.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:"\u23f3 Cargando..."}),(0,xr.jsx)(ta,{weekStart:u,cells:N,mode:"tutor",selectedKeys:f,onToggle:e=>{const[t,n]=e.split("_");if(!sa(t,n))return void b("\u26a0\ufe0f No puedes seleccionar horas en el pasado. Solo a partir de ".concat(aa().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),"."));const r=k.get(e);"add"!==w||"PENDIENTE"!==(null===r||void 0===r?void 0:r.status)&&"ACEPTADO"!==(null===r||void 0===r?void 0:r.status)?"delete"!==w||"DISPONIBLE"===(null===r||void 0===r?void 0:r.status)?m(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}):b("\u26a0\ufe0f Solo puedes eliminar disponibilidad existente (DISPONIBLE) en futuro."):b("\u26a0\ufe0f Esa hora ya est\xe1 reservada.")},onPrevWeek:E,onNextWeek:C}),(0,xr.jsxs)("div",{style:{marginTop:"20px",padding:"12px",background:"#F3F4F6",borderRadius:"8px",fontSize:"12px"},children:[(0,xr.jsx)("strong",{children:"Debug:"})," ",N.length," celdas cargadas para semana ",u]})]})},ia="https://chats-cbh7cgfxa4ceahde.canadacentral-01.azurewebsites.net".replace(/\/$/,"");async function la(e,t){if(!((n=t)&&"string"===typeof n&&n.split(".").length>=3&&n.trim().length>20))throw new Error("UNAUTHORIZED_EAGER");var n;const r=await fetch(e,{headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"},cache:"no-store"});if(401===r.status)throw new Error("UNAUTHORIZED");if(!r.ok)throw new Error("HTTP_".concat(r.status));return r.json()}async function ca(e,t){return(await la("".concat(ia,"/api/chat/chat-id/with/").concat(encodeURIComponent(e)),t)).chatId}async function ua(e,t){return la("".concat(ia,"/api/chat/history/").concat(encodeURIComponent(e)),t)}async function da(e,t){const[n,r]=[e,t].sort((e,t)=>e.localeCompare(t)),a="".concat(n,":").concat(r);try{const e=(new TextEncoder).encode(a);return function(e){const t=new Uint8Array(e);let n="";for(let r=0;r<t.length;r++)n+=(t[r]<16?"0":"")+t[r].toString(16);return n}(await crypto.subtle.digest("SHA-256",e))}catch(s){return a}}class ha{constructor(e){this.ws=null,this.token=null,this.onMessage=()=>{},this.onState=()=>{},this.timers={ping:0,reconnect:0},this.cfg=void 0,this.outbox=[],this.cfg=i({autoReconnect:!0,pingIntervalMs:2e4},e)}connect(e,t,n){this.token=e,this.onMessage=t,this.onState=n||this.onState;const r="".concat(ia.replace(/^http/,"ws")+"/ws/chat","?token=").concat(encodeURIComponent(e));this.onState("connecting"),this.ws=new WebSocket(r),this.ws.onopen=()=>{this.onState("open");for(const n of this.outbox.splice(0))try{var e;null===(e=this.ws)||void 0===e||e.send(JSON.stringify(n))}catch(t){}this.startPing()},this.ws.onmessage=e=>{try{this.onMessage(JSON.parse(e.data))}catch(t){this.onMessage(e.data)}},this.ws.onerror=()=>{this.onState("error")},this.ws.onclose=()=>{this.onState("closed"),this.stopPing(),this.cfg.autoReconnect&&this.token&&(clearTimeout(this.timers.reconnect),this.timers.reconnect=setTimeout(()=>this.connect(this.token,this.onMessage,this.onState),1200))}}disconnect(){this.cfg.autoReconnect=!1,this.stopPing();try{var e;null===(e=this.ws)||void 0===e||e.close()}catch(t){}this.ws=null,this.outbox=[]}sendMessage(e,t,n){const r={toUserId:e,content:t};n&&(r.chatId=n),this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(r)):this.outbox.push(r)}startPing(){this.stopPing(),this.timers.ping=setInterval(()=>{this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:"ping",ts:Date.now()}))},this.cfg.pingIntervalMs)}stopPing(){clearInterval(this.timers.ping)}}function pa(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function fa(e){let t;if("string"===typeof e){const n=10===e.length?"T00:00:00":"";t=new Date(e+n)}else t=e;return t.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}function ma(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}function ga(e){const t=new Date,n=new Date("".concat(e.date,"T").concat(ma(e.start))).getTime(),r=new Date("".concat(e.date,"T").concat(ma(e.end))).getTime(),a=t.getTime(),s=(e.status||"").toUpperCase();return"CANCELADO"===s?"CANCELADO":"FINALIZADA"===s?"FINALIZADA":"INCUMPLIDA"===s?"INCUMPLIDA":"PENDIENTE"===s?a>r?"VENCIDA":"PENDIENTE":"ACEPTADO"===s?a>=n&&a<=r?"ACTIVA":a>r?!1===e.attended?"INCUMPLIDA":"FINALIZADA":"ACEPTADO":s||"DESCONOCIDO"}const va=(e,t)=>{var n,r,a,s,o,i,l,c,u,d,h,p,f,m,g;return{id:String(null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:ya()),chatId:String(null!==(r=null===e||void 0===e?void 0:e.chatId)&&void 0!==r?r:t),fromUserId:String(null!==(a=null!==(s=null!==(o=null!==(i=null===e||void 0===e?void 0:e.fromUserId)&&void 0!==i?i:null===e||void 0===e?void 0:e.senderId)&&void 0!==o?o:null===e||void 0===e?void 0:e.from)&&void 0!==s?s:null===e||void 0===e?void 0:e.userId)&&void 0!==a?a:""),toUserId:String(null!==(l=null!==(c=null!==(u=null===e||void 0===e?void 0:e.toUserId)&&void 0!==u?u:null===e||void 0===e?void 0:e.recipientId)&&void 0!==c?c:null===e||void 0===e?void 0:e.to)&&void 0!==l?l:""),content:String(null!==(d=null!==(h=null===e||void 0===e?void 0:e.content)&&void 0!==h?h:null===e||void 0===e?void 0:e.text)&&void 0!==d?d:""),createdAt:String(null!==(p=null!==(f=null===e||void 0===e?void 0:e.createdAt)&&void 0!==f?f:null===e||void 0===e?void 0:e.timestamp)&&void 0!==p?p:(new Date).toISOString()),delivered:Boolean(null!==(m=null===e||void 0===e?void 0:e.delivered)&&void 0!==m&&m),read:Boolean(null!==(g=null===e||void 0===e?void 0:e.read)&&void 0!==g&&g)}};function ya(){try{return crypto.getRandomValues(new Uint32Array(4)).join("-")}catch(e){return"".concat(Date.now(),"-").concat(Math.random())}}const ba=e=>{let{message:t,isMine:n}=e;const r=n?"chat-bubble mine":"chat-bubble theirs",a=function(e){if(e&&"object"===typeof e){var t,n;const r=e;return null!==(t=null!==(n=r.createdAt)&&void 0!==n?n:r.timestamp)&&void 0!==t?t:(new Date).toISOString()}return(new Date).toISOString()}(t);return(0,xr.jsxs)("div",{className:r,children:[(0,xr.jsx)("p",{children:t.content}),(0,xr.jsx)("span",{className:"timestamp",children:new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},wa=e=>{let{contact:t,myUserId:n,token:r,onClose:a}=e;const[s,o]=(0,l.useState)([]),[i,c]=(0,l.useState)(""),[u,d]=(0,l.useState)(""),h=(0,l.useRef)(null),p=(0,l.useRef)(null),f=(0,l.useRef)(null),m=(0,l.useRef)(0),g=(0,l.useRef)(!1),v=e=>{const t=Date.now();if("connecting"===e&&"connecting"===f.current)return;"closed"===e&&"connecting"===f.current&&t-m.current<500||(console.log("Socket state: ".concat(e)),f.current=e,m.current=t,"closed"!==e&&"error"!==e||g.current||(g.current=!0,a()))};(0,l.useEffect)(()=>(p.current=new ha,p.current.connect(r,e=>{const t=e&&"string"===typeof e.data?JSON.parse(e.data):e,n=va(t,u||"unknown");u&&n.chatId!==u||o(e=>[...e,n])},v),()=>{var e;null===(e=p.current)||void 0===e||e.disconnect(),p.current=null}),[r]),(0,l.useEffect)(()=>{let e=!0;return(async()=>{let a="";try{a=await ca(t.id,r)}catch(s){a=await da(n,t.id),console.warn("getChatIdWith fall\xf3. Usando chatId local (sha256):",a)}if(e){d(a);try{const t=await ua(a,r);if(!e)return;o(t.map(e=>va(e,a||"unknown")))}catch(Is){if(console.error("Error cargando historial:",Is),!e)return;o([])}}})(),()=>{e=!1}},[t.id,n,r]),(0,l.useEffect)(()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[s]);return(0,xr.jsxs)("div",{className:"chat-side-panel",children:[(0,xr.jsxs)("div",{className:"chat-window-header",children:[(0,xr.jsx)("h4",{children:t.name}),(0,xr.jsx)("button",{onClick:a,className:"close-chat-btn",children:"\xd7"})]}),(0,xr.jsxs)("div",{className:"chat-messages",children:[s.map(e=>(0,xr.jsx)(ba,{message:e,isMine:e.fromUserId===n},e.id)),(0,xr.jsx)("div",{ref:h})]}),(0,xr.jsxs)("form",{className:"chat-input-form",onSubmit:e=>{var n;e.preventDefault(),i.trim()&&(null===(n=p.current)||void 0===n||n.sendMessage(t.id,i),c(""))},children:[(0,xr.jsx)("input",{value:i,onChange:e=>c(e.target.value),placeholder:"Escribe un mensaje..."}),(0,xr.jsx)("button",{type:"submit",children:"Enviar"})]})]})},xa=jr.USERS_BASE,Sa=jr.USERS_PROFILE_PATH;const ka=()=>{var e,t,n,r;const a=dr(),s=null!==(e=null===(t=a.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=a.user)||void 0===n?void 0:n.access_token,o=null===(r=a.user)||void 0===r?void 0:r.profile.sub,[c,u]=(0,l.useState)([]),[d,h]=(0,l.useState)(!1),[p,f]=(0,l.useState)(null),[m,g]=(0,l.useState)("all"),[v,y]=(0,l.useState)(""),[b,w]=(0,l.useState)(!1),[x,S]=(0,l.useState)({}),[k,_]=(0,l.useState)(1),[j,N]=(0,l.useState)(5),[E,C]=(0,l.useState)(null),T=(0,l.useRef)(new Set),I=e=>(e||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),P=(0,l.useCallback)(async()=>{if(s){h(!0);try{const e=new Date;e.setDate(e.getDate()-30);const t=new Date;t.setDate(t.getDate()+60);const n=pa(e),r=pa(t),a=await Pr(n,r,s);u(a.filter(e=>"CANCELADO"!==e.status))}catch(Is){f("\u274c "+(Is.message||"Error cargando clases"))}finally{h(!1)}}},[s]);(0,l.useEffect)(()=>{P()},[P]);const A=async(e,t)=>{if(s&&o)try{await async function(e,t,n){const r="".concat(Nr,"/api/reservations/").concat(e,"/accept"),a=t?JSON.stringify({studentId:t}):void 0;return Cr(await fetch(r,{method:"PATCH",headers:Er(n),body:a}))}(e,t,s);let n=1;try{const e=await fr.getTutorTokensRate(s),t=Number(null===e||void 0===e?void 0:e.tokensPerHour);!Number.isNaN(t)&&t>0&&(n=t)}catch(Is){console.warn("No se pudo obtener tokensPerHour, usando 1 por defecto. Detalle:",Is)}await Hr.transferTokens(t,o,n,e,s),f("\u2705 Clase aceptada y tokens transferidos");try{await Hr.getTutorBalance(s);globalThis.dispatchEvent(new CustomEvent("tokens:refresh"))}catch(Is){console.warn("No se pudo refrescar balance tras aceptaci\xf3n:",Is)}await P()}catch(Is){f("\u274c "+(Is.message||"Error al aceptar"))}},R=e=>({PENDIENTE:"#F59E0B",ACEPTADO:"#10B981",ACTIVA:"#6366F1",FINALIZADA:"#0EA5E9",INCUMPLIDA:"#F97316",VENCIDA:"#9CA3AF"}[String(e||"").toUpperCase()]||"#6B7280"),D=(0,l.useMemo)(()=>c.map(e=>i(i({},e),{},{effectiveStatus:ga(e)})).filter(e=>{if("all"!==m&&e.effectiveStatus!==m)return!1;if(!b){return new Date("".concat(e.date,"T").concat(ma(e.end))).getTime()>=Date.now()}return!0}).sort((e,t)=>new Date("".concat(e.date,"T").concat(e.start)).getTime()-new Date("".concat(t.date,"T").concat(t.start)).getTime()),[c,m,b]);(0,l.useEffect)(()=>{if(!s)return;const e=Array.from(new Set(c.map(e=>e.studentId).filter(Boolean))).filter(e=>!x[e]&&!T.current.has(e));if(0!==e.length){for(const t of e)T.current.add(t);(async()=>{const t={},n=await Promise.allSettled(e.map(async e=>{const t=await async function(e,t,n,r){const a={Accept:"application/json"};r&&(a.Authorization="Bearer ".concat(r));const s=async r=>{const s="".concat(e).concat(t,"?").concat(r,"=").concat(encodeURIComponent(n)),o=await fetch(s,{headers:a});return o.ok?{ok:!0,raw:await o.json()}:{ok:!1,status:o.status}};let o=await s("id");if(o.ok||(o=await s("sub")),!o.ok)throw Object.assign(new Error("PROFILE_FETCH_FAILED"),{status:o.status});return o.raw}(xa,Sa,e,s);return{id:e,prof:t}}));for(const e of n)if("fulfilled"===e.status){var r;const n=e.value.id,a=e.value.prof;t[n]={id:n,sub:null!==(r=null===a||void 0===a?void 0:a.sub)&&void 0!==r?r:n,name:(null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.fullName)||"Estudiante",email:(null===a||void 0===a?void 0:a.email)||"N/A",avatarUrl:null===a||void 0===a?void 0:a.avatarUrl}}else{var a;const n=(null===(a=e.reason)||void 0===a?void 0:a.id)||"unknown";t[n]={id:n,sub:n,name:"Estudiante",email:"N/A"}}Object.keys(t).length>0&&S(e=>i(i({},e),t))})()}},[c,x,s]);const L=(0,l.useMemo)(()=>{const e={};for(const t of D){const n=t.studentId,r=x[n],a=t.studentName||(null===r||void 0===r?void 0:r.name)||"Estudiante",s=t.studentAvatar||(null===r||void 0===r?void 0:r.avatarUrl);e[n]||(e[n]={studentId:n,studentName:a,studentAvatar:s,reservations:[]}),e[n].reservations.push(t)}return Object.values(e).sort((e,t)=>e.studentName.localeCompare(t.studentName,"es"))},[D,x]),O=(0,l.useMemo)(()=>{if(!v.trim())return L;const e=I(v);return L.filter(t=>I(t.studentName).includes(e))},[L,v]),U=Math.max(1,Math.ceil(O.length/j)),M=Math.min(k,U),z=O.slice((M-1)*j,M*j);return(0,l.useEffect)(()=>{_(1)},[m,v,j,b]),(0,xr.jsxs)("div",{className:"page-with-chat-container",children:[(0,xr.jsxs)("div",{className:"main-content ".concat(E?"chat-open":""),children:[(0,xr.jsx)("h1",{style:{marginBottom:8},children:"Solicitudes"}),p&&(0,xr.jsx)("output",{className:"status-message","aria-live":"polite",children:p}),(0,xr.jsx)("div",{className:"filters-card",children:(0,xr.jsxs)("div",{className:"filters-row",children:[(0,xr.jsxs)("div",{className:"search-input",children:[(0,xr.jsx)("input",{placeholder:"Buscar estudiante\u2026",value:v,onChange:e=>y(e.target.value)}),(0,xr.jsx)("span",{className:"search-icon",children:"\ud83d\udd0e"})]}),(0,xr.jsxs)("select",{className:"status-select",value:m,onChange:e=>g(e.target.value),children:[(0,xr.jsx)("option",{value:"all",children:"Todos"}),(0,xr.jsx)("option",{value:"PENDIENTE",children:"Pendiente"}),(0,xr.jsx)("option",{value:"ACEPTADO",children:"Aceptado"}),(0,xr.jsx)("option",{value:"ACTIVA",children:"Activa"}),(0,xr.jsx)("option",{value:"FINALIZADA",children:"Finalizada"}),(0,xr.jsx)("option",{value:"INCUMPLIDA",children:"Incumplida"}),(0,xr.jsx)("option",{value:"VENCIDA",children:"Vencida"})]}),(0,xr.jsxs)("label",{className:"past-toggle",children:[(0,xr.jsx)("input",{type:"checkbox",checked:b,onChange:e=>w(e.target.checked)}),(0,xr.jsx)("span",{children:"Mostrar pasadas"})]})]})}),d&&(0,xr.jsx)("p",{children:"Cargando\u2026"}),!d&&0===z.length&&(0,xr.jsx)("p",{children:"No hay solicitudes."}),z.map(e=>(0,xr.jsxs)("div",{className:"student-group-card",children:[(0,xr.jsxs)("div",{className:"student-group-header",children:[e.studentAvatar?(0,xr.jsx)("img",{src:e.studentAvatar,alt:e.studentName}):(0,xr.jsx)("div",{className:"avatar-neutral","aria-hidden":"true"}),(0,xr.jsx)("h3",{children:e.studentName})]}),(0,xr.jsx)("div",{className:"reservations-container",children:e.reservations.map(t=>{const n=t.effectiveStatus,r="PENDIENTE"===n,a=(new Date("".concat(t.date,"T").concat(ma(t.start))).getTime()-Date.now())/36e5,i=("PENDIENTE"===n||"ACEPTADO"===n)&&a>=12,l="ACEPTADO"===n||"INCUMPLIDA"===n;return(0,xr.jsxs)("div",{className:"reservation-row",children:[(0,xr.jsxs)("div",{className:"reservation-info",children:[(0,xr.jsxs)("p",{className:"reservation-datetime",children:["\ud83d\udcc5 ",fa(t.date)," \u2022 \ud83d\udd50 ",ma(t.start)," - ",ma(t.end)]}),(0,xr.jsxs)("p",{className:"reservation-id",children:["ID: ",String(t.id).slice(0,8),"..."]})]}),(0,xr.jsx)("div",{className:"reservation-meta",children:(0,xr.jsx)("span",{className:"status-badge",style:{backgroundColor:"".concat(R(n),"20"),color:R(n)},children:(c=n,(c||"").toUpperCase()||"\u2014")})}),(0,xr.jsxs)("div",{className:"reservation-actions",children:[(0,xr.jsx)("button",{className:"btn-action btn-accept",onClick:()=>A(t.id,e.studentId),disabled:!r,children:"\u2713 Aceptar"}),(0,xr.jsx)("button",{className:"btn-action btn-cancel",onClick:()=>(async(e,t)=>{if(s&&o)try{await Ar(e,s),await Hr.refundOnCancellation({fromUserId:t,toUserId:o,reservationId:e,cancelledBy:"TUTOR",reason:"Cancelaci\xf3n realizada por tutor"},s),f("\u2705 Clase cancelada");try{await Hr.getTutorBalance(s),globalThis.dispatchEvent(new CustomEvent("tokens:refresh"))}catch(Is){console.warn("No se pudo refrescar balance tras cancelaci\xf3n:",Is)}await P()}catch(Is){const t=String((null===Is||void 0===Is?void 0:Is.message)||"");if(t.includes("409")||/Conflict/i.test(t)){const e="No se puede cancelar: solo PENDIENTE o ACEPTADO y con 12+ horas de antelaci\xf3n.";alert(e),f("\u274c "+e)}else f("\u274c "+(Is.message||"Error al cancelar"))}})(t.id,e.studentId),disabled:!i,title:i?"Cancelar esta reserva":"No se puede cancelar en este estado",children:"\u2717 Cancelar"}),(0,xr.jsx)("button",{className:"btn-action btn-contact",onClick:()=>((e,t,n)=>{var r;C({id:e,sub:e,name:t,email:(null===(r=x[e])||void 0===r?void 0:r.email)||"N/A",avatarUrl:n})})(e.studentId,e.studentName,e.studentAvatar),disabled:!l,title:l?"Contactar al estudiante":"Solo puedes contactar para clases aceptadas",children:"\ud83d\udcac Contactar"})]})]},t.id);var c})})]},e.studentId)),U>1&&(0,xr.jsxs)("div",{className:"pagination",children:[(0,xr.jsx)("button",{disabled:1===M,onClick:()=>_(e=>Math.max(1,e-1)),children:"\u2190"}),(0,xr.jsxs)("span",{children:[M,"/",U]}),(0,xr.jsx)("button",{disabled:M===U,onClick:()=>_(e=>Math.min(U,e+1)),children:"\u2192"}),(0,xr.jsxs)("select",{value:j,onChange:e=>N(Number(e.target.value)),children:[(0,xr.jsx)("option",{value:5,children:"5"}),(0,xr.jsx)("option",{value:10,children:"10"}),(0,xr.jsx)("option",{value:20,children:"20"})]})]})]}),E&&o&&s&&(0,xr.jsx)(wa,{contact:E,myUserId:o,token:s,onClose:()=>C(null)})]})};function _a(e){if(!e)return"";const t=e.trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}function ja(e){if(!e)return"";return new Date(10===e.length?"".concat(e,"T00:00:00"):e).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"})}const Na=e=>{let{reservations:t}=e;const[n,r]=(0,l.useState)(1),a=Math.max(1,Math.ceil(t.length/5)),s=t.slice(5*(n-1),5*n),o=e=>{const t=e.toUpperCase();let n="#6b7280";return["FINALIZADA","ACEPTADO","ACTIVA"].includes(t)&&(n="#10b981"),"INCUMPLIDA"!==t&&"CANCELADO"!==t||(n="#ef4444"),"PENDIENTE"===t&&(n="#f59e0b"),(0,xr.jsx)("span",{className:"history-status-badge",style:{backgroundColor:"".concat(n,"20"),color:n},children:t})};return(0,xr.jsxs)("div",{className:"student-history-panel",children:[(0,xr.jsx)("h4",{children:"Historial de Clases"}),t.length>0?(0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsx)("div",{className:"history-list",children:s.map(e=>(0,xr.jsxs)("div",{className:"history-item",children:[(0,xr.jsxs)("span",{className:"history-date",children:["\ud83d\udcc5 ",ja(e.date)," a las ",_a(e.start)]}),o(e.status)]},e.id))}),a>1&&(0,xr.jsxs)("div",{className:"pagination-controls",children:[(0,xr.jsx)("button",{onClick:()=>r(e=>Math.max(1,e-1)),disabled:1===n,children:"Anterior"}),(0,xr.jsxs)("span",{children:["P\xe1gina ",n," de ",a]}),(0,xr.jsx)("button",{onClick:()=>r(e=>Math.min(a,e+1)),disabled:n===a,children:"Siguiente"})]})]}):(0,xr.jsx)("p",{children:"No hay clases en el historial de este estudiante."})]})},Ea=()=>{const{user:e,isLoading:t}=dr(),n=null===e||void 0===e?void 0:e.id_token,r=null===e||void 0===e?void 0:e.profile.sub,[a,s]=(0,l.useState)([]),[o,i]=(0,l.useState)(!0),[c,u]=(0,l.useState)(null),[d,h]=(0,l.useState)(null);(0,l.useEffect)(()=>{if(!n||!r)return;(async()=>{i(!0),u(null);try{const e="2020-01-01",t=new Date((new Date).setFullYear((new Date).getFullYear()+1)).toISOString().split("T")[0],r=(e=>{const t={};for(const n of e)t[n.studentId]||(t[n.studentId]=[]),t[n.studentId].push(n);return t})(await Pr(e,t,n)),a=Object.keys(r);if(0===a.length)return void s([]);const o=await(async(e,t)=>{const n=e.map(e=>fetch("".concat(jr.USERS_BASE).concat(jr.USERS_PROFILE_PATH,"?id=").concat(e),{headers:{Authorization:"Bearer ".concat(t)}}).then(t=>t.ok?t.json():Promise.reject(new Error("Failed to fetch profile for ".concat(e))))),r=await Promise.allSettled(n),a={};return r.forEach((t,n)=>{"fulfilled"===t.status&&(a[e[n]]=t.value)}),a})(a,n),i=((e,t)=>Object.keys(e).map(n=>{var r,a;const s=e[n].slice();s.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());const o=null===(r=s.find(e=>"FINALIZADA"===e.status))||void 0===r?void 0:r.date,i=!!o&&Date.now()-new Date(o).getTime()<2592e6;return{studentId:n,profile:t[n]||{name:"Estudiante Desconocido",email:"N/A"},reservations:s,sessionsCompleted:s.filter(e=>"FINALIZADA"===e.status).length,firstSessionDate:(null===(a=s[s.length-1])||void 0===a?void 0:a.date)||"N/A",status:i?"active":"inactive"}}))(r,o);i.sort((e,t)=>e.status===t.status?e.profile.name.localeCompare(t.profile.name):"active"===e.status?-1:1),s(i)}catch(e){u(e.message||"No se pudo cargar la informaci\xf3n de los estudiantes."),console.error(e)}finally{i(!1)}})()},[n,r]);return o||t?(0,xr.jsx)("div",{className:"full-center",children:"Cargando tus estudiantes..."}):c?(0,xr.jsx)("div",{className:"full-center error-message",children:c}):(0,xr.jsxs)("div",{className:"students-section",children:[(0,xr.jsx)("h1",{children:"Mis Estudiantes \ud83d\udc65"}),(0,xr.jsxs)("div",{className:"students-grid",children:[0===a.length&&!o&&(0,xr.jsx)("p",{children:"A\xfan no tienes estudiantes en tu historial."}),a.map(e=>(0,xr.jsxs)("div",{className:"student-card-container",children:[(0,xr.jsxs)("div",{className:"student-card",children:[(0,xr.jsxs)("div",{className:"student-header",children:[(0,xr.jsx)("div",{className:"student-avatar",style:{backgroundColor:e.profile.avatarUrl?"transparent":"#667eea"},children:e.profile.avatarUrl?(0,xr.jsx)("img",{src:e.profile.avatarUrl,alt:e.profile.name}):(0,xr.jsx)("span",{children:(e.profile.name||"E").charAt(0)})}),(0,xr.jsxs)("div",{className:"student-info",children:[(0,xr.jsx)("h3",{children:e.profile.name}),(0,xr.jsx)("p",{className:"student-email",children:e.profile.email}),(0,xr.jsx)("span",{className:"status-badge-student ".concat(e.status),children:"active"===e.status?"Activo":"Inactivo"})]})]}),(0,xr.jsxs)("div",{className:"student-details",children:[(0,xr.jsxs)("p",{children:[(0,xr.jsx)("strong",{children:"Nivel:"})," Pregrado"]}),(0,xr.jsxs)("p",{children:[(0,xr.jsx)("strong",{children:"Se uni\xf3:"})," ",ja(e.firstSessionDate)]}),(0,xr.jsxs)("p",{children:[(0,xr.jsx)("strong",{children:"Sesiones completadas:"})," ",e.sessionsCompleted]})]}),(0,xr.jsx)("div",{className:"student-actions",children:(0,xr.jsx)("button",{className:"btn-secondary",onClick:()=>{return t=e.studentId,void h(e=>e===t?null:t);var t},children:d===e.studentId?"Ocultar Historial":"Ver Historial"})})]}),d===e.studentId&&(0,xr.jsx)(Na,{reservations:e.reservations})]},e.studentId))]})]})},Ca="https://calls-b7f6fcdpbvdxcmeu.chilecentral-01.azurewebsites.net";async function Ta(e,t){const n=await fetch("".concat(Ca,"/api/calls/session"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({reservationId:e})});if(!n.ok){const e=await n.text();throw new Error("Error ".concat(n.status,": ").concat(e||"No se pudo crear la sesi\xf3n"))}return n.json()}const Ia=e=>{let{message:t,isMine:n}=e;const r=n?"chat-bubble mine":"chat-bubble theirs",a=function(e){if(!e)return(new Date).toISOString();const t=e,n=t.createdAt;if("string"===typeof n)return n;const r=t.timestamp;return"string"===typeof r?r:(new Date).toISOString()}(t);return(0,xr.jsxs)("div",{className:r,children:[(0,xr.jsx)("p",{children:t.content}),(0,xr.jsx)("span",{className:"timestamp",children:new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},Pa=()=>{try{return crypto.getRandomValues(new Uint32Array(4)).join("-")}catch(e){return"".concat(Date.now(),"-").concat(Math.random())}},Aa=e=>e.id&&!String(e.id).startsWith("temp-")?e.id:"".concat(e.chatId,"|").concat(e.fromUserId,"|").concat(e.toUserId,"|").concat((e=>{let t=0;for(let r=0;r<e.length;r++){var n;t=Math.trunc(31*t+(null!==(n=e.codePointAt(r))&&void 0!==n?n:0))}return String(t)})(e.content),"|").concat(e.createdAt.slice(0,19)),Ra=(e,t)=>{var n,r,a,s,o,i,l,c,u,d,h,p,f,m,g;return{id:String(null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:Pa()),chatId:String(null!==(r=null===e||void 0===e?void 0:e.chatId)&&void 0!==r?r:t),fromUserId:String(null!==(a=null!==(s=null!==(o=null!==(i=null===e||void 0===e?void 0:e.fromUserId)&&void 0!==i?i:null===e||void 0===e?void 0:e.senderId)&&void 0!==o?o:null===e||void 0===e?void 0:e.from)&&void 0!==s?s:null===e||void 0===e?void 0:e.userId)&&void 0!==a?a:""),toUserId:String(null!==(l=null!==(c=null!==(u=null===e||void 0===e?void 0:e.toUserId)&&void 0!==u?u:null===e||void 0===e?void 0:e.recipientId)&&void 0!==c?c:null===e||void 0===e?void 0:e.to)&&void 0!==l?l:""),content:String(null!==(d=null!==(h=null===e||void 0===e?void 0:e.content)&&void 0!==h?h:null===e||void 0===e?void 0:e.text)&&void 0!==d?d:""),createdAt:String(null!==(p=null!==(f=null===e||void 0===e?void 0:e.createdAt)&&void 0!==f?f:null===e||void 0===e?void 0:e.timestamp)&&void 0!==p?p:(new Date).toISOString()),delivered:Boolean(null!==(m=null===e||void 0===e?void 0:e.delivered)&&void 0!==m&&m),read:Boolean(null!==(g=null===e||void 0===e?void 0:e.read)&&void 0!==g&&g)}},Da=e=>{let{contact:t,myUserId:n,token:r}=e;const[a,s]=(0,l.useState)([]),[o,i]=(0,l.useState)(""),[c,u]=(0,l.useState)(!1),d=(0,l.useRef)(null),h=(0,l.useRef)(null),p=(0,l.useRef)(""),f=(0,l.useRef)(new Set),m=(0,l.useRef)([]);(0,l.useEffect)(()=>{var e;if((e=r)&&"string"===typeof e&&e.split(".").length>=3&&e.trim().length>20)return d.current=new ha({autoReconnect:!0,pingIntervalMs:2e4}),d.current.connect(r,e=>((e,t,n,r,a,s,o)=>{const i=e&&"string"===typeof e.data?JSON.parse(e.data):e,l=Ra(i,t.current||"unknown"),c=l.fromUserId===a&&l.toUserId===s||l.fromUserId===s&&l.toUserId===a;if(!t.current)return void(c&&o.current.push(l));if(l.chatId!==t.current&&!c)return;const u=Aa(l);n(e=>{var t,n;if(null!==(t=r.current)&&void 0!==t&&t.has(u))return e;null===(n=r.current)||void 0===n||n.add(u);const a=e.findIndex(e=>String(e.id).startsWith("temp-")&&e.chatId===l.chatId&&e.fromUserId===l.fromUserId&&e.toUserId===l.toUserId&&e.content===l.content&&Math.abs(new Date(e.createdAt).getTime()-new Date(l.createdAt).getTime())<5e3);if(a>=0){const t=[...e];return t[a]=l,t}return[...e,l]})})(e,p,s,f,n,t.id,m),()=>{}),()=>{var e;null===(e=d.current)||void 0===e||e.disconnect(),d.current=null}},[r,n,t.id]),(0,l.useEffect)(()=>{let e=!0;return u(!1),(async()=>{const a=await da(n,t.id);if(!e)return;p.current=a;try{const n=await ca(t.id,r);e&&n&&n!==p.current&&(p.current=n)}catch(c){}const o=await ua(p.current,r).catch(()=>[]),i=[];f.current.clear();for(const e of o){const t=Ra(e,p.current),n=Aa(t);f.current.has(n)||(f.current.add(n),i.push(t))}i.sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime());const l=m.current.splice(0);for(const e of l){const r=e.fromUserId===n&&e.toUserId===t.id||e.fromUserId===t.id&&e.toUserId===n;if(e.chatId===p.current||r){const t=Aa(e);f.current.has(t)||(f.current.add(t),i.push(e))}}e&&(s(i),u(!0))})(),()=>{e=!1}},[t.id,n,r]),(0,l.useEffect)(()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[a]);return(0,xr.jsxs)("div",{className:"chat-window",children:[(0,xr.jsx)("div",{className:"chat-window-header",children:(0,xr.jsx)("h4",{children:t.name})}),(0,xr.jsxs)("div",{className:"chat-messages",children:[a.map(e=>(0,xr.jsx)(Ia,{message:e,isMine:e.fromUserId===n},Aa(e))),(0,xr.jsx)("div",{ref:h})]}),(0,xr.jsxs)("form",{className:"chat-input-form",onSubmit:e=>{var r;e.preventDefault();const a=o.trim();if(!a||!p.current||!c)return;const l={id:"temp-".concat(Pa()),chatId:p.current,fromUserId:n,toUserId:t.id,content:a,createdAt:(new Date).toISOString(),delivered:!1,read:!1},u=Aa(l);f.current.has(u)||(f.current.add(u),s(e=>[...e,l])),null===(r=d.current)||void 0===r||r.sendMessage(t.id,a,p.current),i("")},children:[(0,xr.jsx)("input",{value:o,onChange:e=>i(e.target.value),placeholder:c?"Escribe un mensaje...":"Cargando historial...",autoComplete:"off"}),(0,xr.jsx)("button",{type:"submit",disabled:!c||!o.trim(),children:"Enviar"})]})]})};function La(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function Oa(e){let t;if("string"===typeof e){const n=10===e.length?"T00:00:00":"";t=new Date(e+n)}else t=e;return t.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}function Ua(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}function Ma(e){const t=new Date,n=new Date("".concat(e.date,"T").concat(Ua(e.start))).getTime(),r=new Date("".concat(e.date,"T").concat(Ua(e.end))).getTime(),a=t.getTime(),s=(e.status||"").toUpperCase();return"CANCELADO"===s?"CANCELADO":"FINALIZADA"===s?"FINALIZADA":"INCUMPLIDA"===s?"INCUMPLIDA":"PENDIENTE"===s?a>r?"VENCIDA":"PENDIENTE":"ACEPTADO"===s?a>=n&&a<=r?"ACTIVA":a>r?!1===e.attended?"INCUMPLIDA":"FINALIZADA":"ACEPTADO":s||"DESCONOCIDO"}const za=jr.USERS_BASE,Fa=jr.USERS_PROFILE_PATH;const Ha=()=>{var e,t,n,r;const a=dr(),s=me(),o=null!==(e=null===(t=a.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=a.user)||void 0===n?void 0:n.access_token,c=null===(r=a.user)||void 0===r?void 0:r.profile.sub,[u,d]=(0,l.useState)([]),[h,p]=(0,l.useState)(!1),[f,m]=(0,l.useState)(null),[g,v]=(0,l.useState)("all"),[y,b]=(0,l.useState)(""),[w,x]=(0,l.useState)(!1),[S,k]=(0,l.useState)({}),[_,j]=(0,l.useState)(1),[N,E]=(0,l.useState)(10),[C,T]=(0,l.useState)(null),[I,P]=(0,l.useState)({}),A=(0,l.useRef)(null),R=(0,l.useRef)(new Set),D=e=>(e||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),L=(0,l.useCallback)(async()=>{if(o){p(!0);try{const e=new Date;e.setDate(e.getDate()-30);const t=new Date;t.setDate(t.getDate()+60);const n=La(e),r=La(t),a=await Pr(n,r,o);d(a.filter(e=>"CANCELADO"!==e.status))}catch(Is){m("\u274c "+(Is.message||"Error cargando clases"))}finally{p(!1)}}},[o]);(0,l.useEffect)(()=>{L()},[L]),(0,l.useEffect)(()=>{if(!o||!c)return;A.current&&(A.current.disconnect(),A.current=null);const e=new ha({autoReconnect:!0,pingIntervalMs:2e4});return A.current=e,e.connect(o,e=>{var t,n,r,a,s,o,l,u,d;const h=String(null!==(t=null!==(n=null!==(r=null!==(a=null===e||void 0===e?void 0:e.fromUserId)&&void 0!==a?a:null===e||void 0===e?void 0:e.senderId)&&void 0!==r?r:null===e||void 0===e?void 0:e.from)&&void 0!==n?n:null===e||void 0===e?void 0:e.userId)&&void 0!==t?t:""),p=String(null!==(s=null!==(o=null!==(l=null===e||void 0===e?void 0:e.toUserId)&&void 0!==l?l:null===e||void 0===e?void 0:e.recipientId)&&void 0!==o?o:null===e||void 0===e?void 0:e.to)&&void 0!==s?s:""),f=String(null!==(u=null!==(d=null===e||void 0===e?void 0:e.content)&&void 0!==d?d:null===e||void 0===e?void 0:e.text)&&void 0!==u?u:"");if(!h||!p||!f)return;const m=h===c?p:h;C&&C.id===m||P(e=>i(i({},e),{},{[m]:(e[m]||0)+1}))}),()=>{e.disconnect(),A.current=null}},[o,c,null===C||void 0===C?void 0:C.id]);const O=e=>({PENDIENTE:"#F59E0B",ACEPTADO:"#10B981",ACTIVA:"#6366F1",FINALIZADA:"#0EA5E9",INCUMPLIDA:"#F97316",VENCIDA:"#9CA3AF"}[String(e||"").toUpperCase()]||"#6B7280"),U=(0,l.useMemo)(()=>u.map(e=>i(i({},e),{},{effectiveStatus:Ma(e)})).filter(e=>{if("all"!==g&&e.effectiveStatus!==g)return!1;if(!w){return new Date("".concat(e.date,"T").concat(Ua(e.end))).getTime()>=Date.now()}return!0}).sort((e,t)=>new Date("".concat(e.date,"T").concat(e.start)).getTime()-new Date("".concat(t.date,"T").concat(t.start)).getTime()),[u,g,w]);(0,l.useEffect)(()=>{if(!o)return;const e=Array.from(new Set(u.map(e=>e.studentId).filter(Boolean))).filter(e=>!S[e]&&!R.current.has(e));if(0!==e.length){for(const t of e)R.current.add(t);(async()=>{const t={},n=await Promise.allSettled(e.map(async e=>{const t=await async function(e,t,n,r){const a={Accept:"application/json"};r&&(a.Authorization="Bearer ".concat(r));const s=async r=>{const s="".concat(e).concat(t,"?").concat(r,"=").concat(encodeURIComponent(n)),o=await fetch(s,{headers:a});return o.ok?{ok:!0,raw:await o.json()}:{ok:!1,status:o.status}};let o=await s("id");if(o.ok||(o=await s("sub")),!o.ok)throw Object.assign(new Error("PROFILE_FETCH_FAILED"),{status:o.status});return o.raw}(za,Fa,e,o);return{id:e,prof:t}}));for(const e of n)if("fulfilled"===e.status){var r;const n=e.value.id,a=e.value.prof;t[n]={id:n,sub:null!==(r=null===a||void 0===a?void 0:a.sub)&&void 0!==r?r:n,name:(null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.fullName)||"Estudiante",email:(null===a||void 0===a?void 0:a.email)||"N/A",avatarUrl:null===a||void 0===a?void 0:a.avatarUrl}}else{var a;const n=(null===(a=e.reason)||void 0===a?void 0:a.id)||"unknown";t[n]={id:n,sub:n,name:"Estudiante",email:"N/A"}}Object.keys(t).length>0&&k(e=>i(i({},e),t))})()}},[u,S,o]);const M=(0,l.useMemo)(()=>{const e={};for(const t of U){const n=t.studentId,r=S[n],a=t.studentName||(null===r||void 0===r?void 0:r.name)||"Estudiante",s=t.studentAvatar||(null===r||void 0===r?void 0:r.avatarUrl);e[n]||(e[n]={studentId:n,studentName:a,studentAvatar:s,reservations:[]}),e[n].reservations.push(t)}return Object.values(e).sort((e,t)=>e.studentName.localeCompare(t.studentName,"es"))},[U,S]),z=(0,l.useMemo)(()=>{if(!y.trim())return M;const e=D(y);return M.filter(t=>D(t.studentName).includes(e))},[M,y]),F=Math.max(1,Math.ceil(z.length/N)),H=Math.min(_,F),B=z.slice((H-1)*N,H*N);return(0,l.useEffect)(()=>{j(1)},[g,y,N,w]),(0,xr.jsxs)("div",{className:"page-with-chat-container",children:[(0,xr.jsxs)("div",{className:"main-content ".concat(C?"chat-open":""),children:[(0,xr.jsx)("h1",{style:{marginBottom:8},children:"Mis Clases \ud83c\udf93"}),(0,xr.jsx)("p",{style:{marginTop:-8,opacity:.7},children:"(Contenido de clases programadas y completadas)"}),f&&(0,xr.jsx)("output",{className:"status-message","aria-live":"polite",children:f}),(0,xr.jsx)("div",{className:"filters-card",children:(0,xr.jsxs)("div",{className:"filters-row",children:[(0,xr.jsxs)("div",{className:"search-input",children:[(0,xr.jsx)("input",{placeholder:"Buscar estudiante\u2026",value:y,onChange:e=>b(e.target.value)}),(0,xr.jsx)("span",{className:"search-icon",children:"\ud83d\udd0e"})]}),(0,xr.jsxs)("select",{className:"status-select",value:g,onChange:e=>v(e.target.value),children:[(0,xr.jsx)("option",{value:"all",children:"Todos"}),(0,xr.jsx)("option",{value:"PENDIENTE",children:"Pendiente"}),(0,xr.jsx)("option",{value:"ACEPTADO",children:"Aceptado"}),(0,xr.jsx)("option",{value:"ACTIVA",children:"Activa"}),(0,xr.jsx)("option",{value:"FINALIZADA",children:"Finalizada"}),(0,xr.jsx)("option",{value:"INCUMPLIDA",children:"Incumplida"}),(0,xr.jsx)("option",{value:"VENCIDA",children:"Vencida"})]}),(0,xr.jsxs)("label",{className:"past-toggle",children:[(0,xr.jsx)("input",{type:"checkbox",checked:w,onChange:e=>x(e.target.checked)}),(0,xr.jsx)("span",{children:"Mostrar pasadas"})]})]})}),h&&(0,xr.jsx)("p",{children:"Cargando\u2026"}),!h&&0===B.length&&(0,xr.jsx)("p",{children:"No hay clases para mostrar."}),B.map(e=>(0,xr.jsxs)("div",{className:"student-group-card",children:[(0,xr.jsxs)("div",{className:"student-group-header",children:[e.studentAvatar?(0,xr.jsx)("img",{src:e.studentAvatar,alt:e.studentName}):(0,xr.jsx)("div",{className:"avatar-neutral","aria-hidden":"true"}),(0,xr.jsx)("h3",{children:e.studentName})]}),(0,xr.jsx)("div",{className:"reservations-container",children:e.reservations.map(t=>{const n=Ma(t),r="ACTIVA"===n,a="ACEPTADO"===n||"INCUMPLIDA"===n;return(0,xr.jsxs)("div",{className:"reservation-row",children:[(0,xr.jsxs)("div",{className:"reservation-info",children:[(0,xr.jsxs)("p",{className:"reservation-datetime",children:["\ud83d\udcc5 ",Oa(t.date)," \u2022 \ud83d\udd50 ",Ua(t.start)," - ",Ua(t.end)]}),(0,xr.jsxs)("p",{className:"reservation-id",children:["ID: ",String(t.id).slice(0,8),"..."]})]}),(0,xr.jsx)("div",{className:"reservation-meta",children:(0,xr.jsx)("span",{className:"status-badge",style:{backgroundColor:"".concat(O(n),"20"),color:O(n)},children:(l=n,(l||"").toUpperCase()||"\u2014")})}),(0,xr.jsxs)("div",{className:"reservation-actions",children:[(0,xr.jsx)("button",{className:"btn-action btn-join",onClick:()=>(async(e,t)=>{try{var n,r;if(!o)return void m("\u274c Error: No hay sesi\xf3n activa (falta token).");let a=null!==(n=null!==(r=e.callSessionId)&&void 0!==r?r:e.sessionId)&&void 0!==n?n:void 0;a||(a=(await Ta(e.id,o)).sessionId),sessionStorage.setItem("call:reservation:"+a,String(e.id));const i=S[t.studentId];s("/call/".concat(a,"?reservationId=").concat(encodeURIComponent(String(e.id))),{state:{peerId:t.studentId,peerName:t.studentName,peerEmail:(null===i||void 0===i?void 0:i.email)||"N/A",peerAvatar:t.studentAvatar,role:"tutor"}})}catch(Is){var a;m("\u274c No se pudo iniciar la reuni\xf3n: "+(null!==(a=null===Is||void 0===Is?void 0:Is.message)&&void 0!==a?a:"error"))}})(t,e),disabled:!r,title:r?"Iniciar/Reanudar tutor\xeda":"Disponible solo cuando la reserva est\xe1 ACTIVA",children:"\u25b6 Reunirse ahora"}),(0,xr.jsxs)("button",{className:"btn-action btn-contact",onClick:()=>((e,t,n)=>{var r;T({id:e,sub:e,name:t,email:(null===(r=S[e])||void 0===r?void 0:r.email)||"N/A",avatarUrl:n}),P(t=>i(i({},t),{},{[e]:0}))})(e.studentId,e.studentName,e.studentAvatar),disabled:!a,title:a?"Contactar":"Disponible para ACEPTADO o INCUMPLIDA",children:["\u25cf Contactar",I[e.studentId]>0&&(0,xr.jsx)("span",{className:"badge-dot","aria-label":"mensajes sin leer"})]})]})]},t.id);var l})})]},e.studentId)),F>1&&(0,xr.jsxs)("div",{className:"pagination",children:[(0,xr.jsx)("button",{disabled:1===H,onClick:()=>j(e=>Math.max(1,e-1)),children:"\u2190"}),(0,xr.jsxs)("span",{children:[H,"/",F]}),(0,xr.jsx)("button",{disabled:H===F,onClick:()=>j(e=>Math.min(F,e+1)),children:"\u2192"}),(0,xr.jsxs)("select",{value:N,onChange:e=>E(Number(e.target.value)),children:[(0,xr.jsx)("option",{value:5,children:"5"}),(0,xr.jsx)("option",{value:10,children:"10"}),(0,xr.jsx)("option",{value:20,children:"20"})]})]})]}),C&&c&&o&&(0,xr.jsxs)("aside",{className:"chat-side-panel",children:[(0,xr.jsx)("button",{className:"close-chat-btn",onClick:()=>T(null),type:"button","aria-label":"Cerrar chat",children:"\xd7"}),(0,xr.jsx)(Da,{contact:C,myUserId:c,token:o})]})]})},Ba=(jr.TASKS_BASE||"").replace(/\/$/,"");function Wa(e){const t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t}async function Va(e){if(!e.ok){var t,n,r;let s=null;try{s=await e.json()}catch(a){s=await e.text().catch(()=>null)}const o="string"===typeof s?s:(null===(t=s)||void 0===t?void 0:t.message)||(null===(n=s)||void 0===n?void 0:n.error)||(null===(r=s)||void 0===r?void 0:r.path)||"HTTP ".concat(e.status),i="HTTP ".concat(e.status,": ").concat(o);throw new Error(i)}return 204===e.status?null:e.json()}const qa=()=>{const e=me(),t=dr(),{userRoles:n,isAuthenticated:r}=wr(),{isProfileComplete:a,missingFields:s}=kr(),[o,i]=(0,l.useState)(null),[c,u]=(0,l.useState)(!0),[d,h]=(0,l.useState)([]),[p,f]=(0,l.useState)(!1),[m,g]=(0,l.useState)(""),[v,y]=(0,l.useState)("");(0,l.useEffect)(()=>{var a,s,o,l;r?!n||n.includes("tutor")?t.user&&i({userId:(null===(a=t.user.profile)||void 0===a?void 0:a.sub)||"unknown",name:(null===(s=t.user.profile)||void 0===s?void 0:s.name)||(null===(o=t.user.profile)||void 0===o?void 0:o.nickname)||"Tutor",email:(null===(l=t.user.profile)||void 0===l?void 0:l.email)||"No email",role:"tutor"}):e("/"):e("/login")},[r,n,e,t.user]);const b=(0,l.useMemo)(()=>{var e,n,r;return null!==(e=null===(n=t.user)||void 0===n?void 0:n.id_token)&&void 0!==e?e:null===(r=t.user)||void 0===r?void 0:r.access_token},[t.user]),w=async()=>{if(b)try{f(!0),g("");const e=await async function(e){const t="".concat(Ba,"/api/tasks/available");return Va(await fetch(t,{method:"GET",headers:Wa(e)}))}(b);h(e)}catch(e){g((null===e||void 0===e?void 0:e.message)||"No se pudieron cargar las tareas disponibles")}finally{f(!1)}};(0,l.useEffect)(()=>{b&&w()},[b]);const x=async e=>{b&&(await async function(e,t){const n="".concat(Ba,"/api/tasks/").concat(encodeURIComponent(e),"/accept");return Va(await fetch(n,{method:"POST",headers:Wa(t)}))}(e,b),y("Tarea aceptada. Puedes ver la reserva asociada en tu agenda."),await w())};return t.isLoading||!o?(0,xr.jsx)("div",{className:"full-center",children:"Cargando..."}):(0,xr.jsxs)(xr.Fragment,{children:[!a&&c&&s&&(0,xr.jsx)(Mr,{missingFields:s,currentRole:"tutor",onDismiss:()=>u(!1)}),(0,xr.jsxs)("div",{className:"dashboard-content",children:[(0,xr.jsxs)("div",{className:"tasks-header-row",children:[(0,xr.jsx)("h1",{children:"Tareas de estudiantes"}),(0,xr.jsx)("div",{className:"tasks-actions",children:(0,xr.jsx)("button",{className:"btn-secondary",type:"button",onClick:w,disabled:p,children:"Actualizar"})})]}),m&&(0,xr.jsx)("p",{className:"error-text",children:m}),v&&(0,xr.jsx)("p",{className:"success-text",children:v}),p?(0,xr.jsx)("div",{className:"card",children:"Cargando tareas..."}):0===d.length?(0,xr.jsx)("div",{className:"card",children:"No hay tareas disponibles por ahora."}):(0,xr.jsx)("div",{className:"tasks-grid",children:d.map(e=>(0,xr.jsxs)("article",{className:"task-card",children:[(0,xr.jsxs)("header",{className:"task-header",children:[(0,xr.jsx)("h3",{children:e.titulo}),(0,xr.jsxs)("div",{className:"task-meta",children:[(0,xr.jsx)("span",{className:"status-badge",style:{color:"#2563eb",background:"rgba(37,99,235,.12)"},children:"PUBLICADA"}),e.fechaLimite&&(0,xr.jsxs)("span",{className:"status-badge",children:["L\xedmite: ",e.fechaLimite]})]})]}),(0,xr.jsx)("p",{className:"task-description",children:e.descripcion}),(0,xr.jsxs)("div",{className:"task-details",children:[(0,xr.jsxs)("span",{children:["\ud83d\udcda ",e.materia]}),(0,xr.jsxs)("span",{children:["Estudiante: ",e.studentId]})]}),(0,xr.jsx)("div",{className:"task-actions",children:(0,xr.jsx)("button",{className:"btn-primary",type:"button",onClick:()=>x(e.id),children:"Aceptar tarea"})})]},e.id))})]})]})},Ka=()=>{const e=me(),t=dr(),{userRoles:n,isAuthenticated:r}=wr(),{isProfileComplete:a,missingFields:s}=kr(),[o,i]=(0,l.useState)(!0),[c,u]=(0,l.useState)(null),[d,h]=(0,l.useState)(!1),[p,f]=(0,l.useState)("dashboard"),[m,g]=(0,l.useState)(0),[v]=(0,l.useState)([{id:"1",name:"Ana Garc\xeda",email:"ana@student.com",educationLevel:"Pregrado",joinDate:"2025-09-01",status:"active",sessionsCompleted:8},{id:"2",name:"Carlos Mendoza",email:"carlos@student.com",educationLevel:"Secundaria",joinDate:"2025-08-15",status:"active",sessionsCompleted:12},{id:"3",name:"Luc\xeda Torres",email:"lucia@student.com",educationLevel:"Pregrado",joinDate:"2025-09-10",status:"inactive",sessionsCompleted:3}]),[y,b]=(0,l.useState)([{id:"1",studentName:"Mar\xeda L\xf3pez",subject:"Matem\xe1ticas",description:"Necesito ayuda con c\xe1lculo integral",requestDate:"2025-09-25",status:"pending",priority:"high"},{id:"2",studentName:"Pedro Ruiz",subject:"Programaci\xf3n",description:"Ayuda con React y TypeScript",requestDate:"2025-09-24",status:"pending",priority:"medium"}]),[w,x]=(0,l.useState)([{id:"1",title:"Introducci\xf3n al C\xe1lculo",description:"Conceptos b\xe1sicos",subject:"Matem\xe1ticas",date:"2025-09-28",time:"14:00",duration:60,price:25e3,maxStudents:5,enrolledStudents:3,status:"scheduled"},{id:"2",title:"React Avanzado",description:"Hooks y optimizaci\xf3n",subject:"Programaci\xf3n",date:"2025-09-30",time:"16:00",duration:90,price:35e3,maxStudents:8,enrolledStudents:6,status:"scheduled"}]),[S,k]=(0,l.useState)({title:"",description:"",subject:"",date:"",time:"",duration:60,price:25e3,maxStudents:5});(0,l.useEffect)(()=>{if(r)if(!n||n.includes("tutor")){if(t.user){var a,s,o,i;u({userId:(null===(a=t.user.profile)||void 0===a?void 0:a.sub)||"unknown",name:(null===(s=t.user.profile)||void 0===s?void 0:s.name)||(null===(o=t.user.profile)||void 0===o?void 0:o.nickname)||"Tutor",email:(null===(i=t.user.profile)||void 0===i?void 0:i.email)||"No email",role:"tutor"});const e=async()=>{try{var e,n,r;const a=null!==(e=null===(n=t.user)||void 0===n?void 0:n.id_token)&&void 0!==e?e:null===(r=t.user)||void 0===r?void 0:r.access_token;if(!a)return;const s=await Hr.getTutorBalance(a);g(s.tokenBalance)}catch(Is){g(0)}};e();const n=setInterval(e,3e4),r=()=>{e()};return globalThis.addEventListener("tokens:refresh",r),()=>clearInterval(n)}}else e("/");else e("/login")},[r,n,e,t.user]),(0,l.useEffect)(()=>()=>{globalThis.removeEventListener("tokens:refresh",()=>{})},[]);return t.isLoading||!c?(0,xr.jsx)("div",{className:"full-center",children:"Cargando..."}):(0,xr.jsxs)("div",{className:"tutor-dashboard-container",children:[!a&&o&&s&&(0,xr.jsx)(Mr,{missingFields:s,currentRole:"tutor",onDismiss:()=>i(!1)}),(0,xr.jsx)("header",{className:"dashboard-header",children:(0,xr.jsxs)("div",{className:"header-content",children:[(0,xr.jsx)("div",{className:"logo",children:(0,xr.jsx)("h2",{children:"UpLearn Tutor"})}),(0,xr.jsxs)("nav",{className:"main-nav",children:[(0,xr.jsxs)("button",{className:"nav-item ".concat("dashboard"===p?"active":""),onClick:()=>f("dashboard"),children:[(0,xr.jsx)("span",{children:"\ud83d\udcca"})," Dashboard"]}),(0,xr.jsxs)("button",{className:"nav-item ".concat("my-students"===p?"active":""),onClick:()=>f("my-students"),children:[(0,xr.jsx)("span",{children:"\ud83d\udc65"})," Mis Estudiantes"]}),(0,xr.jsxs)("button",{className:"nav-item ".concat("sessions"===p?"active":""),onClick:()=>f("sessions"),children:[(0,xr.jsx)("span",{children:"\ud83d\udcec"})," Solicitudes"]}),(0,xr.jsxs)("button",{className:"nav-item ".concat("availability"===p?"active":""),onClick:()=>f("availability"),children:[(0,xr.jsx)("span",{children:"\ud83d\uddd3\ufe0f"})," Disponibilidad"]}),(0,xr.jsxs)("button",{className:"nav-item ".concat("requests"===p?"active":""),onClick:()=>f("requests"),children:[(0,xr.jsx)("span",{children:"\ud83c\udf93"})," Mis Clases"]}),(0,xr.jsxs)("button",{className:"nav-item ".concat("available-tasks"===p?"active":""),onClick:()=>f("available-tasks"),children:[(0,xr.jsx)("span",{children:"\ud83d\udccb"})," Tareas disponibles"]})]}),(0,xr.jsxs)("div",{className:"header-actions",style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,xr.jsxs)("div",{className:"token-display",children:[(0,xr.jsx)("img",{src:"/coin-icon.png",alt:"Moneda",className:"token-icon",style:{width:"24px",height:"24px",objectFit:"contain"}}),(0,xr.jsx)("span",{className:"token-amount",children:m}),(0,xr.jsx)("span",{className:"token-label",children:"tokens"})]}),(0,xr.jsxs)("div",{className:"user-menu-container",children:[(0,xr.jsxs)("button",{className:"user-avatar",onClick:()=>h(!d),children:[(0,xr.jsx)("span",{className:"avatar-icon",children:"\ud83d\udc68\u200d\ud83c\udfeb"}),(0,xr.jsx)("span",{className:"user-name",children:c.name}),(0,xr.jsx)("span",{className:"dropdown-arrow",children:"\u25bc"})]}),d&&(0,xr.jsxs)("div",{className:"user-dropdown",children:[(0,xr.jsxs)("div",{className:"user-info",children:[(0,xr.jsx)("p",{className:"user-email",children:c.email}),(0,xr.jsx)("p",{className:"user-role",children:"Tutor Profesional"})]}),(0,xr.jsx)("div",{className:"dropdown-divider"}),(0,xr.jsxs)("button",{className:"dropdown-item",onClick:()=>{e("/edit-profile",{state:{currentRole:"tutor"}})},children:[(0,xr.jsx)("span",{children:"\u270f\ufe0f"})," Editar Perfil"]}),(0,xr.jsx)(Ur,{currentRole:"tutor",asMenuItem:!0}),(0,xr.jsx)(Or,{currentRole:"tutor",asMenuItem:!0}),(0,xr.jsxs)("button",{className:"dropdown-item logout",onClick:async()=>{t.removeUser();globalThis.location.href="".concat("https://us-east-18mvprkbvu.auth.us-east-1.amazoncognito.com","/logout?client_id=").concat("342s18a96gl2pbaroorqh316l8","&logout_uri=").concat(encodeURIComponent("https://nice-mud-05a4c8f10.3.azurestaticapps.net"))},children:[(0,xr.jsx)("span",{children:"\ud83d\udeaa"})," Cerrar Sesi\xf3n"]})]})]})]})]})}),(0,xr.jsxs)("main",{className:"dashboard-main",children:["dashboard"===p&&(0,xr.jsxs)("div",{className:"dashboard-content",children:[(0,xr.jsxs)("h1",{children:["\xa1Bienvenido, ",c.name,"! \ud83d\udc68\u200d\ud83c\udfeb"]}),(0,xr.jsxs)("div",{className:"stats-grid",children:[(0,xr.jsxs)("div",{className:"stat-card",children:[(0,xr.jsx)("div",{className:"stat-icon",children:"\ud83d\udc65"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:v.length}),(0,xr.jsx)("p",{children:"Estudiantes Totales"})]})]}),(0,xr.jsxs)("div",{className:"stat-card",children:[(0,xr.jsx)("div",{className:"stat-icon",children:"\ud83d\udcec"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:y.filter(e=>"pending"===e.status).length}),(0,xr.jsx)("p",{children:"Solicitudes Pendientes"})]})]}),(0,xr.jsxs)("div",{className:"stat-card",children:[(0,xr.jsx)("div",{className:"stat-icon",children:"\ud83c\udf93"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:w.filter(e=>"scheduled"===e.status).length}),(0,xr.jsx)("p",{children:"Clases Programadas"})]})]}),(0,xr.jsxs)("div",{className:"stat-card",children:[(0,xr.jsx)("div",{className:"stat-icon",children:"\ud83d\udcb0"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:w.reduce((e,t)=>e+t.price*t.enrolledStudents,0).toLocaleString()}),(0,xr.jsx)("p",{children:"Ingresos Estimados"})]})]})]}),(0,xr.jsxs)("div",{className:"recent-activity",children:[(0,xr.jsx)("h2",{children:"Actividad Reciente"}),(0,xr.jsxs)("div",{className:"activity-list",children:[y[0]&&(0,xr.jsxs)("div",{className:"activity-item",children:[(0,xr.jsx)("span",{className:"activity-icon",children:"\ud83d\udcdd"}),(0,xr.jsxs)("div",{className:"activity-content",children:[(0,xr.jsxs)("p",{children:[(0,xr.jsx)("strong",{children:"Nueva solicitud:"})," ",y[0].studentName," - ",y[0].subject]}),(0,xr.jsx)("small",{children:"Hace 1 hora"})]})]}),(0,xr.jsxs)("div",{className:"activity-item",children:[(0,xr.jsx)("span",{className:"activity-icon",children:"\u2705"}),(0,xr.jsxs)("div",{className:"activity-content",children:[(0,xr.jsxs)("p",{children:[(0,xr.jsx)("strong",{children:"Sesi\xf3n completada:"})," Introducci\xf3n al C\xe1lculo"]}),(0,xr.jsx)("small",{children:"Ayer"})]})]}),v[2]&&(0,xr.jsxs)("div",{className:"activity-item",children:[(0,xr.jsx)("span",{className:"activity-icon",children:"\ud83d\udc64"}),(0,xr.jsxs)("div",{className:"activity-content",children:[(0,xr.jsxs)("p",{children:[(0,xr.jsx)("strong",{children:"Nuevo estudiante:"})," ",v[2].name," se uni\xf3"]}),(0,xr.jsx)("small",{children:"Hace 2 d\xedas"})]})]})]})]})]}),"my-students"===p&&(0,xr.jsx)(Ea,{}),"sessions"===p&&(0,xr.jsx)(ka,{}),"requests"===p&&(0,xr.jsx)(Ha,{}),"availability"===p&&(0,xr.jsx)(oa,{}),"create-session"===p&&(0,xr.jsx)("div",{className:"create-session-section",children:(0,xr.jsx)("h1",{children:"Crear Nueva Clase \u2795"})}),"available-tasks"===p&&(0,xr.jsx)(qa,{})]})]})},$a=()=>{var e;const t=me(),n=he(),r=dr(),{userRoles:a,isAuthenticated:s}=wr(),o=(null===(e=n.state)||void 0===e?void 0:e.currentRole)||(null===a||void 0===a?void 0:a[0]),[c,u]=(0,l.useState)(null),[d,h]=(0,l.useState)(!1),[p,f]=(0,l.useState)(!1),[m,g]=(0,l.useState)(!1),[v,y]=(0,l.useState)(!1),[b,w]=(0,l.useState)({}),[x,S]=(0,l.useState)(""),[k,_]=(0,l.useState)({name:"",email:"",phoneNumber:"",idType:"",idNumber:"",educationLevel:"",bio:"",specializations:[],credentials:[],tokensPerHour:""}),[j,N]=(0,l.useState)(""),[E,C]=(0,l.useState)([]),[T,I]=(0,l.useState)(!1),[P,A]=(0,l.useState)(""),R=(0,l.useRef)(null),[D,L]=(0,l.useState)([]),[O,U]=(0,l.useState)(null),M=e=>{try{const t=new URL(e).pathname.split("/").filter(Boolean).pop();if(!t)return"Archivo";const n=decodeURIComponent(t);return n.replace(/^[a-f0-9-]+_/i,"")||n}catch(t){const n=e.split("?")[0].split("#")[0].split("/").filter(Boolean).pop();if(!n)return"Archivo";const r=decodeURIComponent(n);return r.replace(/^[a-f0-9-]+_/i,"")||r}};(0,l.useEffect)(()=>{(async()=>{if(s)if(a&&0!==a.length){h(!0);try{var e,n,i;if(null===(e=r.user)||void 0===e||!e.id_token)throw new Error("No hay token disponible");if(null===a||void 0===a||!a.includes(o))throw console.error("\u274c Rol no v\xe1lido o no autorizado:",o),new Error("No tienes permisos para editar el perfil de ".concat(o));let t;if("student"===o)t=await fr.getStudentProfile(r.user.id_token);else{if("tutor"!==o)throw new Error("Rol de usuario no v\xe1lido");t=await fr.getTutorProfile(r.user.id_token)}const s={userId:(null===(n=r.user.profile)||void 0===n?void 0:n.sub)||"unknown",name:t.name||"",email:t.email||"",phoneNumber:t.phoneNumber||"",role:o.toUpperCase(),idType:t.idType||"",idNumber:t.idNumber||"",educationLevel:t.educationLevel||"",bio:t.bio||"",specializations:t.specializations||[],credentials:t.credentials||[],tokensPerHour:null!==(i=t.tokensPerHour)&&void 0!==i?i:null};u(s),_({name:t.name||"",email:t.email||"",phoneNumber:t.phoneNumber||"",idType:t.idType||"",idNumber:t.idNumber||"",educationLevel:t.educationLevel||"",bio:t.bio||"",specializations:t.specializations||[],credentials:t.credentials||[],tokensPerHour:null!=t.tokensPerHour?String(t.tokensPerHour):""}),L((t.credentials||[]).map(e=>M(e)))}catch(l){console.error("Error cargando perfil:",l),w({general:l instanceof Error?l.message:"Error cargando el perfil"}),l instanceof Error&&l.message.includes("401")&&t("/login")}finally{h(!1)}}else t("/login");else t("/login")})()},[t,r.isAuthenticated,r.user,a,o]);const z=e=>{const{name:t,value:n}=e.target;_(e=>i(i({},e),{},{[t]:n})),b[t]&&w(e=>i(i({},e),{},{[t]:""}))},F=()=>{const e=j.trim();if(e&&!k.specializations.some(t=>t.name===e)){const t={name:e,verified:!1,source:"MANUAL",verifiedAt:null,documentUrl:null};_(e=>i(i({},e),{},{specializations:[...e.specializations,t]})),N("")}},H=()=>{y(!1)};return d?(0,xr.jsx)("div",{className:"loading-container",children:(0,xr.jsxs)("div",{className:"loading-spinner",children:[(0,xr.jsx)("div",{className:"spinner-icon",children:"\u23f3"}),(0,xr.jsx)("p",{children:"Cargando datos del perfil..."})]})}):c||d?(0,xr.jsx)("div",{className:"edit-profile-container",children:(0,xr.jsxs)("div",{className:"edit-profile-content",children:[(0,xr.jsxs)("div",{className:"profile-header",children:[(0,xr.jsx)("h1",{children:"Editar Perfil"}),(0,xr.jsx)("p",{children:"Actualiza tu informaci\xf3n personal"}),(0,xr.jsx)("div",{className:"user-role-badge",children:"student"===o?"\ud83c\udf93 Estudiante":"\ud83d\udc68\u200d\ud83c\udfeb Tutor"})]}),(0,xr.jsxs)("form",{className:"profile-form",onSubmit:async e=>{var n;if(e.preventDefault(),(()=>{const e={};if(k.name.trim()||(e.name="El nombre es requerido"),k.email.trim()?/\S+@\S+\.\S+/.test(k.email)||(e.email="Email inv\xe1lido"):e.email="El email es requerido",k.phoneNumber.trim()||(e.phoneNumber="El tel\xe9fono es requerido"),"student"!==o||k.educationLevel.trim()||(e.educationLevel="El nivel educativo es requerido"),"tutor"===o&&(k.bio.trim()||(e.bio="La biograf\xeda es requerida"),0===k.specializations.length&&(e.specializations="Debe tener al menos una especializaci\xf3n"),""!==String(k.tokensPerHour).trim())){const t=parseInt(String(k.tokensPerHour),10);(isNaN(t)||t<=0)&&(e.tokensPerHour="Ingresa un n\xfamero v\xe1lido (>0)")}return w(e),0===Object.keys(e).length})())if(null!==(n=r.user)&&void 0!==n&&n.id_token){f(!0),w({}),S("");try{const e={name:k.name,email:k.email,phoneNumber:k.phoneNumber,idType:k.idType,idNumber:k.idNumber};if("student"===o)e.educationLevel=k.educationLevel;else if("tutor"===o)if(e.bio=k.bio,e.specializations=k.specializations,e.credentials=k.credentials,""!==String(k.tokensPerHour).trim()){const t=parseInt(String(k.tokensPerHour),10);!isNaN(t)&&t>0&&(e.tokensPerHour=t)}else e.tokensPerHour=null;let n;if("student"===o)n=await fr.updateStudentProfile(e,r.user.id_token);else{if("tutor"!==o)throw new Error("Rol de usuario no v\xe1lido para actualizaci\xf3n");n=await fr.updateTutorProfile(e,r.user.id_token)}S("\xa1Perfil actualizado exitosamente!"),setTimeout(()=>{t("student"===o?"/student-dashboard":"tutor"===o?"/tutor-dashboard":"/")},2e3)}catch(a){console.error("Error actualizando perfil:",a),w({general:a instanceof Error?a.message:"Error actualizando el perfil"})}finally{f(!1)}}else w({general:"No hay token de autenticaci\xf3n v\xe1lido"})},children:[b.general&&(0,xr.jsx)("div",{className:"alert alert-error",children:b.general}),x&&(0,xr.jsx)("div",{className:"alert alert-success",children:x}),(0,xr.jsxs)("div",{className:"form-section",children:[(0,xr.jsx)("h2",{children:"Informaci\xf3n Personal"}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"Nombre Completo"}),(0,xr.jsx)("input",{type:"text",name:"name",className:"form-input ".concat(b.name?"error":""),placeholder:"Tu nombre completo",value:k.name,onChange:z,disabled:p}),b.name&&(0,xr.jsx)("span",{className:"error-message",children:b.name})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"Email"}),(0,xr.jsx)("input",{type:"email",name:"email",className:"form-input ".concat(b.email?"error":""),placeholder:"tu@email.com",value:k.email,onChange:z,disabled:p}),b.email&&(0,xr.jsx)("span",{className:"error-message",children:b.email})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"Tel\xe9fono"}),(0,xr.jsx)("input",{type:"tel",name:"phoneNumber",className:"form-input ".concat(b.phoneNumber?"error":""),placeholder:"N\xfamero de tel\xe9fono",value:k.phoneNumber,onChange:z,disabled:p}),b.phoneNumber&&(0,xr.jsx)("span",{className:"error-message",children:b.phoneNumber})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"Tipo de Identificaci\xf3n"}),(0,xr.jsxs)("select",{name:"idType",className:"form-input ".concat(b.idType?"error":""),value:k.idType,onChange:z,disabled:p,children:[(0,xr.jsx)("option",{value:"",children:"Selecciona tipo de identificaci\xf3n"}),(0,xr.jsx)("option",{value:"CC",children:"C\xe9dula de Ciudadan\xeda"}),(0,xr.jsx)("option",{value:"CE",children:"C\xe9dula de Extranjer\xeda"}),(0,xr.jsx)("option",{value:"TI",children:"Tarjeta de Identidad"}),(0,xr.jsx)("option",{value:"PP",children:"Pasaporte"}),(0,xr.jsx)("option",{value:"RC",children:"Registro Civil"})]}),b.idType&&(0,xr.jsx)("span",{className:"error-message",children:b.idType})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"N\xfamero de Identificaci\xf3n"}),(0,xr.jsx)("input",{type:"text",name:"idNumber",className:"form-input ".concat(b.idNumber?"error":""),placeholder:"N\xfamero de identificaci\xf3n",value:k.idNumber,onChange:z,disabled:p}),b.idNumber&&(0,xr.jsx)("span",{className:"error-message",children:b.idNumber})]})]}),"student"===o&&(0,xr.jsxs)("div",{className:"form-section",children:[(0,xr.jsx)("h2",{children:"Informaci\xf3n Acad\xe9mica"}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"Nivel Educativo"}),(0,xr.jsxs)("select",{name:"educationLevel",className:"form-input ".concat(b.educationLevel?"error":""),value:k.educationLevel,onChange:z,disabled:p,children:[(0,xr.jsx)("option",{value:"",children:"Selecciona tu nivel educativo"}),(0,xr.jsx)("option",{value:"PRIMARIA",children:"Primaria"}),(0,xr.jsx)("option",{value:"SECUNDARIA",children:"Secundaria"}),(0,xr.jsx)("option",{value:"PREGRADO",children:"Pregrado"}),(0,xr.jsx)("option",{value:"POSTGRADO",children:"Postgrado"}),(0,xr.jsx)("option",{value:"OTRO",children:"Otro"})]}),b.educationLevel&&(0,xr.jsx)("span",{className:"error-message",children:b.educationLevel})]})]}),"tutor"===o&&(0,xr.jsxs)("div",{className:"form-section",children:[(0,xr.jsx)("h2",{children:"Informaci\xf3n Profesional"}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"Biograf\xeda"}),(0,xr.jsx)("textarea",{name:"bio",className:"form-input form-textarea ".concat(b.bio?"error":""),placeholder:"Cu\xe9ntanos sobre tu experiencia y enfoque como tutor...",rows:4,value:k.bio,onChange:z,disabled:p}),b.bio&&(0,xr.jsx)("span",{className:"error-message",children:b.bio})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"Tokens por Hora"}),(0,xr.jsx)("input",{type:"number",name:"tokensPerHour",min:1,className:"form-input ".concat(b.tokensPerHour?"error":""),placeholder:"Ej: 50",value:k.tokensPerHour,onChange:z,disabled:p}),b.tokensPerHour&&(0,xr.jsx)("span",{className:"error-message",children:b.tokensPerHour}),(0,xr.jsx)("p",{className:"help-text",children:"Tarifa en tokens que cobrar\xe1s por cada hora de tutor\xeda. D\xe9jalo vac\xedo si a\xfan no decides."})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"Especializaciones"}),(0,xr.jsxs)("div",{className:"array-input-container",children:[(0,xr.jsxs)("div",{className:"array-input-row",children:[(0,xr.jsx)("input",{type:"text",className:"form-input",placeholder:"Ej: Matem\xe1ticas, F\xedsica, Programaci\xf3n...",value:j,onChange:e=>N(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),F()),disabled:p}),(0,xr.jsx)("button",{type:"button",className:"add-button",onClick:F,disabled:p,children:"Agregar"})]}),(0,xr.jsx)("div",{className:"tags-container",children:k.specializations.map((e,t)=>(0,xr.jsxs)("span",{className:"tag specialization-tag ".concat(e.verified?"verified":"manual"),title:e.verified?"Verificado por IA el ".concat(new Date(e.verifiedAt||"").toLocaleDateString()):"Agregado manualmente",children:[e.verified&&(0,xr.jsx)("span",{className:"verified-icon",children:"\u2713"}),e.name,(0,xr.jsx)("button",{type:"button",onClick:()=>{return e=t,void(k.specializations[e].verified?alert("No puedes eliminar especializaciones verificadas. Elimina el documento asociado para quitarla."):_(t=>{const n=t.specializations.filter((t,n)=>n!==e);return i(i({},t),{},{specializations:n})}));var e},disabled:p||e.verified,className:e.verified?"disabled-remove":"",children:"\xd7"})]},t))}),b.specializations&&(0,xr.jsx)("span",{className:"error-message",children:b.specializations}),(0,xr.jsx)("p",{className:"help-text",children:"Las especializaciones con \u2713 fueron verificadas autom\xe1ticamente. Para eliminarlas, elimina el documento asociado."})]})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",children:"Credenciales (Archivos)"}),(0,xr.jsxs)("div",{className:"upload-credentials-container",children:[(0,xr.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg,.doc,.docx",ref:R,onChange:e=>{A("");const t=e.target.files?Array.from(e.target.files):[];if(0!==t.length&&(C(e=>{const n=new Set(e.map(e=>"".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified))),r=t.filter(e=>!n.has("".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified)));return[...e,...r]}),e.target))try{e.target.value=""}catch(n){}},disabled:p||T}),E.length>0&&(0,xr.jsxs)("div",{className:"pending-files",children:[(0,xr.jsx)("p",{children:(0,xr.jsx)("strong",{children:"Archivos seleccionados:"})}),(0,xr.jsx)("ul",{children:E.map((e,t)=>(0,xr.jsxs)("li",{children:[e.name,(0,xr.jsx)("button",{type:"button",className:"remove-credential-btn",onClick:()=>C(e=>e.filter((e,n)=>n!==t)),disabled:T,children:"\xd7"})]},"".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified)))}),(0,xr.jsx)("button",{type:"button",className:"add-button",onClick:async()=>{var e;if(null!==(e=r.user)&&void 0!==e&&e.id_token)if(0!==E.length){I(!0),A("");try{const e=await fr.uploadTutorCredentials(r.user.id_token,E),t=e.savedCredentials||[];_(e=>i(i({},e),{},{credentials:[...e.credentials||[],...t]}));const n=(e.details||[]).filter(e=>e.saved),a=n.map(e=>e.fileName||M(e.uploadedUrl));L(e=>[...e,...a]),C([]),R.current&&(R.current.value="");const s=n.filter(e=>e.addedSpecialization).map(e=>e.addedSpecialization);if(s.length>0){const e=s.join(", ");A("\u2713 Credenciales subidas exitosamente. Se a\xf1adieron especializaciones verificadas: ".concat(e));try{const e=await fr.getTutorProfile(r.user.id_token);_(t=>i(i({},t),{},{specializations:e.specializations||[]}))}catch(Is){console.error("Error recargando especializaciones:",Is)}}if(e.rejected&&e.rejected>0){const t=(e.details||[]).filter(e=>"rejected"===e.status).map(e=>"".concat(e.fileName,": ").concat(e.reason)).join(", ");A("".concat(e.validated," archivo(s) validado(s), ").concat(e.rejected," rechazado(s): ").concat(t))}}catch(t){A(t instanceof Error?t.message:"Error subiendo credenciales")}finally{I(!1)}}else A("Seleccione uno o m\xe1s archivos");else A("No hay token de autenticaci\xf3n v\xe1lido")},disabled:T,children:T?"Subiendo...":"Subir Credenciales"})]}),P&&(0,xr.jsx)("span",{className:"error-message",children:P}),(0,xr.jsxs)("div",{className:"uploaded-credentials",children:[(0,xr.jsx)("p",{children:(0,xr.jsx)("strong",{children:"Credenciales Subidas:"})}),0===k.credentials.length&&(0,xr.jsx)("p",{className:"muted",children:"No hay credenciales a\xfan."}),(0,xr.jsx)("ul",{className:"credentials-list",children:k.credentials.map((e,t)=>(0,xr.jsxs)("li",{children:[(0,xr.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:D[t]||M(e)||"Credencial ".concat(t+1)}),(0,xr.jsx)("button",{type:"button",className:"remove-credential-btn",onClick:()=>(async e=>{var t;if(A(""),null===(t=r.user)||void 0===t||!t.id_token)return void A("No hay token de autenticaci\xf3n v\xe1lido");const n=k.credentials[e];if(n)try{U(e);const t=await fr.deleteTutorCredentials(r.user.id_token,[n]),a=(null===t||void 0===t?void 0:t.remainingCredentials)||[];if(_(e=>i(i({},e),{},{credentials:a})),L(a.map(e=>M(e))),t.removedSpecializations&&t.removedSpecializations.length>0){const e=t.removedSpecializations.join(", ");A("\u2713 Credencial eliminada. Las siguientes especializaciones verificadas tambi\xe9n fueron eliminadas: ".concat(e));try{const e=await fr.getTutorProfile(r.user.id_token);_(t=>i(i({},t),{},{specializations:e.specializations||[]}))}catch(Is){console.error("Error recargando especializaciones:",Is)}}"boolean"!==typeof(null===t||void 0===t?void 0:t.tutorVerified)||t.tutorVerified||A("Se eliminaron las credenciales. Tu cuenta qued\xf3 no verificada.")}catch(a){A(a instanceof Error?a.message:"Error eliminando credencial")}finally{U(null)}})(t),disabled:p||O===t,children:O===t?"\u2026":"\xd7"})]},t))})]}),b.credentials&&(0,xr.jsx)("span",{className:"error-message",children:b.credentials}),(0,xr.jsx)("p",{className:"help-text",children:"Sube diplomas, certificados o t\xedtulos en PDF o imagen."})]})]})]}),(0,xr.jsxs)("div",{className:"form-actions",children:[(0,xr.jsxs)("div",{className:"main-actions",children:[(0,xr.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p||m,children:p?"Guardando...":"Guardar Cambios"}),(0,xr.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{t("student"===o?"/student-dashboard":"tutor"===o?"/tutor-dashboard":"/")},disabled:p||m,children:"Cancelar"})]}),(0,xr.jsxs)("div",{className:"danger-zone",children:[(0,xr.jsxs)("button",{type:"button",className:"btn btn-danger",onClick:()=>{y(!0)},disabled:p||m,children:["\ud83d\uddd1\ufe0f Eliminar ","student"===o?"Rol de Estudiante":"Rol de Tutor"]}),(0,xr.jsx)("p",{className:"danger-text",children:a&&a.length>1?"Se eliminar\xe1 tu rol de ".concat("student"===o?"estudiante":"tutor",". Si es tu \xfanico rol, se eliminar\xe1 toda la cuenta."):"Al ser tu \xfanico rol, esta acci\xf3n eliminar\xe1 completamente tu cuenta y no se puede deshacer."})]})]})]}),v&&(0,xr.jsx)("div",{className:"modal-overlay",onClick:H,children:(0,xr.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,xr.jsx)("div",{className:"modal-header",children:(0,xr.jsx)("h2",{children:"\u26a0\ufe0f Confirmar Eliminaci\xf3n de Rol"})}),(0,xr.jsxs)("div",{className:"modal-body",children:[(0,xr.jsx)("p",{children:(0,xr.jsxs)("strong",{children:["\xbfEst\xe1s seguro de que deseas eliminar tu rol de ","student"===o?"estudiante":"tutor","?"]})}),a&&a.length>1?(0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsxs)("p",{children:["Se eliminar\xe1 \xfanicamente tu rol de ","student"===o?"estudiante":"tutor",", pero mantendr\xe1s acceso con tus otros roles."]}),(0,xr.jsx)("p",{children:"Se eliminar\xe1:"})]}):(0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsx)("p",{children:"Al ser tu \xfanico rol, esta acci\xf3n eliminar\xe1 completamente tu cuenta."}),(0,xr.jsx)("p",{children:"Se eliminar\xe1 permanentemente:"})]}),(0,xr.jsxs)("ul",{children:[(0,xr.jsx)("li",{children:"\u2717 Tu perfil personal"}),(0,xr.jsx)("li",{children:"\u2717 Toda tu informaci\xf3n de contacto"}),"student"===o&&(0,xr.jsx)("li",{children:"\u2717 Tu historial acad\xe9mico y tareas"}),"tutor"===o&&(0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsx)("li",{children:"\u2717 Tu biograf\xeda y especializaciones"}),(0,xr.jsx)("li",{children:"\u2717 Tus credenciales y certificaciones"})]}),(0,xr.jsx)("li",{children:"\u2717 Todo el historial de actividades"})]}),(0,xr.jsx)("p",{className:"warning-text",children:(0,xr.jsx)("strong",{children:"Esta acci\xf3n NO se puede deshacer."})})]}),(0,xr.jsxs)("div",{className:"modal-actions",children:[(0,xr.jsx)("button",{className:"btn btn-danger",onClick:async()=>{var e;if(null!==(e=r.user)&&void 0!==e&&e.id_token){g(!0),w({});try{let e;if("student"===o)e=await fr.removeStudentRole(r.user.id_token);else{if("tutor"!==o)throw new Error("Rol de usuario no v\xe1lido para eliminaci\xf3n");e=await fr.removeTutorRole(r.user.id_token)}if(e.userDeleted)alert("Tu cuenta ha sido eliminada completamente."),r.removeUser(),t("/");else{if(alert("Tu rol de ".concat("student"===o?"estudiante":"tutor"," ha sido eliminado. ").concat(e.message||"")),e.remainingRoles&&e.remainingRoles.length>0){const n=e.remainingRoles[0];t("student"===n?"/student-dashboard":"tutor"===n?"/tutor-dashboard":"/role-selection")}else t("/role-selection")}}catch(n){console.error("Error eliminando cuenta/rol:",n),w({general:n instanceof Error?n.message:"Error eliminando la cuenta"}),y(!1)}finally{g(!1)}}else w({general:"No hay token de autenticaci\xf3n v\xe1lido"})},disabled:m,children:m?"Eliminando...":"S\xed, Eliminar ".concat("student"===o?"Rol de Estudiante":"Rol de Tutor")}),(0,xr.jsx)("button",{className:"btn btn-secondary",onClick:H,disabled:m,children:"Cancelar"})]})]})})]})}):(0,xr.jsx)("div",{className:"loading-container",children:(0,xr.jsxs)("div",{className:"loading-spinner error",children:[(0,xr.jsx)("div",{className:"spinner-icon",children:"\u274c"}),(0,xr.jsx)("p",{children:"Error cargando el perfil"}),(0,xr.jsx)("button",{className:"btn btn-primary",onClick:()=>t("/login"),children:"Volver al Login"})]})})},Ja=()=>{const e=me(),t=dr(),[n,r]=(0,l.useState)([]),[a,s]=(0,l.useState)(!1),[o,i]=(0,l.useState)(""),c=e=>{r(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return a?(0,xr.jsx)("div",{className:"role-selection-container",children:(0,xr.jsx)("div",{className:"role-selection-content",children:(0,xr.jsxs)("div",{className:"loading-state",children:[(0,xr.jsx)("h2",{children:"Guardando tu selecci\xf3n..."}),(0,xr.jsx)("div",{className:"loading-spinner"})]})})}):(0,xr.jsx)("div",{className:"role-selection-container",children:(0,xr.jsxs)("div",{className:"role-selection-content",children:[(0,xr.jsxs)("div",{className:"role-selection-header",children:[(0,xr.jsx)("h1",{children:"\xa1Bienvenido a UpLearn!"}),(0,xr.jsx)("p",{children:"Para continuar, selecciona tu(s) rol(es) en la plataforma:"}),(0,xr.jsx)("p",{className:"multiple-selection-note",children:"Puedes seleccionar ambos roles si planeas ser estudiante y tutor"})]}),o&&(0,xr.jsx)("div",{className:"error-message",children:o}),(0,xr.jsx)("div",{className:"roles-grid",children:[{value:"student",title:"Estudiante",description:"Busca tutores y reserva sesiones de aprendizaje",icon:"\ud83d\udcda"},{value:"tutor",title:"Tutor",description:"Ofrece tus conocimientos y ense\xf1a a otros estudiantes",icon:"\ud83d\udc68\u200d\ud83c\udfeb"}].map(e=>(0,xr.jsxs)("label",{className:"role-card ".concat(n.includes(e.value)?"selected":""),htmlFor:e.value,onTouchStart:()=>c(e.value),children:[(0,xr.jsx)("div",{className:"role-icon",children:e.icon}),(0,xr.jsx)("h3",{className:"role-title",children:e.title}),(0,xr.jsx)("p",{className:"role-description",children:e.description}),(0,xr.jsxs)("div",{className:"role-checkbox",children:[(0,xr.jsx)("input",{type:"checkbox",id:e.value,name:"roles",value:e.value,checked:n.includes(e.value),onChange:()=>c(e.value)}),(0,xr.jsx)("span",{children:"Seleccionar"})]})]},e.value))}),(0,xr.jsx)("div",{className:"selected-roles-summary",children:n.length>0&&(0,xr.jsxs)("div",{className:"selection-summary",children:[(0,xr.jsx)("h4",{children:"Roles seleccionados:"}),(0,xr.jsx)("div",{className:"selected-roles-list",children:n.map(e=>(0,xr.jsx)("span",{className:"selected-role-badge",children:"student"===e?"\ud83d\udcda Estudiante":"\ud83d\udc68\u200d\ud83c\udfeb Tutor"},e))})]})}),(0,xr.jsx)("div",{className:"form-actions",children:(0,xr.jsx)("button",{className:"btn btn-primary",onClick:async()=>{var r;if(0!==n.length)if(null!==(r=t.user)&&void 0!==r&&r.id_token){s(!0),i("");try{await fr.saveUserRole(t.user.id_token,n),br();const r=n.includes("student")?"/student-dashboard":"/tutor-dashboard";e(r,{replace:!0})}catch(o){console.error("Error guardando roles:",o),i("Error al guardar los roles. Int\xe9ntalo de nuevo.")}finally{s(!1)}}else i("Error de autenticaci\xf3n. Por favor inicia sesi\xf3n nuevamente.");else i("Por favor selecciona al menos un rol")},disabled:0===n.length||a,children:"Continuar"})}),(0,xr.jsx)("div",{className:"role-selection-footer",children:(0,xr.jsx)("p",{className:"note",children:"Nota: Podr\xe1s cambiar tus roles m\xe1s tarde desde tu perfil si lo necesitas."})})]})})},Qa=()=>{var e,t,n,r,a,s,o,i,c;const{role:u}=ge(),d=he(),h=me(),p=dr(),f=d.state,m=(0,l.useMemo)(()=>{var e;return null!==(e=null===f||void 0===f?void 0:f.profile)&&void 0!==e?e:{}},[f]),g="student"===u||"tutor"===u?u:"tutor",v=null!==(e=null!==(t=m.name)&&void 0!==t?t:null===(n=p.user)||void 0===n||null===(r=n.profile)||void 0===r?void 0:r.name)&&void 0!==e?e:"Usuario",y=null!==(a=null!==(s=m.email)&&void 0!==s?s:null===(o=p.user)||void 0===o||null===(i=o.profile)||void 0===i?void 0:i.email)&&void 0!==a?a:"",b=(m.userId||m.sub||"").trim(),w="tutor"===g&&!!b;return(0,xr.jsx)("div",{className:"edit-profile-container",children:(0,xr.jsxs)("div",{className:"edit-profile-content",children:[(0,xr.jsxs)("div",{className:"profile-header",children:[(0,xr.jsx)("h1",{children:"Perfil"}),(0,xr.jsx)("p",{children:"Informaci\xf3n del usuario"}),(0,xr.jsx)("div",{className:"user-role-badge",children:"student"===g?"\ud83c\udf93 Estudiante":"\ud83d\udc68\u200d\ud83c\udfeb Tutor"})]}),(0,xr.jsxs)("div",{className:"profile-top-strip",style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[(0,xr.jsx)("div",{"aria-hidden":!0,style:{width:56,height:56,borderRadius:"50%",background:"linear-gradient(135deg, #7C3AED 0%, #6366F1 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:800,fontSize:20},title:v,children:v.trim().charAt(0).toUpperCase()}),(0,xr.jsxs)("div",{children:[(0,xr.jsx)("div",{style:{fontWeight:700},children:v}),y&&(0,xr.jsx)("div",{style:{fontSize:12,color:"#6B7280"},children:y})]})]}),(0,xr.jsxs)("form",{className:"profile-form",onSubmit:e=>e.preventDefault(),children:[(0,xr.jsxs)("div",{className:"form-section",children:[(0,xr.jsx)("h2",{children:"Informaci\xf3n Personal"}),(0,xr.jsx)("div",{className:"form-grid-2",children:(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",htmlFor:"fullName",children:"Nombre Completo"}),(0,xr.jsx)("input",{id:"fullName",className:"form-input",value:v,disabled:!0,readOnly:!0})]})})]}),"student"===g&&(0,xr.jsxs)("div",{className:"form-section",children:[(0,xr.jsx)("h2",{children:"Informaci\xf3n Acad\xe9mica"}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",htmlFor:"educationLevel",children:"Nivel Educativo"}),(0,xr.jsx)("input",{id:"educationLevel",className:"form-input",value:null!==(c=m.educationLevel)&&void 0!==c?c:"\u2014",disabled:!0,readOnly:!0})]})]}),"tutor"===g&&(0,xr.jsxs)("div",{className:"form-section",children:[(0,xr.jsx)("h2",{children:"Informaci\xf3n Profesional"}),!!m.bio&&(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",htmlFor:"bio",children:"Biograf\xeda"}),(0,xr.jsx)("textarea",{id:"bio",className:"form-input form-textarea",value:m.bio,disabled:!0,readOnly:!0,rows:4})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"specializations",className:"form-label",children:"Especializaciones"}),(0,xr.jsx)("div",{className:"tags-container",children:Array.isArray(m.specializations)&&m.specializations.length>0?(0,xr.jsxs)(xr.Fragment,{children:[m.specializations.map((e,t)=>(0,xr.jsxs)("span",{className:"tag specialization-tag ".concat(e.verified?"verified":"manual"),title:e.verified?"Verificado por IA - ".concat(e.source):"Agregado manualmente",children:[e.verified&&(0,xr.jsx)("span",{className:"verified-icon",children:"\u2713"}),e.name]},t)),(0,xr.jsx)("input",{id:"specializations",className:"form-input",value:m.specializations.map(e=>e.name).join(", "),readOnly:!0,"aria-hidden":"true",tabIndex:-1,style:{position:"absolute",left:"-10000px"}})]}):(0,xr.jsx)("input",{id:"specializations",className:"form-input",value:"\u2014",disabled:!0,readOnly:!0})})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"credentials",className:"form-label",children:"Credenciales"}),(0,xr.jsx)("div",{className:"tags-container",children:Array.isArray(m.credentials)&&m.credentials.length>0?(0,xr.jsxs)(xr.Fragment,{children:[m.credentials.map(e=>(0,xr.jsx)("span",{className:"tag",children:e},e)),(0,xr.jsx)("input",{id:"credentials",className:"form-input",value:m.credentials.join(", "),readOnly:!0,"aria-hidden":"true",tabIndex:-1,style:{position:"absolute",left:"-10000px"}})]}):(0,xr.jsx)("input",{id:"credentials",className:"form-input",value:"\u2014",disabled:!0,readOnly:!0})})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{className:"form-label",htmlFor:"tokensPerHour",children:"Tarifa (Tokens por Hora)"}),(0,xr.jsx)("input",{id:"tokensPerHour",className:"form-input",value:"number"===typeof m.tokensPerHour&&m.tokensPerHour>0?"".concat(m.tokensPerHour," tokens/hora"):"\u2014",readOnly:!0,disabled:!0})]})]}),(0,xr.jsx)("div",{className:"form-actions",style:{justifyContent:"flex-end"},children:(0,xr.jsxs)("div",{className:"main-actions",style:{display:"flex",gap:8,flexWrap:"wrap"},children:[w&&(0,xr.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>{b?h("/book/".concat(encodeURIComponent(b)),{state:{tutor:m,role:"tutor"}}):alert("No se pudo identificar al tutor para reservar.")},children:"Reservar Cita"}),(0,xr.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>h(-1),children:"Volver"})]})})]})]})})};function Ga(e){const[t,n,r]=e.split("-").map(Number);return new Date(t,(null!==n&&void 0!==n?n:1)-1,null!==r&&void 0!==r?r:1)}function Ya(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function Za(e,t){const n=Ga(e);return n.setDate(n.getDate()+t),Ya(n)}const Xa=e=>{var t;let{cellData:n,date:r,hour:a,now:s,isSelected:o,onSelect:i}=e;const l=(null!==(t=null===n||void 0===n?void 0:n.status)&&void 0!==t?t:"").toUpperCase(),c=new Date("".concat(r,"T").concat(a))<s,u=!c&&("DISPONIBLE"===l||"AVAILABLE"===l);let d="disabled";!c&&l&&(d=u?"available":"taken");let h="No disponible ".concat(a," ").concat(r);u?h="Disponible ".concat(a," ").concat(r):l&&(h="Ocupado ".concat(a," ").concat(r));const p="cell ".concat(d).concat(u?" can-pick":"").concat(o?" selected":"");return(0,xr.jsx)("button",{type:"button",className:p,onClick:u?i:void 0,disabled:!u,"aria-pressed":o,"aria-label":h,children:u&&(0,xr.jsx)("span",{className:"cell-label",children:"Disponible"})})},es=()=>{var e,t,n,r,a,s;const{tutorId:o}=ge(),i=he(),c=me(),u=dr(),d=i.state,h=null!==(e=null===d||void 0===d?void 0:d.tutor)&&void 0!==e?e:{},p=null!==(t=null===d||void 0===d?void 0:d.role)&&void 0!==t?t:"tutor",[f,m]=(0,l.useState)(),[g,v]=(0,l.useState)(()=>function(e){const t=Ga(e),n=(t.getDay()+6)%7;return t.setDate(t.getDate()-n),Ya(t)}(Ya(new Date))),[y,b]=(0,l.useState)([]),[w,x]=(0,l.useState)(null),[S,k]=(0,l.useState)(!1),[_,j]=(0,l.useState)(0),[N,E]=(0,l.useState)(null),[C,T]=(0,l.useState)(null),[I,P]=(0,l.useState)(!1),[A,R]=(0,l.useState)(""),[D,L]=(0,l.useState)(new Date);(0,l.useEffect)(()=>{const e=setInterval(()=>L(new Date),6e4);return()=>clearInterval(e)},[]);const O=(0,l.useMemo)(()=>{var e,t,n,r,a,s,o,i;return{userId:(null===(e=u.user)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.sub)||"unknown",name:(null===(n=u.user)||void 0===n||null===(r=n.profile)||void 0===r?void 0:r.name)||(null===(a=u.user)||void 0===a||null===(s=a.profile)||void 0===s?void 0:s.nickname)||"Usuario",email:(null===(o=u.user)||void 0===o||null===(i=o.profile)||void 0===i?void 0:i.email)||"No email",role:"student"}},[u.user]);(0,l.useEffect)(()=>{if(u.isAuthenticated&&u.user){var e,t;const n=null===(e=u.user)||void 0===e?void 0:e.id_token,r=null===(t=u.user)||void 0===t?void 0:t.access_token;m(null!==n&&void 0!==n?n:r)}else m(void 0)},[u.isAuthenticated,u.user]),(0,l.useEffect)(()=>{if(!f)return;(async()=>{try{const e=await Hr.getStudentBalance(f);j(e.tokenBalance)}catch(Is){console.error("Error cargando balance:",Is)}})()},[f]),(0,l.useEffect)(()=>{const e=Number(null===h||void 0===h?void 0:h.tokensPerHour);if(!f||!e||e<=0)return T(null),void R("");let t=!1;return(async()=>{P(!0),R("");try{const n=await Hr.checkStudentTokens(e,f);t||T({hasEnoughTokens:!!n.hasEnoughTokens,requiredTokens:Number(n.requiredTokens),currentBalance:Number(n.currentBalance)})}catch(n){t||R((null===n||void 0===n?void 0:n.message)||"Error verificando tokens")}finally{t||P(!1)}})(),()=>{t=!0}},[f,h]);const U=(0,l.useMemo)(()=>(null===h||void 0===h?void 0:h.userId)||(null===h||void 0===h?void 0:h.sub)||o,[h,o]);(0,l.useEffect)(()=>{(async()=>{if(f&&U){k(!0),x(null),E(null);try{const e=await Rr(U,g,f);b(e)}catch(e){const t=await async function(e,t,n){return Rr(e,t,n)}(U,g,f);b(t)}finally{k(!1)}}})()},[f,U,g]);let M="";N&&(M="success"===N.type?"\u2705":"warning"===N.type?"\u26a0\ufe0f":"\u274c");return(0,xr.jsxs)("div",{className:"dashboard-container",children:[(0,xr.jsx)(Jr,{currentUser:O,onSectionChange:e=>{c("/student-dashboard?tab=".concat(e))},tokenBalance:_}),(0,xr.jsx)("main",{className:"dashboard-main",children:(0,xr.jsxs)("div",{style:{padding:16,maxWidth:1100,margin:"0 auto"},children:[N&&(0,xr.jsxs)("div",{style:(z=N.type,"success"===z?{margin:"12px 0",padding:"12px 16px",background:"#ECFDF5",border:"1px solid #A7F3D0",borderRadius:"8px",color:"#065F46",fontWeight:500,display:"flex",gap:8,alignItems:"center"}:"warning"===z?{margin:"12px 0",padding:"12px 16px",background:"#FFFBEB",border:"1px solid #FDE68A",borderRadius:"8px",color:"#92400E",fontWeight:500,display:"flex",gap:8,alignItems:"center"}:{margin:"12px 0",padding:"12px 16px",background:"#FEF2F2",border:"1px solid #FECACA",borderRadius:"8px",color:"#991B1B",fontWeight:500,display:"flex",gap:8,alignItems:"center"}),children:[(0,xr.jsx)("span",{"aria-hidden":!0,children:M}),(0,xr.jsx)("span",{children:N.text})]}),(0,xr.jsxs)("section",{className:"card compact-profile",children:[(0,xr.jsx)("div",{className:"compact-profile__left",children:(0,xr.jsx)("div",{className:"avatar-bubble",children:"\ud83d\udc68\u200d\ud83c\udfeb"})}),(0,xr.jsxs)("div",{className:"compact-profile__body",children:[(0,xr.jsx)("h2",{className:"compact-profile__name",children:null!==(n=h.name)&&void 0!==n?n:"Usuario"}),"student"===p?(0,xr.jsxs)("div",{className:"compact-profile__block",children:[(0,xr.jsx)("h4",{children:"Informaci\xf3n acad\xe9mica"}),(0,xr.jsxs)("div",{children:["\u2022 Nivel educativo: ",null!==(r=null===h||void 0===h?void 0:h.educationLevel)&&void 0!==r?r:"\u2014"]})]}):(0,xr.jsxs)(xr.Fragment,{children:[h.bio&&(0,xr.jsxs)("div",{className:"compact-profile__block",children:[(0,xr.jsx)("h4",{children:"Biograf\xeda"}),(0,xr.jsx)("p",{children:h.bio})]}),(0,xr.jsxs)("div",{className:"compact-profile__block",children:[(0,xr.jsx)("h4",{children:"Especializaciones"}),(0,xr.jsx)("div",{className:"tags-container",children:null!==(a=h.specializations)&&void 0!==a&&a.length?h.specializations.map((e,t)=>(0,xr.jsxs)("span",{className:"tag specialization-tag ".concat(e.verified?"verified":"manual"),title:e.verified?"Verificado por IA - ".concat(e.source):"Agregado manualmente",children:[e.verified&&(0,xr.jsx)("span",{className:"verified-icon",children:"\u2713"}),e.name]},"".concat(e.name,"-").concat(t))):"\u2014"})]}),(0,xr.jsxs)("div",{className:"compact-profile__block",children:[(0,xr.jsx)("h4",{children:"Credenciales"}),(0,xr.jsx)("div",{className:"tags-container",children:null!==(s=h.credentials)&&void 0!==s&&s.length?h.credentials.map(e=>(0,xr.jsx)("span",{className:"tag",children:e},e)):"\u2014"})]}),(0,xr.jsxs)("div",{className:"compact-profile__block",children:[(0,xr.jsx)("h4",{children:"Tarifa"}),(0,xr.jsx)("p",{children:Number(null===h||void 0===h?void 0:h.tokensPerHour)>0?"".concat(h.tokensPerHour," tokens/hora"):"\u2014 (sin definir)"}),Number(null===h||void 0===h?void 0:h.tokensPerHour)>0&&(0,xr.jsxs)("div",{style:{fontSize:13},children:[I&&(0,xr.jsx)("p",{children:"Verificando saldo..."}),A&&(0,xr.jsx)("p",{style:{color:"#991B1B"},children:A}),C&&!I&&(0,xr.jsxs)("p",{children:["Saldo: ",(0,xr.jsx)("strong",{children:C.currentBalance})," tokens \u2014 ",C.hasEnoughTokens?"\u2705 suficiente":"\u274c insuficiente"]})]})]})]})]})]}),(0,xr.jsxs)("section",{className:"card action-strip",children:[(0,xr.jsx)("div",{className:"action-strip__left",children:w?(0,xr.jsxs)(xr.Fragment,{children:["Seleccionado: ",(0,xr.jsxs)("strong",{children:[w.date," ",w.hour]})]}):"Selecciona una hora disponible"}),(0,xr.jsxs)("div",{className:"action-strip__right",children:[(0,xr.jsx)("button",{className:"btn btn-secondary",onClick:()=>c(-1),children:"Volver"}),(0,xr.jsx)("button",{className:"btn btn-primary",onClick:async()=>{var e,t;if(!w||!f||!U)return;const n=null===(e=u.user)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.sub;if(n&&U&&n===U)return void E({type:"warning",text:"No te puedes reservar a ti mismo."});if(!globalThis.confirm("Confirmar reserva el ".concat(w.date," a las ").concat(w.hour,"?")))return;if(Number(null===h||void 0===h?void 0:h.tokensPerHour)>0&&C&&!C.hasEnoughTokens)E({type:"error",text:"No tienes suficientes tokens (saldo ".concat(C.currentBalance,", requiere ").concat(C.requiredTokens,"). Compra tokens antes de reservar.")});else try{await Tr(U,w.date,w.hour,f),E({type:"success",text:"\xa1Reserva creada correctamente!"}),setTimeout(()=>c("/student-dashboard?tab=my-reservations",{replace:!0}),900)}catch(Is){const t=String((null===Is||void 0===Is?void 0:Is.message)||"").toLowerCase();t.includes("tutor no puede ser el mismo")||t.includes("no puede ser el mismo que el estudiante")?E({type:"warning",text:"No te puedes reservar a ti mismo."}):E({type:"error",text:(null===Is||void 0===Is?void 0:Is.message)||"Error creando la reserva."})}},disabled:!w||Number(null===h||void 0===h?void 0:h.tokensPerHour)>0&&!!C&&!C.hasEnoughTokens,children:"Confirmar Reserva"})]})]}),(0,xr.jsxs)("section",{className:"card week-nav week-nav--highlight",children:[(0,xr.jsx)("button",{className:"btn btn-ghost",onClick:()=>v(Za(g,-7)),children:"\u25c0 Semana anterior"}),(0,xr.jsxs)("div",{className:"week-nav__title",children:["Semana ",g," \u2014 ",Za(g,6)]}),(0,xr.jsx)("button",{className:"btn btn-ghost",onClick:()=>v(Za(g,7)),children:"Siguiente semana \u25b6"})]}),(0,xr.jsx)("section",{className:"calendar-container card",style:{padding:12},children:S?(0,xr.jsx)("div",{style:{padding:20},children:"Cargando disponibilidad..."}):(0,xr.jsxs)("div",{className:"calendar-grid",children:[(0,xr.jsxs)("div",{className:"col hour-col",children:[(0,xr.jsx)("div",{className:"head-cell",children:"Hora"}),Array.from({length:24},(e,t)=>String(t).padStart(2,"0")+":00").map(e=>(0,xr.jsx)("div",{className:"hour-cell",children:e},e))]}),Array.from({length:7},(e,t)=>t).map(e=>{const t=Za(g,e);return(0,xr.jsxs)("div",{className:"col",children:[(0,xr.jsxs)("div",{className:"head-cell",children:[["Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b","Dom"][e],(0,xr.jsx)("br",{}),t.slice(5)]}),Array.from({length:24},(e,t)=>String(t).padStart(2,"0")+":00").map(e=>{const n=y.find(n=>n.date===t&&n.hour===e);return(0,xr.jsx)(Xa,{cellData:n,date:t,hour:e,now:D,isSelected:(null===w||void 0===w?void 0:w.date)===t&&(null===w||void 0===w?void 0:w.hour)===e,onSelect:()=>{x({date:t,hour:e,status:"DISPONIBLE",reservationId:null,studentId:null}),E(null)}},"".concat(t,"_").concat(e))})]},t)})]})})]})})]});var z};function ts(e){let{onOpen:t}=e;return(0,xr.jsxs)("button",{type:"button",className:"call-chat-button",onClick:()=>{globalThis.dispatchEvent(new CustomEvent("open-chat-drawer")),null===t||void 0===t||t()},children:[(0,xr.jsx)("span",{className:"call-chat-icon",children:"\ud83d\udcac"}),(0,xr.jsx)("span",{className:"call-chat-label",children:"Chat"})]})}function ns(e){let{onToggleMic:t,onToggleCam:n,onShareScreen:r,onEnd:a}=e;const[s,o]=(0,l.useState)(!0),[i,c]=(0,l.useState)(!0),[u,d]=(0,l.useState)(!1);return(0,xr.jsxs)("div",{className:"call-controls-group",children:[(0,xr.jsx)("button",{onClick:()=>{o(!s),t()},className:"call-btn ".concat(s?"":"off"),title:s?"Apagar micr\xf3fono":"Encender micr\xf3fono",children:s?(0,xr.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,xr.jsx)("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),(0,xr.jsx)("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),(0,xr.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),(0,xr.jsx)("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}):(0,xr.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,xr.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),(0,xr.jsx)("path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"}),(0,xr.jsx)("path",{d:"M19 10v2a7 7 0 0 1-2.9 5.69M5 10v2a7 7 0 0 0 11.08 5.76"}),(0,xr.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),(0,xr.jsx)("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]})}),(0,xr.jsx)("button",{onClick:()=>{c(!i),n()},className:"call-btn ".concat(i?"":"off"),title:i?"Apagar c\xe1mara":"Encender c\xe1mara",children:i?(0,xr.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,xr.jsx)("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),(0,xr.jsx)("circle",{cx:"12",cy:"13",r:"4"})]}):(0,xr.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,xr.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),(0,xr.jsx)("path",{d:"M21 21H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3m3-3h6l2 3h4a2 2 0 0 1 2 2v9.34m-7.72-2.06a4 4 0 1 1-5.56-5.56"})]})}),(0,xr.jsx)("button",{onClick:()=>{d(!u),r()},className:"call-btn ".concat(u?"active-share":""),title:"Compartir pantalla",children:(0,xr.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,xr.jsx)("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),(0,xr.jsx)("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),(0,xr.jsx)("line",{x1:"12",y1:"17",x2:"12",y2:"21"}),(0,xr.jsx)("path",{d:"m16 8-4-4-4 4"})]})}),(0,xr.jsx)("div",{style:{width:1,background:"rgba(255,255,255,0.2)",margin:"0 4px",height:"32px"}}),(0,xr.jsx)("button",{onClick:a,className:"call-btn danger",title:"Finalizar llamada",children:(0,xr.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,xr.jsx)("path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"}),(0,xr.jsx)("line",{x1:"23",y1:"1",x2:"1",y2:"23"})]})})]})}function rs(e){return null!==e&&void 0!==e?e:""}const as="data:text/vtt;base64,V0VCVlRUCgoxCjAwOjAwOjAwMC4wMDAgLS0+IDAwOjAwOjAxMC4wMDAKQXVkaW8gZW4gdml2bw==";function ss(e){let{show:t,onClose:n,onSubmit:r,callDurationSec:a,metrics:s,callerRole:o,peerId:i}=e;const[c,u]=(0,l.useState)(0),[d,h]=(0,l.useState)(""),[p,f]=(0,l.useState)(!1),m="student"===o;return t?(0,xr.jsx)("div",{className:"call-summary-backdrop",style:{zIndex:50},children:(0,xr.jsxs)("div",{className:"call-summary-card",children:[(0,xr.jsx)("h2",{children:"Resumen de la llamada"}),(0,xr.jsxs)("p",{className:"call-summary-duration",children:[(0,xr.jsx)("strong",{children:"Duraci\xf3n de la llamada:"})," ",(e=>{if(!e||e<=0)return"No disponible (la llamada no lleg\xf3 a conectarse)";const t=Math.floor(e/60),n=e%60;return t?"".concat(t," min ").concat(n.toString().padStart(2,"0")," s"):"".concat(n," s")})(a)]}),s&&(0,xr.jsxs)("div",{className:"call-summary-metrics",children:[(0,xr.jsx)("h3",{children:"Calidad de conexi\xf3n (\xfaltimos 5 minutos)"}),(0,xr.jsxs)("ul",{children:[(0,xr.jsxs)("li",{children:[(0,xr.jsx)("strong",{children:"Conexi\xf3n t\xedpica:"})," la mayor\xeda de llamadas se conectan en aproximadamente ",(s.p95_ms/1e3).toFixed(1)," s (p95)."]}),(0,xr.jsxs)("li",{children:[(0,xr.jsx)("strong",{children:"Estabilidad:"})," ",(100*s.successRate5m).toFixed(0),"% de las llamadas recientes se conectan correctamente."]}),(0,xr.jsxs)("li",{children:[(0,xr.jsx)("strong",{children:"Muestras analizadas:"})," ",s.samples]})]})]}),m&&(0,xr.jsxs)("div",{className:"call-summary-rating",children:[(0,xr.jsx)("h3",{children:"Califica a tu tutor"}),(0,xr.jsx)("div",{className:"star-rating",children:[1,2,3,4,5].map(e=>(0,xr.jsx)("button",{type:"button",className:"star ".concat(e<=c?"active":""),onClick:()=>u(e),"aria-label":"".concat(e," estrellas"),children:"\u2605"},e))}),(0,xr.jsx)("textarea",{value:d,onChange:e=>h(e.target.value),placeholder:"\xbfAlgo que quieras comentar sobre la tutor\xeda?",rows:3})]}),!m&&(0,xr.jsx)("p",{style:{marginTop:12},children:"Esta rese\xf1a est\xe1 pensada para que el estudiante califique al tutor. Solo ver\xe1s el resumen de la llamada."}),(0,xr.jsxs)("div",{className:"call-summary-actions",children:[(0,xr.jsx)("button",{type:"button",className:"btn btn-ghost",onClick:n,children:"Volver sin calificar"}),(0,xr.jsx)("button",{type:"button",className:"btn btn-primary",onClick:async()=>{if(m){f(!0);try{await r(c,d),n()}finally{f(!1)}}else n()},disabled:p||m&&0===c,children:p?"Enviando\u2026":"Guardar y volver"})]})]})}):null}function os(e){let{status:t,isFullscreen:n,showUi:r,isChatOpen:a,showSummary:s,chatContact:o,userId:c,token:u,callDurationSec:d,metrics:h,callerRole:p,peerId:f,remoteContainerRef:m,localVideoRef:g,remoteVideoRef:v,remoteAudioRef:y,bumpUiVisible:b,handleContainerKeyDown:w,toggleFullscreen:x,toggleMic:S,toggleCam:k,shareScreen:_,endCall:j,setIsChatOpen:N,handleCloseSummary:E,handleSubmitRating:C,navigate:T}=e;const{uiVisibilityStyle:I,containerStyle:P,videoStyle:A,fullscreenButtonStyle:R,localVideoWrapperStyle:D}=function(e,t){return(0,l.useMemo)(()=>{const n={opacity:e&&!t?0:1,pointerEvents:e&&!t?"none":"auto"};return{uiVisibilityStyle:n,containerStyle:e?{backgroundColor:"black"}:void 0,videoStyle:e?{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",objectFit:"contain",zIndex:0,backgroundColor:"#000"}:{},fullscreenButtonStyle:i(i({},n),{},{zIndex:20,position:e?"fixed":"absolute",top:e?"16px":"12px",right:e?"16px":"12px"}),localVideoWrapperStyle:{zIndex:15,position:e?"fixed":"absolute",top:e?"auto":void 0,bottom:e?"16px":void 0,right:e?"16px":void 0}}},[e,t])}(n,r);return(0,xr.jsxs)("div",{className:"call-page-container",ref:m,onMouseMove:b,onTouchStart:b,role:"button",tabIndex:0,onKeyDown:w,"aria-label":"\xc1rea de llamada, muestra controles al interactuar",style:P,children:[(0,xr.jsxs)("div",{className:"call-header",style:i(i({},I),{},{zIndex:10}),children:[(0,xr.jsx)("h1",{children:"Sesi\xf3n de llamada"}),(0,xr.jsxs)("div",{className:"call-meta",children:[(0,xr.jsxs)("div",{className:"status-badge",children:[(0,xr.jsx)("span",{className:"status-dot ".concat((L=t,"connected"===L?"connected":"failed"===L||"closed"===L?"failed":""))}),(0,xr.jsx)("span",{children:t})]}),(0,xr.jsx)(ts,{})]})]}),(0,xr.jsx)("div",{className:"video-grid",children:(0,xr.jsxs)("div",{className:"remote-video-wrapper",children:[(0,xr.jsx)("video",{ref:v,className:"remote-video",autoPlay:!0,playsInline:!0,muted:!0,style:A,children:(0,xr.jsx)("track",{kind:"captions",src:as,srcLang:"es",label:"V\xeddeo remoto (silenciado)"})}),(0,xr.jsx)("button",{type:"button",className:"fullscreen-toggle",style:R,onClick:x,"aria-label":n?"Salir de pantalla completa":"Ver en pantalla completa",children:"\u26f6"}),(0,xr.jsx)("div",{className:"local-video-wrapper",style:D,children:(0,xr.jsx)("video",{ref:g,className:"local-video",autoPlay:!0,playsInline:!0,muted:!0,children:(0,xr.jsx)("track",{kind:"captions",src:as,srcLang:"es",label:"V\xeddeo local (silenciado)"})})})]})}),(0,xr.jsx)("div",{className:"controls-dock",style:i(i({},I),{},{zIndex:10}),children:(0,xr.jsx)(ns,{onToggleMic:S,onToggleCam:k,onShareScreen:_,onEnd:j})}),(0,xr.jsx)("audio",{ref:y,style:{display:"none"},autoPlay:!0,"aria-label":"Audio remoto",children:(0,xr.jsx)("track",{kind:"captions",src:as,srcLang:"es",label:"Audio remoto (en vivo)"})}),a&&o&&c&&u&&(0,xr.jsxs)("aside",{className:"chat-side-panel call-chat-panel",style:{zIndex:30},children:[(0,xr.jsx)("button",{className:"close-chat-btn",onClick:()=>N(!1),type:"button","aria-label":"Cerrar chat",children:"\xd7"}),(0,xr.jsx)(Da,{contact:o,myUserId:c,token:u})]}),(0,xr.jsx)(ss,{show:s,onClose:E,onSubmit:C,callDurationSec:d,metrics:h,callerRole:p,peerId:f}),"closed"===t&&!s&&(0,xr.jsx)("div",{className:"call-summary-backdrop",style:{zIndex:60},children:(0,xr.jsxs)("div",{className:"call-summary-card",style:{maxWidth:"400px",textAlign:"center",padding:"30px"},children:[(0,xr.jsx)("h3",{style:{marginBottom:"16px"},children:"Llamada finalizada"}),(0,xr.jsx)("p",{style:{marginBottom:"24px",fontSize:"1.1rem",color:"#ccc"},children:"El otro usuario tuvo problemas con la conexi\xf3n, int\xe9ntalo de nuevo."}),(0,xr.jsx)("button",{type:"button",className:"btn btn-primary",style:{width:"100%",justifyContent:"center"},onClick:()=>T(-1),children:"Ok"})]})})]});var L}function is(){const{sessionId:e}=ge(),t=he(),n=me(),r=(0,l.useMemo)(()=>new URLSearchParams(t.search),[t.search]),a=dr(),s=(0,l.useMemo)(()=>{var e,t;return(null===(e=a.user)||void 0===e?void 0:e.id_token)||(null===(t=a.user)||void 0===t?void 0:t.access_token)||""},[a.user]),o=(0,l.useMemo)(()=>{var e,t,n,r,s,o;return(null===(e=a.user)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.sub)||(null===(n=a.user)||void 0===n||null===(r=n.profile)||void 0===r?void 0:r.userId)||(null===(s=a.user)||void 0===s||null===(o=s.profile)||void 0===o?void 0:o.preferred_username)||""},[a.user]),c=(0,l.useRef)(null),u=(0,l.useRef)(null),[d,h]=(0,l.useState)(null),[p,f]=(0,l.useState)(null),[m,g]=(0,l.useState)(!1),[v,y]=(0,l.useState)(null),[b,w]=(0,l.useState)(!1),{peerId:x,peerName:S,peerEmail:k,peerAvatar:_,role:j}=t.state||{},{isFullscreen:N,showUi:E,bumpUiVisible:C,toggleFullscreen:T}=function(e){const[t,n]=(0,l.useState)(!1),[r,a]=(0,l.useState)(!0),s=(0,l.useRef)(null),o=(0,l.useCallback)(()=>{a(!0),s.current&&(globalThis.clearTimeout(s.current),s.current=null),document.fullscreenElement&&(s.current=globalThis.setTimeout(()=>a(!1),3e3))},[]),i=(0,l.useCallback)(()=>{const t=e.current;if(!t)return;const r=document;var i,l;document.fullscreenElement?null===(i=r.exitFullscreen)||void 0===i||i.call(r).then(()=>{n(!1),a(!0),s.current&&(globalThis.clearTimeout(s.current),s.current=null)}).catch(()=>{}):null===(l=t.requestFullscreen)||void 0===l||l.call(t).then(()=>{n(!0),a(!0),o()}).catch(()=>{})},[e,o]);return(0,l.useEffect)(()=>{const e=()=>{const e=!!document.fullscreenElement;n(e),a(!0),!e&&s.current?(globalThis.clearTimeout(s.current),s.current=null):e&&o()};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[o]),(0,l.useEffect)(()=>{if(!t)return;const e=()=>o(),n=document,r=["mousemove","mousedown","touchstart","keydown"];for(const t of r)n.addEventListener(t,e);return()=>{for(const t of r)n.removeEventListener(t,e)}},[t,o]),{isFullscreen:t,showUi:r,bumpUiVisible:o,toggleFullscreen:i}}(c),I=(0,l.useCallback)(()=>{const e=Date.now();u.current&&null==d&&h(Math.round((e-u.current)/1e3)),g(!0),async function(){const e=await fetch("".concat(Ca,"/api/calls/metrics"),{headers:{Accept:"application/json"}});if(!e.ok)throw new Error("Error ".concat(e.status," al obtener m\xe9tricas"));return e.json()}().then(f).catch(()=>{})},[d]),{status:P,localVideoRef:A,remoteVideoRef:R,remoteAudioRef:D,endCall:L,toggleMic:O,toggleCam:U,shareScreen:M}=function(e){let{token:t,userId:n,sessionIdParam:r,reservationIdParam:a,onCallEnded:s,onConnected:o}=e;const c=me(),[u,d]=(0,l.useState)("idle"),[h,p]=(0,l.useState)(r),[f,m]=(0,l.useState)(a||void 0),[g,v]=(0,l.useState)(!1),y=(0,l.useRef)(null),b=(0,l.useRef)(null),w=(0,l.useRef)(null),x=(0,l.useRef)(null),S=(0,l.useRef)(null),k=(0,l.useRef)(null),_=(0,l.useRef)(null),j=(0,l.useRef)(h),N=(0,l.useRef)(f);(0,l.useEffect)(()=>{j.current=h},[h]),(0,l.useEffect)(()=>{N.current=f},[f]);const E=(0,l.useRef)(!1),C=(0,l.useRef)(!1),T=(0,l.useRef)(!1),I=(0,l.useRef)(!1),P=(0,l.useRef)(!1),A=(0,l.useRef)(!1),R=(0,l.useRef)(!1),D=(0,l.useRef)(!1),L=(0,l.useRef)(!1),O=(0,l.useRef)(null),U=(0,l.useRef)([]),M=(0,l.useRef)(!1),z=(0,l.useRef)(0),F=(0,l.useRef)(!1),H=(0,l.useRef)(!1),B=(0,l.useRef)(null),W=(0,l.useRef)(null),V=(0,l.useCallback)((e,t)=>{console.log("[CALL]",e,null!==t&&void 0!==t?t:"")},[]),q=(0,l.useCallback)(e=>{const t=S.current;if(!t||t.readyState!==WebSocket.OPEN||!j.current)return;const r=i({type:e.type,sessionId:j.current,reservationId:N.current,from:n,ts:Date.now()},e);try{t.send(JSON.stringify(r)),"HEARTBEAT"!==r.type&&V("WS SEND",{type:r.type,sessionId:r.sessionId})}catch(Is){console.warn("[CALL] WS send failed",Is)}},[V,n]),K=(0,l.useCallback)(()=>{var e;if(V("cleanup()"),F.current=!0,O.current&&globalThis.clearInterval(O.current),B.current&&globalThis.clearTimeout(B.current),W.current&&globalThis.clearInterval(W.current),O.current=null,B.current=null,W.current=null,v(!1),null===(e=S.current)||void 0===e||e.close(),S.current=null,E.current=!1,C.current=!1,T.current=!1,I.current=!1,P.current=!1,A.current=!1,R.current=!1,D.current=!1,L.current=!1,U.current=[],z.current=0,x.current){for(const e of x.current.getSenders())e.track&&e.track.stop();x.current.close(),x.current=null}if(k.current){for(const e of k.current.getTracks())e.stop();k.current=null}if(_.current){for(const e of _.current.getTracks())e.stop();_.current=null}d("closed")},[V]),$=(0,l.useCallback)(()=>{L.current||(L.current=!0,q({type:"RTC_CONNECTED"}))},[q]),J=(0,l.useCallback)(async()=>{const e=x.current;if(e&&T.current&&E.current&&C.current&&R.current&&D.current&&"stable"===e.signalingState&&!P.current)try{P.current=!0,V("maybeNegotiate: createOffer()",{signaling:e.signalingState});const t=await e.createOffer();t.sdp=rs(t.sdp),await e.setLocalDescription(t),q({type:"OFFER",payload:e.localDescription}),V("OFFER sent")}catch(Is){console.error("[CALL] Error creating offer",Is)}finally{P.current=!1}},[V,q]),Q=(0,l.useCallback)(async()=>{if(k.current)return k.current;try{const e={audio:!0,video:/Mobi|Android/i.test(navigator.userAgent)?{width:{ideal:640},height:{ideal:480},facingMode:"user"}:{width:{ideal:1280},height:{ideal:720}}},t=await navigator.mediaDevices.getUserMedia(e);return k.current=t,y.current&&(y.current.srcObject=t,y.current.play().catch(e=>console.warn("[CALL] local video play error",e))),t}catch(Is){return console.error("[CALL] Error acquiring media",Is),null}},[]),G=(0,l.useCallback)(async()=>{const e=x.current;if(!e)return;const t=await Q();if(!t)return void V("addTracksToPc: no localStream (solo recibir\xe1 medios)");const n=e.getSenders(),r=r=>{const a="audio"===r?t.getAudioTracks()[0]:t.getVideoTracks()[0];if(!a)return;let s=n.find(e=>e.track&&e.track.kind===r);s?s.replaceTrack(a):e.addTrack(a,t)};var a,s;(r("audio"),r("video"),D.current=t.getAudioTracks().length>0||t.getVideoTracks().length>0,T.current&&D.current&&E.current&&C.current&&R.current&&"stable"===e.signalingState)&&(null===(a=(s=e).__maybeNegotiate)||void 0===a||a.call(s))},[Q,V]),Y=(0,l.useCallback)(async()=>{const e=function(e){const t=[],n=(e,n)=>{const r=(e||"").trim();if(!(e=>/^(stun:|turns?:)/i.test(e)&&!e.trim().startsWith("#")&&!e.trim().startsWith("//"))(r))return;const a={urls:r};null!==n&&void 0!==n&&n.username&&(a.username=n.username),null!==n&&void 0!==n&&n.credential&&(a.credential=n.credential),t.push(a)},r=e=>{if("string"===typeof e)n(e);else if(e&&"object"===typeof e){var t;const r=null!==(t=e.urls)&&void 0!==t?t:e.url;if(Array.isArray(r))for(const t of r)n(t,e);else"string"===typeof r&&n(r,e)}};if(Array.isArray(e))for(const a of e)r(a);else r(e);return t.length||t.push({urls:"stun:stun.l.google.com:19302"}),t}(await async function(){const e=await fetch("".concat(Ca,"/api/calls/ice-servers"));if(!e.ok)return[{urls:"stun:stun.l.google.com:19302"}];const t=await e.text();try{const e=JSON.parse(t);return Array.isArray(e)?e:[{urls:"stun:stun.l.google.com:19302"}]}catch(n){return[{urls:"stun:stun.l.google.com:19302"}]}}().catch(()=>[])),t=new RTCPeerConnection({iceServers:e,bundlePolicy:"max-bundle",iceTransportPolicy:"all",iceCandidatePoolSize:2});return x.current=t,_.current=new MediaStream,t.ontrack=e=>{const t=_.current;t.getTracks().some(t=>t.id===e.track.id)||t.addTrack(e.track),b.current&&"video"===e.track.kind&&(b.current.srcObject=t),w.current&&"audio"===e.track.kind&&(w.current.srcObject=t)},t.onicecandidate=e=>{E.current&&C.current&&e.candidate&&q({type:"ICE_CANDIDATE",payload:e.candidate})},t.oniceconnectionstatechange=()=>{const e=t.iceConnectionState;"connected"===e||"completed"===e?(H.current=!0,g&&(v(!1),B.current&&globalThis.clearTimeout(B.current),W.current&&globalThis.clearInterval(W.current),B.current=null,W.current=null),d("connected"),o(),$()):"disconnected"===e?d("connecting"):"failed"===e&&d("failed")},t.onnegotiationneeded=()=>{J()},t.__maybeNegotiate=J,t},[g,J,$,o,q]),Z=(0,l.useCallback)(async e=>{const t=e.payload||{};T.current=!!t.initiator,I.current=!t.initiator,C.current=!0,e.sessionId&&p(e.sessionId),e.reservationId&&m(e.reservationId),await G()},[G]),X=(0,l.useCallback)(()=>{var e,t;R.current=!0,B.current&&globalThis.clearTimeout(B.current),W.current&&globalThis.clearInterval(W.current),B.current=null,W.current=null,g&&v(!1),d("connecting"),T.current&&D.current&&(null===(e=x.current)||void 0===e||null===(t=e.__maybeNegotiate)||void 0===t||t.call(e))},[g]),ee=(0,l.useCallback)(()=>{R.current=!1,H.current&&!g?(v(!0),d("connecting"),B.current&&globalThis.clearTimeout(B.current),W.current&&globalThis.clearInterval(W.current),W.current=globalThis.setInterval(()=>V("Esperando reconexi\xf3n..."),6e3),B.current=globalThis.setTimeout(()=>{W.current&&globalThis.clearInterval(W.current),B.current=null,v(!1),K(),globalThis.alert("El otro usuario no pudo reconectarse."),c(-1)},12e4)):d("connecting")},[K,g,V,c]),te=(0,l.useCallback)(async e=>{await G();const t=x.current,n=e.payload,r="offer"===n.type&&(P.current||"stable"!==t.signalingState);if(A.current=r&&!I.current,A.current)return;r&&I.current&&await t.setLocalDescription({type:"rollback"}),await t.setRemoteDescription(n);for(const s of U.current)await t.addIceCandidate(s).catch(e=>console.error(e));U.current=[];const a=await t.createAnswer();a.sdp=rs(a.sdp),await t.setLocalDescription(a),q({type:"ANSWER",payload:t.localDescription})},[G,q]),ne=(0,l.useCallback)(async e=>{const t=x.current;try{await t.setRemoteDescription(e.payload);for(const e of U.current)await t.addIceCandidate(e).catch(e=>console.error(e));U.current=[]}catch(Is){console.error("[CALL] Error applying ANSWER",Is)}},[]),re=(0,l.useCallback)(async e=>{const t=x.current;if(A.current||!e.payload)return;const n=new RTCIceCandidate(e.payload);t.remoteDescription&&"rollback"!==t.remoteDescription.type?await t.addIceCandidate(n).catch(e=>console.error(e)):U.current.push(n)},[]),ae=(0,l.useCallback)(async e=>{if(!x.current)return;const t=JSON.parse(e.data);var r,a;if("ERROR"===t.type)return console.error("[CALL] WS ERROR:",(null===(r=t.payload)||void 0===r?void 0:r.message)||"Error desconocido"),F.current=!0,d("failed"),void(null===(a=S.current)||void 0===a||a.close());if((t.from!==n||"JOIN_ACK"===t.type)&&(!t.sessionId||!j.current||t.sessionId===j.current||"JOIN_ACK"===t.type))switch(t.type){case"JOIN_ACK":await Z(t);break;case"PEER_JOINED":X();break;case"PEER_LEFT":ee();break;case"OFFER":await te(t);break;case"ANSWER":await ne(t);break;case"ICE_CANDIDATE":await re(t);break;case"END":K(),s()}},[n,Z,X,ee,te,ne,re,K,s]),se=(0,l.useCallback)(async()=>{d("connecting"),F.current=!1,await Y(),await G();const e=new WebSocket("".concat("https:"===globalThis.location.protocol?"wss":"ws","://calls-b7f6fcdpbvdxcmeu.chilecentral-01.azurewebsites.net/ws/call?token=").concat(encodeURIComponent(t)));S.current=e,e.onopen=async()=>{E.current=!0,z.current=0;let r=j.current;if(!r){if(!N.current)return void console.error("[CALL] Falta reservationId");const e=await Ta(N.current,t);r=e.sessionId,p(r),m(e.reservationId)}e.send(JSON.stringify({type:"JOIN",sessionId:r,reservationId:N.current,from:n,ts:Date.now()})),O.current=globalThis.setInterval(()=>q({type:"HEARTBEAT"}),1e4)},e.onmessage=ae,e.onclose=()=>{if(S.current=null,E.current=!1,!F.current){if(O.current&&globalThis.clearInterval(O.current),O.current=null,x.current){for(const e of x.current.getSenders())e.track&&e.track.stop();x.current.close(),x.current=null}if(_.current=null,D.current=!!k.current,z.current+=1,z.current>3)return d("failed"),globalThis.alert("No se pudo reconectar. Int\xe9ntalo de nuevo."),void c(-1);d("connecting"),globalThis.setTimeout(()=>{F.current||se()},2e3)}},e.onerror=e=>{console.error("[CALL] WS error",e),d("failed")}},[G,Y,ae,q,t,n,c]),oe=(0,l.useCallback)(()=>{q({type:"END"}),K(),s()},[q,K,s]),ie=(0,l.useCallback)(()=>{var e;const t=null===(e=k.current)||void 0===e?void 0:e.getAudioTracks()[0];t&&(t.enabled=!t.enabled)},[]),le=(0,l.useCallback)(()=>{var e;const t=null===(e=k.current)||void 0===e?void 0:e.getVideoTracks()[0];t&&(t.enabled=!t.enabled)},[]),ce=(0,l.useCallback)(async()=>{const e=x.current;if(e)try{var t,n;const r=(await navigator.mediaDevices.getDisplayMedia({video:!0})).getVideoTracks()[0];if(!r)return;const a=e.getSenders().find(e=>{var t;return"video"===(null===(t=e.track)||void 0===t?void 0:t.kind)})||e.getSenders().find(e=>!e.track);if(!a)return;await a.replaceTrack(r),D.current=!0,T.current&&E.current&&C.current&&R.current&&(null===(t=(n=e).__maybeNegotiate)||void 0===t||t.call(n)),r.onended=async()=>{var e;const t=(null===(e=k.current)||void 0===e?void 0:e.getVideoTracks()[0])||null;await a.replaceTrack(t)}}catch(Is){console.warn("[CALL] shareScreen error",Is),globalThis.alert("No se pudo compartir la pantalla.")}},[]);return(0,l.useEffect)(()=>{if(M.current||!t||!n)return;M.current=!0,z.current=0,se();const e=()=>K();return globalThis.addEventListener("beforeunload",e),()=>{e(),globalThis.removeEventListener("beforeunload",e)}},[K,se,t,n]),{status:u,localVideoRef:y,remoteVideoRef:b,remoteAudioRef:w,endCall:oe,toggleMic:ie,toggleCam:le,shareScreen:ce}}({token:s,userId:o,sessionIdParam:e,reservationIdParam:r.get("reservationId"),onCallEnded:I,onConnected:()=>{u.current||(u.current=Date.now())}});(0,l.useEffect)(()=>{x&&o&&s&&y({id:x,sub:x,name:S||"Usuario",email:k||"N/A",avatarUrl:_})},[x,S,k,_,o,s]),(0,l.useEffect)(()=>{const e=()=>w(!0);return globalThis.addEventListener("open-chat-drawer",e),()=>globalThis.removeEventListener("open-chat-drawer",e)},[]);const z=(0,l.useCallback)(()=>{g(!1),n(-1)},[n]),F=(0,l.useCallback)(async(e,t)=>{console.log("Rating enviado",{rating:e,comment:t,sessionId:"N/A",reservationId:"N/A",peerId:x})},[x]);return(0,xr.jsx)(os,{status:P,isFullscreen:N,showUi:E,isChatOpen:b,showSummary:m,chatContact:v,userId:o,token:s,callDurationSec:d,metrics:p,callerRole:j,peerId:x,remoteContainerRef:c,localVideoRef:A,remoteVideoRef:R,remoteAudioRef:D,bumpUiVisible:C,handleContainerKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||C()},toggleFullscreen:T,toggleMic:O,toggleCam:U,shareScreen:M,endCall:L,setIsChatOpen:w,handleCloseSummary:z,handleSubmitRating:F,navigate:n})}function ls(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function cs(e,t){const n=new Date(e+"T00:00:00");return n.setDate(n.getDate()+t),ls(n)}function us(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}function ds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return new Date("".concat(e.date,"T").concat(us(e.end))).getTime()>=t.getTime()}function hs(e){const t=new Date,n=new Date("".concat(e.date,"T").concat(us(e.start))),r=new Date("".concat(e.date,"T").concat(us(e.end))),a=(e.status||"").toUpperCase();if("PENDIENTE"===a)return t>r?"VENCIDA":"PENDIENTE";if("ACEPTADO"===a){if(t>=n&&t<=r)return"ACTIVA";if(t>r){var s,o,i,l,c,u;const t=e,n=Boolean(null!==(s=null!==(o=null!==(i=t.studentAttended)&&void 0!==i?i:t.attendedStudent)&&void 0!==o?o:t.attendedByStudent)&&void 0!==s?s:t.attended),r=Boolean(null!==(l=null!==(c=null!==(u=t.tutorAttended)&&void 0!==u?u:t.attendedTutor)&&void 0!==c?c:t.attendedByTutor)&&void 0!==l?l:t.attended);return Boolean(t.hadCall||t.callStartedAt||t.callEndedAt||t.callDurationSec>0)||n&&r?"FINALIZADA":"INCUMPLIDA"}return"ACEPTADO"}return a}const ps=()=>{var e,t,n,r;const a=me(),s=dr(),[o,c]=(0,l.useState)();(0,l.useEffect)(()=>{var e,t,n;s.isAuthenticated&&s.user?c(null!==(e=null===(t=s.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=s.user)||void 0===n?void 0:n.access_token):c(void 0)},[s.isAuthenticated,s.user]);const{userRoles:u,isAuthenticated:d,needsRoleSelection:h}=wr();kr();const[p,f]=(0,l.useState)(null);(0,l.useEffect)(()=>{var e,t,n,r;null!==d&&null!==u&&(d?h?a("/role-selection"):null!==u&&void 0!==u&&u.includes("student")?s.user&&f({userId:(null===(e=s.user.profile)||void 0===e?void 0:e.sub)||"unknown",name:(null===(t=s.user.profile)||void 0===t?void 0:t.name)||(null===(n=s.user.profile)||void 0===n?void 0:n.nickname)||"Usuario",email:(null===(r=s.user.profile)||void 0===r?void 0:r.email)||"No email",role:"student"}):a("/"):a("/login"))},[d,u,h,a,s.user]);const[m,g]=(0,l.useState)(null),v=null===(e=s.user)||void 0===e?void 0:e.profile.sub,[y,b]=(0,l.useState)(()=>function(e){const t=new Date(e+"T00:00:00"),n=t.getDay(),r=(0===n?-6:1)-n;return t.setDate(t.getDate()+r),ls(t)}(ls(new Date))),[w,x]=(0,l.useState)([]),[S,k]=(0,l.useState)(!1),[_,j]=(0,l.useState)(!1),[N,E]=(0,l.useState)(1),[C,T]=(0,l.useState)(0),[I,P]=(0,l.useState)(!1),[A,R]=(0,l.useState)({}),D=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e,t,n;const r=null!==(e=null===(t=s.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=s.user)||void 0===n?void 0:n.access_token;r&&(async()=>{try{const e=await Hr.getStudentBalance(r);T(e.tokenBalance)}catch(e){}})()},[s.user]);const L=jr.USERS_BASE,O=jr.USERS_PROFILE_PATH,[U,M]=(0,l.useState)({}),z=async()=>{if(!o)return;const e=cs(y,-35),t=cs(y,35);try{k(!0);const n=(await Ir(e,t,o)).map(e=>i(i({},e),{},{effectiveStatus:hs(e)}));x(n)}catch(n){x([])}finally{k(!1)}};(0,l.useEffect)(()=>{o&&z()},[o]),(0,l.useEffect)(()=>{o&&z()},[y]);(0,l.useEffect)(()=>{const e=Array.from(new Set(w.map(e=>null===e||void 0===e?void 0:e.tutorId).filter(Boolean))).filter(e=>!U[e]);if(0===e.length||!o)return;let t=!1;return(async()=>{try{const n=await Promise.allSettled(e.map(e=>(async(e,t)=>{var n;const r={Accept:"application/json",Authorization:"Bearer ".concat(t)},a=async t=>{const n="".concat(L).concat(O,"?").concat(t,"=").concat(encodeURIComponent(e)),a=await fetch(n,{headers:r});return a.ok?a.json():null},s=null!==(n=await a("id"))&&void 0!==n?n:await a("sub");return{id:e,prof:s}})(e,o)));if(t)return;const r={};for(const e of n)if("fulfilled"===e.status&&e.value.prof){const{id:t,prof:n}=e.value;r[t]={id:null===n||void 0===n?void 0:n.id,sub:null===n||void 0===n?void 0:n.sub,name:(null===n||void 0===n?void 0:n.name)||(null===n||void 0===n?void 0:n.fullName)||"Tutor",email:null===n||void 0===n?void 0:n.email,avatarUrl:null===n||void 0===n?void 0:n.avatarUrl,tokensPerHour:null===n||void 0===n?void 0:n.tokensPerHour}}Object.keys(r).length>0&&M(e=>i(i({},e),r))}catch(n){}})(),()=>{t=!0}},[w,U,L,O,o]),(0,l.useEffect)(()=>{if(!o||!v)return;D.current&&(D.current.disconnect(),D.current=null);const e=new ha({autoReconnect:!0,pingIntervalMs:2e4});return D.current=e,e.connect(o,e=>{var t,n,r,a,s,o,l,c,u;const d=String(null!==(t=null!==(n=null!==(r=null!==(a=null===e||void 0===e?void 0:e.fromUserId)&&void 0!==a?a:null===e||void 0===e?void 0:e.senderId)&&void 0!==r?r:null===e||void 0===e?void 0:e.from)&&void 0!==n?n:null===e||void 0===e?void 0:e.userId)&&void 0!==t?t:""),h=String(null!==(s=null!==(o=null!==(l=null===e||void 0===e?void 0:e.toUserId)&&void 0!==l?l:null===e||void 0===e?void 0:e.recipientId)&&void 0!==o?o:null===e||void 0===e?void 0:e.to)&&void 0!==s?s:""),p=String(null!==(c=null!==(u=null===e||void 0===e?void 0:e.content)&&void 0!==u?u:null===e||void 0===e?void 0:e.text)&&void 0!==c?c:"");if(!d||!h||!p)return;const f=d===v?h:d;m&&m.id===f||R(e=>i(i({},e),{},{[f]:(e[f]||0)+1}))}),()=>{e.disconnect(),D.current=null}},[o,v,null===m||void 0===m?void 0:m.id]);const F=(0,l.useMemo)(()=>w.filter(e=>"CANCELADO"!==e.effectiveStatus&&ds(e)).length,[w]),H=w.filter(e=>{const t=new Date(e.date+"T00:00:00"),n=new Date(y+"T00:00:00"),r=new Date(cs(y,6)+"T23:59:59");return t>=n&&t<=r}),B=_?H:H.filter(e=>ds(e)),W=_?B:B.filter(e=>"CANCELADO"!==e.effectiveStatus),V=Math.max(1,Math.ceil(W.length/15)),q=W.slice(15*(N-1),15*N);(0,l.useEffect)(()=>{E(1)},[_,y]);if(s.isLoading)return(0,xr.jsx)("div",{className:"full-center",children:"\u23f3 Verificando acceso..."});if(!p)return(0,xr.jsx)("div",{className:"full-center",children:"\ud83d\udd0d Cargando informaci\xf3n..."});return(0,xr.jsxs)("div",{className:"dashboard-container",children:[(0,xr.jsx)(Wr,{isOpen:I,onClose:()=>P(!1),currentBalance:C,cognitoToken:null!==(t=null===(n=s.user)||void 0===n?void 0:n.id_token)&&void 0!==t?t:null===(r=s.user)||void 0===r?void 0:r.access_token}),(0,xr.jsx)(Jr,{currentUser:p,activeSection:"my-reservations",onSectionChange:e=>{"none"!==e&&Vr(a,e)},tokenBalance:C,onBuyTokensClick:()=>P(!0)}),(0,xr.jsx)("main",{className:"dashboard-main dashboard-main--tight",children:(0,xr.jsxs)("div",{className:"tasks-section",children:[(0,xr.jsx)("h1",{children:"Mis Reservas \ud83d\uddd3\ufe0f"}),(0,xr.jsxs)("div",{className:"stats-grid",style:{marginTop:8,marginBottom:16},children:[(0,xr.jsxs)("div",{className:"stat-card",children:[(0,xr.jsx)("div",{className:"stat-icon",children:"\ud83d\uddd3\ufe0f"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:F}),(0,xr.jsx)("p",{children:"Reservas presentes"})]})]}),(0,xr.jsxs)("div",{className:"stat-card",children:[(0,xr.jsx)("div",{className:"stat-icon",children:"\ud83e\uddd1\u200d\ud83c\udfeb"}),(0,xr.jsxs)("div",{className:"stat-info",children:[(0,xr.jsx)("h3",{children:new Set(w.map(e=>e.tutorId).filter(Boolean)).size}),(0,xr.jsx)("p",{children:"Tutores con solicitudes/reservas"})]})]})]}),(0,xr.jsxs)("div",{className:"page-with-chat-container",children:[(0,xr.jsx)("div",{className:"main-content ".concat(m?"chat-open":""),children:(0,xr.jsxs)("div",{className:"card card--primary-soft reservations-panel",children:[(0,xr.jsxs)("div",{className:"week-toolbar",children:[(0,xr.jsx)("button",{className:"btn btn-ghost btn-nav",onClick:()=>b(cs(y,-7)),type:"button",children:"\xab Anterior"}),(0,xr.jsxs)("div",{className:"week-toolbar__title",children:["Semana del ",y," al ",cs(y,6)]}),(0,xr.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,xr.jsx)("button",{className:"btn btn-nav",onClick:()=>j(!_),type:"button",style:{backgroundColor:"white",color:"#5b46d8"},children:_?"Mostrar presentes":"Mostrar todas"}),(0,xr.jsx)("button",{className:"btn btn-ghost btn-nav",onClick:()=>b(cs(y,7)),type:"button",children:"Siguiente \xbb"})]})]}),S&&(0,xr.jsx)("div",{className:"empty-note",children:"Cargando reservas\u2026"}),!S&&(0===W.length?(0,xr.jsx)("div",{className:"empty-note",children:_?"No tienes reservas esta semana.":"No tienes reservas activas esta semana."}):null),(0,xr.jsx)("div",{className:"reservations-list",children:q.map(e=>{const t=(e=>{const t=(e||"").toUpperCase();return{CANCELADO:{label:"CANCELADO",color:"#ef4444",bg:"rgba(239,68,68,.12)"},PENDIENTE:{label:"PENDIENTE",color:"#f59e0b",bg:"rgba(245,158,11,.12)"},ACEPTADO:{label:"ACEPTADA",color:"#10b981",bg:"rgba(16,185,129,.12)"},ACTIVA:{label:"ACTIVA",color:"#3b82f6",bg:"rgba(59,130,246,.12)"},INCUMPLIDA:{label:"INCUMPLIDA",color:"#f97316",bg:"rgba(249,115,22,.12)"},FINALIZADA:{label:"FINALIZADA",color:"#0ea5e9",bg:"rgba(14,165,233,.12)"},VENCIDA:{label:"VENCIDA",color:"#6b7280",bg:"rgba(107,114,128,.15)"}}[t]||{label:t,color:"#6b7280",bg:"rgba(107,114,128,.12)"}})(e.effectiveStatus),n=U[e.tutorId],r=(null===n||void 0===n?void 0:n.name)||e.tutorName||"Tutor",s=(new Date("".concat(e.date,"T").concat(us(e.start))).getTime()-Date.now())/36e5,l=("PENDIENTE"===e.effectiveStatus||"ACEPTADO"===e.effectiveStatus)&&s>=12,c="ACTIVA"===e.effectiveStatus,u="ACEPTADO"===e.effectiveStatus||"INCUMPLIDA"===e.effectiveStatus;return(0,xr.jsxs)("article",{className:"reservation-card",children:[(0,xr.jsxs)("header",{className:"reservation-card__header",children:[(0,xr.jsxs)("h3",{className:"reservation-card__title",children:["Reserva con ",r]}),(0,xr.jsx)("span",{className:"status-pill",style:{color:t.color,background:t.bg},children:t.label})]}),(0,xr.jsxs)("div",{className:"reservation-card__meta",style:{marginTop:6},children:[(0,xr.jsxs)("span",{children:["\ud83d\udcc5 ",e.date]}),(0,xr.jsxs)("span",{children:["\ud83d\udd52 ",us(e.start)," \u2013 ",us(e.end)]})]}),(0,xr.jsxs)("div",{className:"reservation-card__actions",children:[(0,xr.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>(async(e,t,n)=>{try{var r,s;if(!o)return void alert("No hay sesi\xf3n activa.");let i=null!==(r=null!==(s=e.callSessionId)&&void 0!==s?s:e.sessionId)&&void 0!==r?r:void 0;i||(i=(await Ta(e.id,o)).sessionId),sessionStorage.setItem("call:reservation:"+i,String(e.id)),a("/call/".concat(i,"?reservationId=").concat(encodeURIComponent(String(e.id))),{state:{peerId:e.tutorId,peerName:t,peerEmail:(null===n||void 0===n?void 0:n.email)||"N/A",peerAvatar:null===n||void 0===n?void 0:n.avatarUrl,role:"student"}})}catch(Is){var i;alert("No se pudo iniciar la reuni\xf3n: "+(null!==(i=null===Is||void 0===Is?void 0:Is.message)&&void 0!==i?i:"error"))}})(e,r,n),disabled:!c,title:c?"Entrar a la reuni\xf3n":"Disponible solo cuando la reserva est\xe1 ACTIVA",children:"\u25b6 Reunirse ahora"}),(0,xr.jsxs)("button",{type:"button",className:"btn btn-success btn-contact",onClick:()=>{var t,n,r;g({id:e.tutorId,sub:e.tutorId,name:(null===(t=U[e.tutorId])||void 0===t?void 0:t.name)||"Tutor",email:(null===(n=U[e.tutorId])||void 0===n?void 0:n.email)||"N/A",avatarUrl:null===(r=U[e.tutorId])||void 0===r?void 0:r.avatarUrl}),R(t=>i(i({},t),{},{[e.tutorId]:0}))},disabled:!u,title:u?"Contactar al tutor":"Solo disponible con reservas ACEPTADAS o INCUMPLIDAS",children:["Contactar",A[e.tutorId]>0&&(0,xr.jsx)("span",{className:"badge-dot","aria-label":"mensajes sin leer"})]}),(0,xr.jsx)("button",{type:"button",className:"btn btn-danger",onClick:()=>(async e=>{if(!o)return;const t=(e.effectiveStatus||"").toUpperCase(),n=(new Date("".concat(e.date,"T").concat(us(e.start))).getTime()-Date.now())/36e5;if(("PENDIENTE"===t||"ACEPTADO"===t)&&n>=12){if(globalThis.confirm("\xbfSeguro que quieres cancelar esta reserva?")){if(await Ar(e.id,o),"ACEPTADO"===t){const t=v||(null===p||void 0===p?void 0:p.userId)||"";try{await Hr.refundOnCancellation({fromUserId:t,toUserId:e.tutorId,reservationId:e.id,cancelledBy:"STUDENT",reason:"Cancelaci\xf3n por estudiante"},o)}catch(r){}try{const e=await Hr.getStudentBalance(o);T(e.tokenBalance),globalThis.dispatchEvent(new CustomEvent("tokens:refresh"))}catch(a){}}await z()}}else alert("Solo puedes cancelar reservas PENDIENTE o ACEPTADO y con 12+ horas de antelaci\xf3n.")})(e),disabled:!l,title:l?"Cancelar esta reserva":"Solo si falta 12+ horas y estado PENDIENTE/ACEPTADO",children:"Cancelar"})]})]},e.id)})}),W.length>15&&(0,xr.jsxs)("div",{className:"pagination-controls",style:{marginTop:"20px",textAlign:"center"},children:[(0,xr.jsx)("button",{className:"btn btn-ghost",onClick:()=>E(e=>Math.max(1,e-1)),disabled:1===N,type:"button",children:"Anterior"}),(0,xr.jsxs)("span",{style:{margin:"0 15px",color:"white",fontWeight:"bold"},children:["P\xe1gina ",N," de ",V]}),(0,xr.jsx)("button",{className:"btn btn-ghost",onClick:()=>E(e=>Math.min(V,e+1)),disabled:N===V,type:"button",children:"Siguiente"})]})]})}),m&&v&&o&&(0,xr.jsxs)("aside",{className:"chat-side-panel",children:[(0,xr.jsx)("button",{className:"close-chat-btn",onClick:()=>g(null),type:"button","aria-label":"Cerrar chat",children:"\xd7"}),(0,xr.jsx)(Da,{contact:m,myUserId:v,token:o})]})]})]})})]})},fs="https://user-service.duckdns.org/Api-search";function ms(e){if(!e)return"";if("string"===typeof e)return e;if(Array.isArray(e))return e.join(" ");if("object"===typeof e){if("string"===typeof e.text)return e.text;if("string"===typeof e.value)return e.value}return String(e)}const gs=class{static async getTopTutors(){try{const e="".concat(fs,"/tutors/top"),t=await fetch(e,{method:"GET"});if(!t.ok){const e=await t.text().catch(()=>"");throw console.error("Error HTTP en ApiSearchService.getTopTutors:",t.status,e),new Error("Error obteniendo mejores tutores")}const n=await t.json();return Array.isArray(n)?n.map(e=>{var t,n,r,a,s;let o,i;return o="number"===typeof e.rating?e.rating:"number"===typeof e.ratingValue?e.ratingValue:void 0,i="number"===typeof e.tokensPerHour?e.tokensPerHour:"number"===typeof e.rate?e.rate:void 0,{userId:null!==(t=null!==(n=e.userId)&&void 0!==n?n:e.id)&&void 0!==t?t:"",name:null!==(r=e.name)&&void 0!==r?r:"",email:null!==(a=e.email)&&void 0!==a?a:"",bio:ms(null!==(s=e.bio)&&void 0!==s?s:e.biography),specializations:Array.isArray(e.specializations)?e.specializations:[],credentials:Array.isArray(e.credentials)?e.credentials:[],rating:o,tokensPerHour:i}}):[]}catch(e){throw console.error("ApiSearchService.getTopTutors error:",e),e}}static async searchTutors(e){try{const t=(null!==e&&void 0!==e?e:"").trim(),n=t.length>0?"".concat(fs,"/tutors?q=").concat(encodeURIComponent(t)):"".concat(fs,"/tutors"),r=await fetch(n,{method:"GET"});if(!r.ok){const e=await r.text().catch(()=>"");throw console.error("Error HTTP en ApiSearchService.searchTutors:",r.status,e),new Error("Error buscando tutores")}const a=await r.json();return Array.isArray(a)?a.map(e=>{var t,n,r,a,s,o;let i,l;return i="number"===typeof e.rating?e.rating:"number"===typeof e.ratingValue?e.ratingValue:void 0,l="number"===typeof e.tokensPerHour?e.tokensPerHour:"number"===typeof e.rate?e.rate:void 0,{userId:null!==(t=null!==(n=null!==(r=e.userId)&&void 0!==r?r:e.id)&&void 0!==n?n:e.sub)&&void 0!==t?t:"",name:null!==(a=e.name)&&void 0!==a?a:"",email:null!==(s=e.email)&&void 0!==s?s:"",bio:ms(null!==(o=e.bio)&&void 0!==o?o:e.biography),specializations:Array.isArray(e.specializations)?e.specializations:[],credentials:Array.isArray(e.credentials)?e.credentials:[],rating:i,tokensPerHour:l}}):[]}catch(t){throw console.error("ApiSearchService.searchTutors error:",t),t}}},vs=()=>{var e,t,n;const r=me(),a=dr(),{userRoles:s,isAuthenticated:o,needsRoleSelection:i}=wr(),{isProfileComplete:c,missingFields:u}=kr(),[d,h]=(0,l.useState)(null),[p,f]=(0,l.useState)(""),[m,g]=(0,l.useState)([]),[v,y]=(0,l.useState)(!1),[b,w]=(0,l.useState)(""),[x,S]=(0,l.useState)(!0),[k,_]=(0,l.useState)(0),[j,N]=(0,l.useState)(!1);(0,l.useEffect)(()=>{var e,t,n,l;null!==o&&null!==s&&(o?i?r("/role-selection"):null!==s&&void 0!==s&&s.includes("student")?a.user&&h({userId:(null===(e=a.user.profile)||void 0===e?void 0:e.sub)||"unknown",name:(null===(t=a.user.profile)||void 0===t?void 0:t.name)||(null===(n=a.user.profile)||void 0===n?void 0:n.nickname)||"Usuario",email:(null===(l=a.user.profile)||void 0===l?void 0:l.email)||"No email",role:"student"}):r("/"):r("/login"))},[o,s,i,r,a.user]),(0,l.useEffect)(()=>{var e,t,n;const r=null!==(e=null===(t=a.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=a.user)||void 0===n?void 0:n.access_token;if(!r)return;(async()=>{try{const e=await Hr.getStudentBalance(r);_(e.tokenBalance)}catch(Is){console.error("Error cargando balance:",Is)}})()},[a.user]),(0,l.useEffect)(()=>{(async()=>{y(!0);try{const e=await gs.getTopTutors();g(e||[])}catch(e){console.error("Error cargando mejores tutores:",e),w("No se pudieron cargar los tutores recomendados")}finally{y(!1)}})()},[]);return a.isLoading||!d?(0,xr.jsx)("div",{className:"full-center",children:"Cargando..."}):(0,xr.jsxs)("div",{className:"dashboard-container",children:[!c&&u&&x&&(0,xr.jsx)(Mr,{currentRole:"student",missingFields:u,onDismiss:()=>S(!1)}),(0,xr.jsx)(Wr,{isOpen:j,onClose:()=>N(!1),currentBalance:k,cognitoToken:null!==(e=null===(t=a.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=a.user)||void 0===n?void 0:n.access_token}),(0,xr.jsx)(Jr,{currentUser:d,activeSection:"find-tutors",onSectionChange:e=>{Vr(r,e)},tokenBalance:k,onBuyTokensClick:()=>N(!0)}),(0,xr.jsx)("main",{className:"dashboard-main",children:(0,xr.jsxs)("div",{className:"tutors-section",children:[(0,xr.jsx)("h1",{children:"Buscar Tutores \ud83d\udd0d"}),(0,xr.jsxs)("section",{className:"tutor-search",children:[(0,xr.jsxs)("form",{onSubmit:async e=>{null===e||void 0===e||e.preventDefault(),y(!0),w("");try{var t;const e=await gs.searchTutors(p);g(e||[]),sessionStorage.setItem("u-learn:lastTutorSearchCount",String(null!==(t=null===e||void 0===e?void 0:e.length)&&void 0!==t?t:0))}catch(n){w((null===n||void 0===n?void 0:n.message)||"Error en la b\xfasqueda")}finally{y(!1)}},className:"tutor-search-form",children:[(0,xr.jsx)("input",{type:"text",placeholder:"Ej: java, c\xe1lculo, Mar\xeda...",value:p,onChange:e=>f(e.target.value)}),(0,xr.jsx)("button",{type:"submit",disabled:v,children:v?"Buscando...":"Buscar"})]}),b&&(0,xr.jsx)("p",{className:"error",children:b}),(0,xr.jsxs)("div",{className:"tutor-results",children:[0===m.length&&!v&&(0,xr.jsx)("p",{children:"No hay tutores disponibles en este momento."}),m.map(e=>(0,xr.jsxs)("div",{className:"tutor-card",children:[(0,xr.jsx)("div",{className:"tutor-card-header",children:(0,xr.jsxs)("div",{className:"tutor-title",children:[(0,xr.jsx)("strong",{className:"tutor-name",children:e.name}),(0,xr.jsx)("br",{}),(0,xr.jsx)("span",{className:"tutor-email",children:e.email})]})}),e.bio&&(0,xr.jsx)("p",{className:"tutor-bio",children:e.bio}),e.specializations&&e.specializations.length>0&&(0,xr.jsx)("div",{className:"tutor-tags",children:e.specializations.map((e,t)=>(0,xr.jsxs)("span",{className:"tag specialization-tag ".concat(e.verified?"verified":"manual"),title:e.verified?"Verificado por IA - ".concat(e.source):"Agregado manualmente",children:[e.verified&&(0,xr.jsx)("span",{className:"verified-icon",children:"\u2713"}),e.name]},t))}),"number"===typeof e.tokensPerHour&&e.tokensPerHour>0&&(0,xr.jsxs)("p",{className:"tutor-rate",children:[(0,xr.jsx)("strong",{children:"Tarifa:"})," ",e.tokensPerHour," tokens/hora"]}),(0,xr.jsxs)("div",{className:"tutor-actions",children:[(0,xr.jsx)("button",{className:"btn-secondary",onClick:()=>r("/profile/tutor/".concat(e.userId),{state:{profile:e}}),type:"button",children:"Ver Perfil"}),(0,xr.jsx)("button",{className:"btn-primary",onClick:()=>r("/book/".concat(e.userId),{state:{tutor:e,role:"tutor"}}),type:"button",children:"Reservar Cita"})]})]},e.userId))]})]})]})})]})},ys=()=>{var e,t;const n=me(),r=dr(),[a]=St(),[s,o]=(0,l.useState)("loading"),[i,c]=(0,l.useState)("Procesando tu pago..."),[u,d]=(0,l.useState)(null),[h,p]=(0,l.useState)(null),f=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{(async()=>{if(!f.current){f.current=!0;try{const e=a.get("session_id");if(console.log("\ud83d\udd0d [PaymentSuccess] session_id from URL:",e),!e)throw new Error("Falta session_id en la URL");o("pending-confirm"),c("Confirmando pago con el servidor..."),console.log("\ud83d\udce4 [PaymentSuccess] Llamando confirmPayment (una sola vez)...");const t=await Hr.confirmPayment(e);console.log("\u2705 [PaymentSuccess] Pago confirmado:",t),p({tokens:t.tokens,amount:t.amount}),o("success"),c("\xa1Pago confirmado!"),setTimeout(()=>n("/student-dashboard"),3e3)}catch(e){console.error("\u274c [PaymentSuccess] Error procesando el pago:",e),o("error"),c(e instanceof Error?e.message:"Ocurri\xf3 un error al procesar tu pago. Por favor, contacta a soporte.")}}})()},[a,n]),(0,l.useEffect)(()=>{(async()=>{if("success"===s&&null===u)try{var e,t,n;const a=null!==(e=null===(t=r.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=r.user)||void 0===n?void 0:n.access_token;if(!a)return;console.log("\ud83d\udd04 [PaymentSuccess] Refrescando balance despu\xe9s de confirmaci\xf3n...");const s=await Hr.getStudentBalance(a);d(s.tokenBalance),console.log("\ud83d\udcb0 [PaymentSuccess] Nuevo balance:",s.tokenBalance)}catch(Is){console.warn("\u26a0\ufe0f [PaymentSuccess] No se pudo refrescar el balance:",Is)}})()},[s,r.user,u]),r.isLoading?(0,xr.jsx)("div",{className:"payment-page",children:(0,xr.jsxs)("div",{className:"payment-card",children:[(0,xr.jsx)("div",{className:"loader"}),(0,xr.jsx)("p",{children:"Verificando sesi\xf3n..."})]})}):(0,xr.jsx)("div",{className:"payment-page",children:(0,xr.jsxs)("div",{className:"payment-card",children:["loading"===s&&(0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsx)("div",{className:"loader"}),(0,xr.jsx)("h1",{children:"Procesando tu pago"}),(0,xr.jsx)("p",{children:i})]}),"pending-confirm"===s&&(0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsx)("div",{className:"loader"}),(0,xr.jsx)("h1",{children:"Confirmando pago"}),(0,xr.jsx)("p",{children:i})]}),"success"===s&&(0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsx)("div",{className:"success-icon",children:"\u2713"}),(0,xr.jsx)("h1",{children:"\xa1Pago exitoso!"}),(0,xr.jsx)("p",{children:i}),null!==u&&(0,xr.jsxs)("div",{className:"balance-display",children:[(0,xr.jsx)("p",{className:"balance-label",children:"Nuevo balance:"}),(0,xr.jsxs)("p",{className:"balance-amount",children:[u," tokens"]})]}),h&&(0,xr.jsxs)("p",{style:{color:"#6b7280"},children:["Tokens acreditados: ",null!==(e=h.tokens)&&void 0!==e?e:"N/D"," | Monto: ",null!==(t=h.amount)&&void 0!==t?t:"N/D"]}),(0,xr.jsx)("p",{className:"redirect-message",children:"Ser\xe1s redirigido al dashboard en unos segundos..."}),(0,xr.jsx)("button",{className:"btn-primary",onClick:()=>n("/student-dashboard"),type:"button",children:"Ir al Dashboard"})]}),"error"===s&&(0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsx)("div",{className:"error-icon",children:"\u2715"}),(0,xr.jsx)("h1",{children:"Error al procesar el pago"}),(0,xr.jsx)("p",{className:"error-text",children:i}),(0,xr.jsxs)("div",{className:"button-group",children:[(0,xr.jsx)("button",{className:"btn-primary",onClick:()=>n("/student-dashboard"),type:"button",children:"Volver al Dashboard"}),(0,xr.jsx)("button",{className:"btn-secondary",onClick:()=>window.location.reload(),type:"button",children:"Reintentar"})]})]})]})})},bs=()=>{const e=me();return(0,xr.jsx)("div",{className:"payment-page",children:(0,xr.jsxs)("div",{className:"payment-card",children:[(0,xr.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,xr.jsx)("h1",{children:"Pago Cancelado"}),(0,xr.jsx)("p",{children:"Has cancelado el proceso de pago. No se realiz\xf3 ning\xfan cargo."}),(0,xr.jsx)("p",{className:"error-text",children:"Si experimentaste alg\xfan problema, por favor intenta nuevamente o contacta a soporte."}),(0,xr.jsxs)("div",{className:"button-group",children:[(0,xr.jsx)("button",{className:"btn-primary",onClick:()=>e("/student-dashboard"),type:"button",children:"Volver al Dashboard"}),(0,xr.jsx)("button",{className:"btn-secondary",onClick:()=>window.history.back(),type:"button",children:"Intentar Nuevamente"})]})]})})};function ws(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function xs(e,t){const n=new Date(e+"T00:00:00");return n.setDate(n.getDate()+t),ws(n)}const Ss={PUBLICADA:{label:"Publicada",color:"#2563eb",bg:"rgba(37,99,235,.12)"},ACEPTADA:{label:"Aceptada",color:"#059669",bg:"rgba(5,150,105,.12)"},CANCELADA:{label:"Cancelada",color:"#ef4444",bg:"rgba(239,68,68,.12)"},FINALIZADA:{label:"Finalizada",color:"#0ea5e9",bg:"rgba(14,165,233,.12)"},RECHAZADA:{label:"Rechazada",color:"#f97316",bg:"rgba(249,115,22,.12)"},EN_PROGRESO:{label:"En progreso",color:"#6b21a8",bg:"rgba(107,33,168,.12)"}},ks=()=>{var e,t,n,r,a;const s=me(),o=dr(),{userRoles:c,isAuthenticated:u,needsRoleSelection:d}=wr(),{isProfileComplete:h,missingFields:p}=kr(),[f,m]=(0,l.useState)(null),[g,v]=(0,l.useState)(!0),[y,b]=(0,l.useState)([]),[w,x]=(0,l.useState)(!1),[S,k]=(0,l.useState)(""),[_,j]=(0,l.useState)(0),[N,E]=(0,l.useState)(!1),[C,T]=(0,l.useState)(null),[I,P]=(0,l.useState)(!1),[A,R]=(0,l.useState)(new Set),[D,L]=(0,l.useState)(()=>function(e){const t=new Date(e+"T00:00:00"),n=t.getDay(),r=(0===n?-6:1)-n;return t.setDate(t.getDate()+r),ws(t)}(ws(new Date))),[O,U]=(0,l.useState)({}),[M,z]=(0,l.useState)(!1),[F,H]=(0,l.useState)("");(0,l.useEffect)(()=>{var e,t,n,r;null!==u&&null!==c&&(u?d?s("/role-selection"):null!==c&&void 0!==c&&c.includes("student")?o.user&&m({userId:(null===(e=o.user.profile)||void 0===e?void 0:e.sub)||"unknown",name:(null===(t=o.user.profile)||void 0===t?void 0:t.name)||(null===(n=o.user.profile)||void 0===n?void 0:n.nickname)||"Usuario",email:(null===(r=o.user.profile)||void 0===r?void 0:r.email)||"No email",role:"student"}):s("/"):s("/login"))},[u,c,d,s,o.user]);const B=(0,l.useMemo)(()=>{var e,t,n;return null!==(e=null===(t=o.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=o.user)||void 0===n?void 0:n.access_token},[o.user]),W=async()=>{if(B)try{x(!0);const e=await async function(e){const t="".concat(Ba,"/api/tasks/my-tasks");return Va(await fetch(t,{method:"GET",headers:Wa(e)}))}(B);b(e)}catch(e){k((null===e||void 0===e?void 0:e.message)||"No se pudieron cargar tus tareas")}finally{x(!1)}};(0,l.useEffect)(()=>{B&&W()},[B]),(0,l.useEffect)(()=>{if(!C||!B)return;const e=y.find(e=>e.id===C);e&&e.tutorId&&(async()=>{try{z(!0),H("");const e=await async function(e,t,n){const r="".concat(Ba,"/api/tasks/").concat(encodeURIComponent(e),"/tutor-schedule?weekStart=").concat(encodeURIComponent(t));return Va(await fetch(r,{method:"GET",headers:Wa(n)}))}(C,D,B);U(t=>i(i({},t),{},{[C]:e}))}catch(e){H((null===e||void 0===e?void 0:e.message)||"No se pudo cargar el horario del tutor")}finally{z(!1)}})()},[C,D,B,y]);(0,l.useEffect)(()=>{var e,t,n;const r=null!==(e=null===(t=o.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=o.user)||void 0===n?void 0:n.access_token;r&&(async()=>{try{const e=await Hr.getStudentBalance(r);j(e.tokenBalance)}catch(e){}})()},[o.user]);const V=async e=>{B&&globalThis.confirm("\xbfSeguro que quieres cancelar esta tarea?")&&(await async function(e,t){const n="".concat(Ba,"/api/tasks/").concat(encodeURIComponent(e),"/cancel");return Va(await fetch(n,{method:"PATCH",headers:Wa(t)}))}(e,B),await W(),C===e&&T(null))},q=C&&O[C]||[],K="".concat(D," al ").concat(xs(D,6)),$=null===(e=o.user)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.sub,J=(0,l.useMemo)(()=>!!$&&q.some(e=>{const t=String(e.status||"").toUpperCase();return e.studentId===$&&("PENDIENTE"===t||"ACEPTADO"===t||"ACTIVA"===t||"FINALIZADA"===t||"CANCELADA"===t)}),[q,$]);return o.isLoading||!f?(0,xr.jsx)("div",{className:"full-center",children:"Cargando..."}):(0,xr.jsxs)("div",{className:"dashboard-container",children:[!h&&p&&g&&(0,xr.jsx)(Mr,{currentRole:"student",missingFields:p,onDismiss:()=>v(!1)}),(0,xr.jsx)(Wr,{isOpen:N,onClose:()=>E(!1),currentBalance:_,cognitoToken:null!==(n=null===(r=o.user)||void 0===r?void 0:r.id_token)&&void 0!==n?n:null===(a=o.user)||void 0===a?void 0:a.access_token}),(0,xr.jsx)(Jr,{currentUser:f,activeSection:"my-tasks",onSectionChange:e=>{Vr(s,e)},tokenBalance:_,onBuyTokensClick:()=>E(!0)}),(0,xr.jsx)("main",{className:"dashboard-main",children:(0,xr.jsxs)("div",{className:"tasks-section",children:[(0,xr.jsxs)("div",{className:"tasks-header-row",children:[(0,xr.jsx)("h1",{children:"Mis tareas \ud83d\udccb"}),(0,xr.jsxs)("div",{className:"tasks-actions",children:[(0,xr.jsx)("button",{className:"btn-secondary",type:"button",onClick:W,disabled:w,children:"Actualizar"}),(0,xr.jsx)("button",{className:"btn-primary",type:"button",onClick:()=>s("/student/tasks/new"),children:"Publicar nueva"})]})]}),S&&(0,xr.jsx)("p",{className:"error-text",children:S}),w?(0,xr.jsx)("div",{className:"card",children:"Cargando tareas..."}):0===y.length?(0,xr.jsx)("div",{className:"card",children:"No tienes tareas a\xfan."}):(0,xr.jsx)("div",{className:"tasks-grid",children:y.map(e=>{const t=Ss[e.estado]||{label:e.estado,color:"#374151",bg:"rgba(55,65,81,.12)"},n="PUBLICADA"===e.estado||"ACEPTADA"===e.estado||"EN_PROGRESO"===e.estado,r="ACEPTADA"===e.estado&&e.tutorId,a=A.has(e.id);e.id;return(0,xr.jsxs)("article",{className:"task-card",children:[(0,xr.jsxs)("header",{className:"task-header",children:[(0,xr.jsx)("h3",{children:e.titulo}),(0,xr.jsxs)("div",{className:"task-meta",children:[(0,xr.jsx)("span",{className:"priority-badge",style:{backgroundColor:t.color,color:"#fff"},children:t.label}),(0,xr.jsx)("span",{className:"status-badge",style:{color:t.color,background:t.bg},children:e.materia})]})]}),(0,xr.jsx)("p",{className:"task-description",children:e.descripcion}),(0,xr.jsxs)("div",{className:"task-details",children:[(0,xr.jsxs)("span",{children:["\ud83d\udcda ",e.materia||"Sin materia"]}),e.fechaLimite&&(0,xr.jsxs)("span",{children:["\ud83d\udcc5 L\xedmite: ",e.fechaLimite]})]}),e.tutorId&&(0,xr.jsxs)("p",{className:"task-assigned",children:["Tutor asignado: ",e.tutorId]}),(0,xr.jsxs)("div",{className:"task-actions",children:[(0,xr.jsx)("button",{className:"btn-primary",type:"button",onClick:()=>{return t=e.id,H(""),T(t),void P(!0);var t},disabled:!r||a,title:r?a?"Ya reservaste con este tutor":"Ver horario del tutor":"Disponible cuando la tarea est\xe9 aceptada",children:a?"Reservado":"Ver horario"}),(0,xr.jsx)("button",{className:"btn-danger",type:"button",onClick:()=>V(e.id),disabled:!n,title:n?"Cancelar esta tarea":"No se puede cancelar en este estado",children:"Cancelar tarea"})]})]},e.id)})})]})}),I&&(0,xr.jsx)("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true",children:(0,xr.jsxs)("div",{className:"modal-card",children:[(0,xr.jsxs)("div",{className:"modal-header",children:[(0,xr.jsx)("h3",{children:"Horario del tutor"}),(0,xr.jsx)("button",{className:"btn-secondary",type:"button",onClick:()=>{P(!1),T(null)},children:"Cerrar"})]}),(0,xr.jsxs)("div",{className:"modal-body",children:[(0,xr.jsxs)("div",{className:"week-toolbar",children:[(0,xr.jsx)("button",{className:"btn btn-ghost",type:"button",onClick:()=>L(xs(D,-7)),children:"\xab Anterior"}),(0,xr.jsxs)("div",{className:"week-toolbar__title",children:["Semana ",K]}),(0,xr.jsx)("button",{className:"btn btn-ghost",type:"button",onClick:()=>L(xs(D,7)),children:"Siguiente \xbb"})]}),M&&(0,xr.jsx)("div",{className:"empty-note",children:"Cargando horario..."}),F&&(0,xr.jsx)("div",{className:"error-text",children:F}),!M&&(0,xr.jsx)(ta,{weekStart:D,cells:q,mode:"student",onSinglePick:e=>{J?alert("Ya tienes una reserva para esta tarea. No puedes reservar otra."):((async e=>{if(!C||!B)return;const t=y.find(e=>e.id===C);if(!t||!t.tutorId)return;if(globalThis.confirm("Reservar ".concat(e.date," ").concat(e.hour," con el tutor?")))try{await Tr(t.tutorId,e.date,e.hour,B),alert("\u2705 Reserva creada exitosamente. Redirigiendo a tus reservas..."),R(e=>new Set(e).add(C)),P(!1),T(null),await W(),s("/student-reservations")}catch(n){const e=(null===n||void 0===n?void 0:n.message)||"Error al crear la reserva";alert("\u274c No se pudo crear la reserva: ".concat(e)),console.error("Error creating reservation:",n)}})(e),P(!1))}}),(0,xr.jsx)("p",{className:"hint-text",children:'Haz clic en un bloque "Disponible" para reservar.'}),J&&(0,xr.jsx)("div",{className:"empty-note",children:"Ya existe una reserva asociada a esta tarea."})]})]})})]})},_s={titulo:"",descripcion:"",materia:"",fechaLimite:""},js=()=>{var e,t,n;const r=me(),a=dr(),{userRoles:s,isAuthenticated:o,needsRoleSelection:c}=wr(),{isProfileComplete:u,missingFields:d}=kr(),[h,p]=(0,l.useState)(null),[f,m]=(0,l.useState)(!0),[g,v]=(0,l.useState)(_s),[y,b]=(0,l.useState)(!1),[w,x]=(0,l.useState)(""),[S,k]=(0,l.useState)(""),[_,j]=(0,l.useState)(0),[N,E]=(0,l.useState)(!1);(0,l.useEffect)(()=>{var e,t,n,i;null!==o&&null!==s&&(o?c?r("/role-selection"):null!==s&&void 0!==s&&s.includes("student")?a.user&&p({userId:(null===(e=a.user.profile)||void 0===e?void 0:e.sub)||"unknown",name:(null===(t=a.user.profile)||void 0===t?void 0:t.name)||(null===(n=a.user.profile)||void 0===n?void 0:n.nickname)||"Usuario",email:(null===(i=a.user.profile)||void 0===i?void 0:i.email)||"No email",role:"student"}):r("/"):r("/login"))},[o,s,c,r,a.user]);(0,l.useEffect)(()=>{var e,t,n;const r=null!==(e=null===(t=a.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=a.user)||void 0===n?void 0:n.access_token;r&&(async()=>{try{const e=await Hr.getStudentBalance(r);j(e.tokenBalance)}catch(e){}})()},[a.user]);return a.isLoading||!h?(0,xr.jsx)("div",{className:"full-center",children:"Cargando..."}):(0,xr.jsxs)("div",{className:"dashboard-container",children:[!u&&d&&f&&(0,xr.jsx)(Mr,{currentRole:"student",missingFields:d,onDismiss:()=>m(!1)}),(0,xr.jsx)(Wr,{isOpen:N,onClose:()=>E(!1),currentBalance:_,cognitoToken:null!==(e=null===(t=a.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=a.user)||void 0===n?void 0:n.access_token}),(0,xr.jsx)(Jr,{currentUser:h,activeSection:"post-task",onSectionChange:e=>{Vr(r,e)},tokenBalance:_,onBuyTokensClick:()=>E(!0)}),(0,xr.jsx)("main",{className:"dashboard-main",children:(0,xr.jsxs)("div",{className:"tasks-section",children:[(0,xr.jsx)("h1",{children:"Publicar nueva tarea \u2795"}),(0,xr.jsxs)("form",{className:"task-form",onSubmit:async e=>{var t,n,r;if(e.preventDefault(),x(""),k(""),!g.titulo||!g.descripcion||!g.materia)return void x("Completa t\xedtulo, descripci\xf3n y materia.");const s=null!==(t=null===(n=a.user)||void 0===n?void 0:n.id_token)&&void 0!==t?t:null===(r=a.user)||void 0===r?void 0:r.access_token;if(s)try{b(!0),await async function(e,t){const n="".concat(Ba,"/api/tasks");return Va(await fetch(n,{method:"POST",headers:Wa(t),body:JSON.stringify(e)}))}({titulo:g.titulo.trim(),descripcion:g.descripcion.trim(),materia:g.materia.trim(),fechaLimite:g.fechaLimite||void 0},s),k('Tarea publicada correctamente. Puedes verla en "Mis tareas".'),v(_s)}catch(o){x((null===o||void 0===o?void 0:o.message)||"No se pudo publicar la tarea.")}finally{b(!1)}else x("No hay sesi\xf3n activa.")},children:[(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"titulo",children:"T\xedtulo"}),(0,xr.jsx)("input",{id:"titulo",className:"form-input",value:g.titulo,onChange:e=>v(i(i({},g),{},{titulo:e.target.value})),placeholder:"Ej: Ayuda con C\xe1lculo Diferencial"})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"descripcion",children:"Descripci\xf3n"}),(0,xr.jsx)("textarea",{id:"descripcion",className:"form-textarea",rows:4,value:g.descripcion,onChange:e=>v(i(i({},g),{},{descripcion:e.target.value})),placeholder:"Describe lo que necesitas."})]}),(0,xr.jsxs)("div",{className:"form-row",children:[(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"materia",children:"Materia"}),(0,xr.jsx)("input",{id:"materia",className:"form-input",value:g.materia,onChange:e=>v(i(i({},g),{},{materia:e.target.value})),placeholder:"Matem\xe1ticas, F\xedsica, Ingl\xe9s..."})]}),(0,xr.jsxs)("div",{className:"form-group",children:[(0,xr.jsx)("label",{htmlFor:"fechaLimite",children:"Fecha l\xedmite (opcional)"}),(0,xr.jsx)("input",{id:"fechaLimite",type:"date",className:"form-input",value:g.fechaLimite,onChange:e=>v(i(i({},g),{},{fechaLimite:e.target.value}))})]})]}),w&&(0,xr.jsx)("p",{className:"error-text",children:w}),S&&(0,xr.jsx)("p",{className:"success-text",children:S}),(0,xr.jsxs)("div",{className:"form-actions",children:[(0,xr.jsx)("button",{className:"btn-primary btn-large",type:"submit",disabled:y,children:y?"Publicando...":"Publicar tarea"}),(0,xr.jsx)("button",{className:"btn-secondary",type:"button",onClick:()=>{v(_s),x(""),k("")},disabled:y,children:"Limpiar"})]})]})]})})]})},Ns=e=>{let{children:t,allowedRoles:n}=e;const{isLoading:r,isAuthenticated:a,userRoles:s,needsRoleSelection:o}=wr();return console.log("\ud83d\udee1\ufe0f ProtectedRoute check:",{isAuthenticated:a,isLoading:r,allowedRoles:n,userRoles:s,needsRoleSelection:o}),r?(console.log("\u23f3 ProtectedRoute: Cargando..."),(0,xr.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px"},children:"\u23f3 Verificando permisos..."})):a?o?(console.log("\ud83d\udd04 ProtectedRoute: User needs role selection, redirecting"),(0,xr.jsx)(Re,{to:"/role-selection",replace:!0})):n&&n.length>0&&(console.log("\ud83c\udfad ProtectedRoute: User roles:",s,"Allowed roles:",n),!s||!s.some(e=>n.includes(e)))?(console.log("\u274c ProtectedRoute: Role not allowed, redirecting to home"),(0,xr.jsx)(Re,{to:"/",replace:!0})):(console.log("\u2705 ProtectedRoute: Access granted"),(0,xr.jsx)(xr.Fragment,{children:t})):(console.log("\ud83d\udd12 ProtectedRoute: Not authenticated, redirecting to home"),(0,xr.jsx)(Re,{to:"/",replace:!0}))},Es=()=>{const e=dr(),{isLoading:t,isAuthenticated:n,needsRoleSelection:r,userRoles:a,error:s}=wr(),o=me();return(0,l.useEffect)(()=>{if(console.log("\ud83d\udccd AuthRedirect useEffect:",{isAuthenticated:n,isLoading:t,needsRoleSelection:r,userRoles:a,error:s}),t)console.log("\u23f3 AuthRedirect: Esperando que termine de cargar...");else{if(!n)return console.log("\ud83d\udd12 AuthRedirect: No autenticado, redirigiendo a home"),void o("/",{replace:!0});if(r)return console.log("\ud83c\udfad AuthRedirect: Redirigiendo a selecci\xf3n de rol"),void o("/role-selection",{replace:!0});if(a&&a.length>0){const e=a.includes("student")?"/student-dashboard":"/tutor-dashboard";return console.log("\ud83d\udcca AuthRedirect: Redirigiendo a:",e),void o(e,{replace:!0})}console.log("\ud83e\udd14 AuthRedirect: Estado inesperado, no redirigiendo")}},[n,t,r,a,o]),e.isLoading||t?(0,xr.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px"},children:"\u23f3 Cargando autenticaci\xf3n..."}):e.error||s?(0,xr.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"20px"},children:[(0,xr.jsxs)("div",{children:["\u274c Error de autenticaci\xf3n: ",(null===(i=e.error)||void 0===i?void 0:i.message)||s]}),(0,xr.jsx)("button",{onClick:()=>e.signinRedirect(),children:"Intentar nuevamente"})]}):n?(0,xr.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"20px"},children:[(0,xr.jsx)("div",{children:"\u2705 \xa1Autenticaci\xf3n exitosa!"}),(0,xr.jsx)("div",{children:"\ud83d\ude80 Redirigiendo..."})]}):(0,xr.jsx)(Re,{to:"/",replace:!0});var i},Cs=e=>{let{children:t}=e;const{isLoading:n,isAuthenticated:r,needsRoleSelection:a,userRoles:s}=wr();if(console.log("\ud83c\udfad RoleSelectionProtectedRoute check:",{isAuthenticated:r,isLoading:n,needsRoleSelection:a,userRoles:s}),n)return console.log("\u23f3 RoleSelectionProtectedRoute: Cargando..."),(0,xr.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px"},children:"\u23f3 Verificando estado..."});if(!r)return console.log("\ud83d\udd12 RoleSelectionProtectedRoute: Not authenticated, redirecting to home"),(0,xr.jsx)(Re,{to:"/",replace:!0});if(!a){console.log("\u2705 RoleSelectionProtectedRoute: Ya tiene roles, redirigiendo al dashboard");const e=null!==s&&void 0!==s&&s.includes("student")?"/student-dashboard":"/tutor-dashboard";return(0,xr.jsx)(Re,{to:e,replace:!0})}return console.log("\ud83c\udfaf RoleSelectionProtectedRoute: Mostrando selecci\xf3n de roles"),(0,xr.jsx)(xr.Fragment,{children:t})},Ts=()=>(0,xr.jsx)(gt,{children:(0,xr.jsx)("div",{className:"App",children:(0,xr.jsxs)(Oe,{children:[(0,xr.jsx)(De,{path:"/",element:(0,xr.jsx)(Sr,{})}),(0,xr.jsx)(De,{path:"/login",element:(0,xr.jsx)(Es,{})}),(0,xr.jsx)(De,{path:"/register",element:(0,xr.jsx)(Re,{to:"/",replace:!0})}),(0,xr.jsx)(De,{path:"/role-selection",element:(0,xr.jsx)(Cs,{children:(0,xr.jsx)(Ja,{})})}),(0,xr.jsx)(De,{path:"/student-dashboard",element:(0,xr.jsx)(Ns,{allowedRoles:["student"],children:(0,xr.jsx)(Gr,{})})}),(0,xr.jsx)(De,{path:"/tutor-dashboard",element:(0,xr.jsx)(Ns,{allowedRoles:["tutor"],children:(0,xr.jsx)(Ka,{})})}),(0,xr.jsx)(De,{path:"/tutor/mis-clases-simple",element:(0,xr.jsx)(Ns,{allowedRoles:["tutor"],children:(0,xr.jsx)(Ha,{})})}),(0,xr.jsx)(De,{path:"/availability",element:(0,xr.jsx)(Ns,{allowedRoles:["tutor"],children:(0,xr.jsx)(oa,{})})}),(0,xr.jsx)(De,{path:"/profile/:role/:userId",element:(0,xr.jsx)(Ns,{children:(0,xr.jsx)(Qa,{})})}),(0,xr.jsx)(De,{path:"/book/:tutorId",element:(0,xr.jsx)(Ns,{allowedRoles:["student"],children:(0,xr.jsx)(es,{})})}),(0,xr.jsx)(De,{path:"/tutor-classes",element:(0,xr.jsx)(Ns,{allowedRoles:["tutor"],children:(0,xr.jsx)(ka,{})})}),(0,xr.jsx)(De,{path:"/edit-profile",element:(0,xr.jsx)(Ns,{children:(0,xr.jsx)($a,{})})}),(0,xr.jsx)(De,{path:"/call/:sessionId",element:(0,xr.jsx)(Ns,{allowedRoles:["student","tutor"],children:(0,xr.jsx)(is,{})})}),(0,xr.jsx)(De,{path:"/student-reservations",element:(0,xr.jsx)(Ns,{allowedRoles:["student"],children:(0,xr.jsx)(ps,{})})}),(0,xr.jsx)(De,{path:"/student/tasks",element:(0,xr.jsx)(Ns,{allowedRoles:["student"],children:(0,xr.jsx)(ks,{})})}),(0,xr.jsx)(De,{path:"/student/tasks/new",element:(0,xr.jsx)(Ns,{allowedRoles:["student"],children:(0,xr.jsx)(js,{})})}),(0,xr.jsx)(De,{path:"/student-finds-tutors",element:(0,xr.jsx)(Ns,{allowedRoles:["student"],children:(0,xr.jsx)(vs,{})})}),(0,xr.jsx)(De,{path:"/payment-success",element:(0,xr.jsx)(ys,{})}),(0,xr.jsx)(De,{path:"/payment-cancel",element:(0,xr.jsx)(bs,{})}),(0,xr.jsx)(De,{path:"/tutor/tasks/available",element:(0,xr.jsx)(Ns,{allowedRoles:["tutor"],children:(0,xr.jsx)(qa,{})})})]})})});c.createRoot(document.getElementById("root")).render((0,xr.jsx)(l.StrictMode,{children:(0,xr.jsx)(ur,i(i({},{authority:"https://cognito-idp.us-east-1.amazonaws.com/us-east-1_8mvpRkbVu",client_id:"342s18a96gl2pbaroorqh316l8",redirect_uri:"https://nice-mud-05a4c8f10.3.azurestaticapps.net",response_type:"code",scope:"email openid profile",extraQueryParams:{ui_locales:"es"}}),{},{children:(0,xr.jsx)(Ts,{})}))}))})();
//# sourceMappingURL=main.ec0e4c0c.js.map